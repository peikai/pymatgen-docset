
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="Docutils 0.18.1: http://docutils.sourceforge.net/" name="generator"/>
<title>pymatgen.command_line.bader_caller module — pymatgen 2022.11.7 documentation</title>
<link href="_static/pygments.css" rel="stylesheet" type="text/css"/>
<link href="_static/basic.css" rel="stylesheet" type="text/css"/>
<script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
<script src="_static/jquery.js"></script>
<script src="_static/underscore.js"></script>
<script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
<script src="_static/doctools.js"></script>
<link href="genindex.html" rel="index" title="Index"/>
<link href="search.html" rel="search" title="Search"/>
<link href="pymatgen.command_line.chargemol_caller.html" rel="next" title="pymatgen.command_line.chargemol_caller module"/>
<link href="pymatgen.command_line.html" rel="prev" title="pymatgen.command_line package"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-33990148-1']);
  _gaq.push(['_trackPageview']);
</script>
</head><body>
<div aria-label="related navigation" class="related" role="navigation">
<h3>Navigation</h3>
<ul>
<li class="right" style="margin-right: 10px">
<a accesskey="I" href="genindex.html" title="General Index">index</a></li>
<li class="right">
<a href="py-modindex.html" title="Python Module Index">modules</a> |</li>
<li class="right">
<a accesskey="N" href="pymatgen.command_line.chargemol_caller.html" title="pymatgen.command_line.chargemol_caller module">next</a> |</li>
<li class="right">
<a accesskey="P" href="pymatgen.command_line.html" title="pymatgen.command_line package">previous</a> |</li>
<li class="nav-item nav-item-0"><a href="index.html">pymatgen 2022.11.7 documentation</a> »</li>
<li class="nav-item nav-item-1"><a href="modules.html">pymatgen</a> »</li>
<li class="nav-item nav-item-2"><a href="pymatgen.html">pymatgen namespace</a> »</li>
<li class="nav-item nav-item-3"><a accesskey="U" href="pymatgen.command_line.html">pymatgen.command_line package</a> »</li>
<li class="nav-item nav-item-this"><a href="">pymatgen.command_line.bader_caller module</a></li>
</ul>
</div>
<div class="document">
<div class="documentwrapper">
<div class="body" role="main">
<section id="module-pymatgen.command_line.bader_caller">
<span id="pymatgen-command-line-bader-caller-module"></span><h1><a name="//apple_ref/cpp/Module/pymatgen.command_line.bader_caller"></a>pymatgen.command_line.bader_caller module<a class="headerlink" href="#module-pymatgen.command_line.bader_caller" title="Permalink to this heading">¶</a></h1>
<p>This module implements an interface to the Henkelmann et al.’s excellent
Fortran code for calculating a Bader charge analysis.</p>
<p>This module depends on a compiled bader executable available in the path.
Please download the library at <a class="reference external" href="http://theory.cm.utexas.edu/henkelman/code/bader/">http://theory.cm.utexas.edu/henkelman/code/bader/</a>
and follow the instructions to compile the executable.</p>
<p>If you use this module, please cite the following:</p>
<p>G. Henkelman, A. Arnaldsson, and H. Jonsson, “A fast and robust algorithm for
Bader decomposition of charge density”, Comput. Mater. Sci. 36, 254-360 (2006).</p>
<dl class="py class">
<dt class="sig sig-object py" id="pymatgen.command_line.bader_caller.BaderAnalysis"><a name="//apple_ref/cpp/Class/pymatgen.command_line.bader_caller.BaderAnalysis"></a>
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BaderAnalysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chgcar_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">potcar_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chgref_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parse_atomic_densities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cube_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/command_line/bader_caller.html#BaderAnalysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.command_line.bader_caller.BaderAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Bader analysis for Cube files and VASP outputs.</p>
<p>Initializes the Bader caller.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chgcar_filename</strong> (<em>str</em>) – The filename of the CHGCAR.</p></li>
<li><p><strong>potcar_filename</strong> (<em>str</em>) – The filename of the POTCAR.</p></li>
<li><p><strong>chgref_filename</strong> (<em>str</em>) – The filename of the reference charge density.</p></li>
<li><p><strong>parse_atomic_densities</strong> (<em>bool</em>) – Optional. turns on atomic partition of the charge density
charge densities are atom centered</p></li>
<li><p><strong>cube_filename</strong> (<em>str</em>) – Optional. The filename of the cube file.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pymatgen.command_line.bader_caller.BaderAnalysis.from_path"><a name="//apple_ref/cpp/Method/pymatgen.command_line.bader_caller.BaderAnalysis.from_path"></a>
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/command_line/bader_caller.html#BaderAnalysis.from_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.command_line.bader_caller.BaderAnalysis.from_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenient constructor that takes in the path name of VASP run
to perform Bader analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) – Name of directory where VASP output files are
stored.</p></li>
<li><p><strong>suffix</strong> (<em>str</em>) – specific suffix to look for (e.g. ‘.relax1’
for ‘CHGCAR.relax1.gz’).</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pymatgen.command_line.bader_caller.BaderAnalysis.get_charge"><a name="//apple_ref/cpp/Method/pymatgen.command_line.bader_caller.BaderAnalysis.get_charge"></a>
<span class="sig-name descname"><span class="pre">get_charge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/command_line/bader_caller.html#BaderAnalysis.get_charge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.command_line.bader_caller.BaderAnalysis.get_charge" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience method to get the charge on a particular atom. This is the “raw”
charge generated by the Bader program, not a partial atomic charge. If the cube file
is a spin-density file, then this will return the spin density per atom with
positive being spin up and negative being spin down.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>atom_index</strong> – Index of atom.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Charge associated with atom from the Bader analysis.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pymatgen.command_line.bader_caller.BaderAnalysis.get_charge_decorated_structure"><a name="//apple_ref/cpp/Method/pymatgen.command_line.bader_caller.BaderAnalysis.get_charge_decorated_structure"></a>
<span class="sig-name descname"><span class="pre">get_charge_decorated_structure</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/command_line/bader_caller.html#BaderAnalysis.get_charge_decorated_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.command_line.bader_caller.BaderAnalysis.get_charge_decorated_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a charge decorated structure</p>
<p>Note, this assumes that the Bader analysis was correctly performed on a file
with electron densities</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pymatgen.command_line.bader_caller.BaderAnalysis.get_charge_transfer"><a name="//apple_ref/cpp/Method/pymatgen.command_line.bader_caller.BaderAnalysis.get_charge_transfer"></a>
<span class="sig-name descname"><span class="pre">get_charge_transfer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/command_line/bader_caller.html#BaderAnalysis.get_charge_transfer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.command_line.bader_caller.BaderAnalysis.get_charge_transfer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the charge transferred for a particular atom. A positive value means
that the site has gained electron density (i.e. exhibits anionic character)
whereas a negative value means the site has lost electron density (i.e. exhibits
cationic character). If the arg nelect is not supplied, then POTCAR must be
supplied to determine nelect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_index</strong> – Index of atom.</p></li>
<li><p><strong>nelect</strong> – number of electrons associated with an isolated atom at this index.
For most DFT codes this corresponds to the number of valence electrons
associated with the pseudopotential (e.g. ZVAL for VASP).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Charge transfer associated with atom from the Bader analysis.
Given by bader charge on atom - nelect for associated atom.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pymatgen.command_line.bader_caller.BaderAnalysis.get_decorated_structure"><a name="//apple_ref/cpp/Method/pymatgen.command_line.bader_caller.BaderAnalysis.get_decorated_structure"></a>
<span class="sig-name descname"><span class="pre">get_decorated_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">property_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/command_line/bader_caller.html#BaderAnalysis.get_decorated_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.command_line.bader_caller.BaderAnalysis.get_decorated_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a property-decorated structure from the Bader analysis.</p>
<p>This is distinct from getting charge decorated structure, which assumes
the “standard” Bader analysis of electron densities followed by converting
electron count to charge. The expected way to use this is to call Bader on
a non-charge density file such as a spin density file, electrostatic potential
file, etc., while using the charge density file as the reference (chgref_filename)
so that the partitioning is determined via the charge, but averaging or integrating
is done for another property.</p>
<p>User warning: Bader analysis cannot automatically determine what property is
inside of the file. So if you want to use this for a non-conventional property
like spin, you must ensure that you have the file is for the appropriate
property and you have an appropriate reference file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>property_name</strong> – name of the property to assign to the structure, note that
if name is “spin” this is handled as a special case, and the appropriate
spin properties are set on the species in the structure</p></li>
<li><p><strong>average</strong> – whether or not to return the average of this property, rather
than the total, by dividing by the atomic volume.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>structure with site properties assigned via Bader Analysis</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pymatgen.command_line.bader_caller.BaderAnalysis.get_oxidation_state_decorated_structure"><a name="//apple_ref/cpp/Method/pymatgen.command_line.bader_caller.BaderAnalysis.get_oxidation_state_decorated_structure"></a>
<span class="sig-name descname"><span class="pre">get_oxidation_state_decorated_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nelects</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/command_line/bader_caller.html#BaderAnalysis.get_oxidation_state_decorated_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.command_line.bader_caller.BaderAnalysis.get_oxidation_state_decorated_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an oxidation state decorated structure based on bader analysis results.
Each site is assigned a charge based on the computed partial atomic charge from bader.</p>
<p>Note, this assumes that the Bader analysis was correctly performed on a file
with electron densities</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="pymatgen.command_line.bader_caller.BaderAnalysis.get_partial_charge"><a name="//apple_ref/cpp/Method/pymatgen.command_line.bader_caller.BaderAnalysis.get_partial_charge"></a>
<span class="sig-name descname"><span class="pre">get_partial_charge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nelect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/command_line/bader_caller.html#BaderAnalysis.get_partial_charge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.command_line.bader_caller.BaderAnalysis.get_partial_charge" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience method to get the partial charge on a particular atom. This is
simply the negative value of the charge transferred. A positive value indicates
that the atom has cationic character, whereas a negative value indicates the
site has anionic character.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_index</strong> – Index of atom.</p></li>
<li><p><strong>nelect</strong> – number of electrons associated with an isolated atom at this index.
For most DFT codes this corresponds to the number of valence electrons
associated with the pseudopotential (e.g. ZVAL for VASP).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Charge associated with atom from the Bader analysis.</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="pymatgen.command_line.bader_caller.BaderAnalysis.summary">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">summary</span></span><a class="headerlink" href="#pymatgen.command_line.bader_caller.BaderAnalysis.summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Dict summary of key analysis, e.g., atomic volume, charge, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>return</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pymatgen.command_line.bader_caller.bader_analysis_from_objects"><a name="//apple_ref/cpp/Function/pymatgen.command_line.bader_caller.bader_analysis_from_objects"></a>
<span class="sig-name descname"><span class="pre">bader_analysis_from_objects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chgcar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">potcar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aeccar0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aeccar2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/command_line/bader_caller.html#bader_analysis_from_objects"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.command_line.bader_caller.bader_analysis_from_objects" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience method to run Bader analysis from a set
of pymatgen Chgcar and Potcar objects.</p>
<p>This method will:</p>
<p>1. If aeccar objects are present, constructs a temporary reference
file as AECCAR0 + AECCAR2
2. Runs Bader analysis twice: once for charge, and a second time
for the charge difference (magnetization density).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chgcar</strong> – Chgcar object</p></li>
<li><p><strong>potcar</strong> – (optional) Potcar object</p></li>
<li><p><strong>aeccar0</strong> – (optional) Chgcar object from aeccar0 file</p></li>
<li><p><strong>aeccar2</strong> – (optional) Chgcar object from aeccar2 file</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>summary dict</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="pymatgen.command_line.bader_caller.bader_analysis_from_path"><a name="//apple_ref/cpp/Function/pymatgen.command_line.bader_caller.bader_analysis_from_path"></a>
<span class="sig-name descname"><span class="pre">bader_analysis_from_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/command_line/bader_caller.html#bader_analysis_from_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.command_line.bader_caller.bader_analysis_from_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience method to run Bader analysis on a folder containing
typical VASP output files.</p>
<p>This method will:</p>
<p>1. Look for files CHGCAR, AECCAR0, AECCAR2, POTCAR or their gzipped
counterparts.
2. If AECCAR* files are present, constructs a temporary reference
file as AECCAR0 + AECCAR2
3. Runs Bader analysis twice: once for charge, and a second time
for the charge difference (magnetization density).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – path to folder to search in</p></li>
<li><p><strong>suffix</strong> – specific suffix to look for (e.g. ‘.relax1’ for ‘CHGCAR.relax1.gz’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>summary dict</p>
</dd>
</dl>
</dd></dl>
</section>
<div class="clearer"></div>
</div>
</div>
<div class="clearer"></div>
</div>
<div aria-label="related navigation" class="related" role="navigation">
<h3>Navigation</h3>
<ul>
<li class="right" style="margin-right: 10px">
<a href="genindex.html" title="General Index">index</a></li>
<li class="right">
<a href="py-modindex.html" title="Python Module Index">modules</a> |</li>
<li class="right">
<a href="pymatgen.command_line.chargemol_caller.html" title="pymatgen.command_line.chargemol_caller module">next</a> |</li>
<li class="right">
<a href="pymatgen.command_line.html" title="pymatgen.command_line package">previous</a> |</li>
<li class="nav-item nav-item-0"><a href="index.html">pymatgen 2022.11.7 documentation</a> »</li>
<li class="nav-item nav-item-1"><a href="modules.html">pymatgen</a> »</li>
<li class="nav-item nav-item-2"><a href="pymatgen.html">pymatgen namespace</a> »</li>
<li class="nav-item nav-item-3"><a href="pymatgen.command_line.html">pymatgen.command_line package</a> »</li>
<li class="nav-item nav-item-this"><a href="">pymatgen.command_line.bader_caller module</a></li>
</ul>
</div>
<div class="footer" role="contentinfo">
        © Copyright 2011, Pymatgen Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.2.
    </div>
<div class="footer">This page uses <a href="http://analytics.google.com/">
Google Analytics</a> to collect statistics. You can disable it by blocking
the JavaScript coming from www.google-analytics.com.
<script type="text/javascript">
  (function() {
    var ga = document.createElement('script');
    ga.src = ('https:' == document.location.protocol ?
              'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
  })();
</script>
</div>
</body>
</html>