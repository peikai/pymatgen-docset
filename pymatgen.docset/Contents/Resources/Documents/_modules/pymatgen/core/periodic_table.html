<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pymatgen.core.periodic_table &#8212; pymatgen 2025.1.24 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css?v=5c69cfe2" />
    <script src="../../../_static/documentation_options.js?v=d2bc030c"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">pymatgen 2025.1.24 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pymatgen.core.periodic_table</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <h1>Source code for pymatgen.core.periodic_table</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Classes representing:</span>
<span class="sd">- Element: Element in the periodic table.</span>
<span class="sd">- Species: Element with optional oxidation state and spin.</span>
<span class="sd">- DummySpecies: Non-traditional Elements/Species (vacancies/...).</span>
<span class="sd">- ElementType: element types (metal/noble_gas/halogen/s_block/...).</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">ast</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">functools</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">EnumMeta</span><span class="p">,</span> <span class="n">unique</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">combinations</span><span class="p">,</span> <span class="n">product</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span><span class="p">,</span> <span class="n">overload</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">monty.json</span><span class="w"> </span><span class="kn">import</span> <span class="n">MSONable</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pymatgen.core.units</span><span class="w"> </span><span class="kn">import</span> <span class="n">SUPPORTED_UNIT_NAMES</span><span class="p">,</span> <span class="n">FloatWithUnit</span><span class="p">,</span> <span class="n">Ha_to_eV</span><span class="p">,</span> <span class="n">Length</span><span class="p">,</span> <span class="n">Mass</span><span class="p">,</span> <span class="n">Unit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pymatgen.io.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">ParseError</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pymatgen.util.string</span><span class="w"> </span><span class="kn">import</span> <span class="n">Stringify</span><span class="p">,</span> <span class="n">formula_double_format</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">collections.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Callable</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Literal</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">typing_extensions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Self</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">pymatgen.util.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpeciesLike</span>

<span class="c1"># Load element data from JSON file</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;periodic_table.json&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ptable_json</span><span class="p">:</span>
    <span class="n">_pt_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">ptable_json</span><span class="p">)</span>

<span class="n">_pt_row_sizes</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>

<span class="n">_madelung</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;p&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;p&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;p&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;p&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;p&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="s2">&quot;p&quot;</span><span class="p">),</span>
<span class="p">]</span>


<div class="viewcode-block" id="ElementBase">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.ElementBase">[docs]</a>
<span class="nd">@functools</span><span class="o">.</span><span class="n">total_ordering</span>
<span class="nd">@unique</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ElementBase</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Element class defined without any enum values so it can be subclassed.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symbol</span><span class="p">:</span> <span class="n">SpeciesLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This class provides a basic, immutable representation of an element, including</span>
<span class="sd">        all relevant chemical and physical properties. It ensures that elements are</span>
<span class="sd">        handled as singletons, reducing redundancy and improving efficiency. Missing</span>
<span class="sd">        data is represented by `None` unless otherwise specified.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            Z (int): Atomic number of the element.</span>
<span class="sd">            symbol (str): Element symbol (e.g., &quot;H&quot;, &quot;Fe&quot;).</span>
<span class="sd">            long_name (str): Full name of the element (e.g., &quot;Hydrogen&quot;).</span>
<span class="sd">            A (int, optional): Atomic mass number (sum of protons and neutrons).</span>
<span class="sd">            atomic_radius_calculated (float, optional): Calculated atomic radius (Å).</span>
<span class="sd">            van_der_waals_radius (float, optional): Van der Waals radius (Å).</span>
<span class="sd">            mendeleev_no (int, optional): Mendeleev number based on crystal-structure maps.</span>
<span class="sd">            electrical_resistivity (float, optional): Electrical resistivity (Ω·m).</span>
<span class="sd">            velocity_of_sound (float, optional): Velocity of sound (m/s).</span>
<span class="sd">            reflectivity (float, optional): Reflectivity (%).</span>
<span class="sd">            refractive_index (float, optional): Refractive index.</span>
<span class="sd">            poissons_ratio (float, optional): Poisson&#39;s ratio.</span>
<span class="sd">            molar_volume (float, optional): Molar volume (cm³/mol).</span>
<span class="sd">            electronic_structure (str): Electronic structure (e.g., &quot;[Ar].3d6.4s2&quot;).</span>
<span class="sd">            atomic_orbitals (dict): Orbital energies (Hartree units).</span>
<span class="sd">            atomic_orbitals_eV (dict): Orbital energies in electron volts (eV).</span>
<span class="sd">            thermal_conductivity (float, optional): Thermal conductivity (W/m·K).</span>
<span class="sd">            boiling_point (float, optional): Boiling point (K).</span>
<span class="sd">            melting_point (float, optional): Melting point (K).</span>
<span class="sd">            critical_temperature (float, optional): Critical temperature (K).</span>
<span class="sd">            superconduction_temperature (float, optional): Superconducting transition temperature (K).</span>
<span class="sd">            liquid_range (float, optional): Temperature range for liquid phase (K).</span>
<span class="sd">            bulk_modulus (float, optional): Bulk modulus (GPa).</span>
<span class="sd">            youngs_modulus (float, optional): Young&#39;s modulus (GPa).</span>
<span class="sd">            brinell_hardness (float, optional): Brinell hardness (MPa).</span>
<span class="sd">            rigidity_modulus (float, optional): Rigidity modulus (GPa).</span>
<span class="sd">            mineral_hardness (float, optional): Mohs hardness.</span>
<span class="sd">            vickers_hardness (float, optional): Vickers hardness (MPa).</span>
<span class="sd">            density_of_solid (float, optional): Density in solid phase (g/cm³).</span>
<span class="sd">            coefficient_of_linear_thermal_expansion (float, optional): Thermal expansion coefficient (K⁻¹).</span>
<span class="sd">            ground_level (float, optional): Ground energy level of the element.</span>
<span class="sd">            ionization_energies (list[Optional[float]]): Ionization energies (kJ/mol), indexed from 0.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Create an element instance and access its properties:</span>
<span class="sd">                &gt;&gt;&gt; hydrogen = Element(&quot;H&quot;)</span>
<span class="sd">                &gt;&gt;&gt; hydrogen.symbol</span>
<span class="sd">                &#39;H&#39;</span>
<span class="sd">                &gt;&gt;&gt; hydrogen.Z</span>
<span class="sd">                1</span>
<span class="sd">                &gt;&gt;&gt; hydrogen.electronic_structure</span>
<span class="sd">                &#39;1s1&#39;</span>

<span class="sd">            Access additional attributes such as atomic radius:</span>
<span class="sd">                &gt;&gt;&gt; hydrogen.atomic_radius_calculated</span>
<span class="sd">                0.53</span>

<span class="sd">        Notes:</span>
<span class="sd">            - This class supports handling of isotopes by incorporating named isotopes</span>
<span class="sd">            and their respective properties.</span>
<span class="sd">            - Attributes are populated using a JSON file that stores data about all</span>
<span class="sd">            known elements.</span>
<span class="sd">            - Some attributes are calculated or derived based on predefined constants</span>
<span class="sd">            and rules.</span>

<span class="sd">        References:</span>
<span class="sd">            - Atomic radius data: https://wikipedia.org/wiki/Atomic_radii_of_the_elements_(data_page)</span>
<span class="sd">            - Van der Waals radius: CRC Handbook of Chemistry and Physics, 91st Ed.</span>
<span class="sd">            - Mendeleev number: D. G. Pettifor, &quot;A chemical scale for crystal-structure maps,&quot;</span>
<span class="sd">            Solid State Communications, 1984.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">_pt_data</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span>

        <span class="c1"># Store key variables for quick access</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Atomic no&quot;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_named_isotope</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Is named isotope&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_named_isotope</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">_pt_data</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">_pt_data</span><span class="p">[</span><span class="n">sym</span><span class="p">][</span><span class="s2">&quot;Atomic no&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">_pt_data</span><span class="p">[</span><span class="n">sym</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Is named isotope&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span> <span class="o">=</span> <span class="n">sym</span>
                    <span class="k">break</span>
            <span class="c1"># For specified/named isotopes, treat the same as named element</span>
            <span class="c1"># (the most common isotope). Then we pad the data block with the</span>
            <span class="c1"># entries for the named element.</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">_pt_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">],</span> <span class="o">**</span><span class="n">data</span><span class="p">}</span>

        <span class="n">at_r</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Atomic radius&quot;</span><span class="p">,</span> <span class="s2">&quot;no data&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">at_r</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;no data&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_atomic_radius</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_atomic_radius</span> <span class="o">=</span> <span class="n">Length</span><span class="p">(</span><span class="n">at_r</span><span class="p">,</span> <span class="s2">&quot;ang&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atomic_mass</span> <span class="o">=</span> <span class="n">Mass</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Atomic mass&quot;</span><span class="p">],</span> <span class="s2">&quot;amu&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_atomic_mass_number</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Atomic mass no&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_atomic_mass_number</span> <span class="o">=</span> <span class="n">Mass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="s2">&quot;amu&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">data</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Key access to available element data.</span>

<span class="sd">        Args:</span>
<span class="sd">            item (str): Attribute name.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: If item not in _pt_data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">{</span>
            <span class="s2">&quot;mendeleev_no&quot;</span><span class="p">,</span>
            <span class="s2">&quot;electrical_resistivity&quot;</span><span class="p">,</span>
            <span class="s2">&quot;velocity_of_sound&quot;</span><span class="p">,</span>
            <span class="s2">&quot;reflectivity&quot;</span><span class="p">,</span>
            <span class="s2">&quot;refractive_index&quot;</span><span class="p">,</span>
            <span class="s2">&quot;poissons_ratio&quot;</span><span class="p">,</span>
            <span class="s2">&quot;molar_volume&quot;</span><span class="p">,</span>
            <span class="s2">&quot;thermal_conductivity&quot;</span><span class="p">,</span>
            <span class="s2">&quot;boiling_point&quot;</span><span class="p">,</span>
            <span class="s2">&quot;melting_point&quot;</span><span class="p">,</span>
            <span class="s2">&quot;critical_temperature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;superconduction_temperature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;liquid_range&quot;</span><span class="p">,</span>
            <span class="s2">&quot;bulk_modulus&quot;</span><span class="p">,</span>
            <span class="s2">&quot;youngs_modulus&quot;</span><span class="p">,</span>
            <span class="s2">&quot;brinell_hardness&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rigidity_modulus&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mineral_hardness&quot;</span><span class="p">,</span>
            <span class="s2">&quot;vickers_hardness&quot;</span><span class="p">,</span>
            <span class="s2">&quot;density_of_solid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;atomic_radius_calculated&quot;</span><span class="p">,</span>
            <span class="s2">&quot;van_der_waals_radius&quot;</span><span class="p">,</span>
            <span class="s2">&quot;atomic_orbitals&quot;</span><span class="p">,</span>
            <span class="s2">&quot;coefficient_of_linear_thermal_expansion&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ground_state_term_symbol&quot;</span><span class="p">,</span>
            <span class="s2">&quot;valence&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ground_level&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ionization_energies&quot;</span><span class="p">,</span>
            <span class="s2">&quot;metallic_radius&quot;</span><span class="p">,</span>
        <span class="p">}:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;no data&quot;</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No data available for </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2"> for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">val</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="n">no_bracket</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\(.*\)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
                    <span class="n">tokens</span> <span class="o">=</span> <span class="n">no_bracket</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;about&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="k">if</span> <span class="s2">&quot;10&lt;sup&gt;&quot;</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                                <span class="n">base_power</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([+-]?\d+)&quot;</span><span class="p">,</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                                <span class="n">factor</span> <span class="o">=</span> <span class="s2">&quot;e&quot;</span> <span class="o">+</span> <span class="n">base_power</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                                <span class="k">if</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;&amp;gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">]:</span>
                                    <span class="n">tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>  <span class="c1"># return the border value</span>
                                <span class="n">tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">factor</span>
                                <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="s2">&quot;electrical_resistivity&quot;</span><span class="p">:</span>
                                    <span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;ohm m&quot;</span>
                                <span class="k">elif</span> <span class="n">item</span> <span class="o">==</span> <span class="s2">&quot;coefficient_of_linear_thermal_expansion&quot;</span><span class="p">:</span>
                                    <span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;K^-1&quot;</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">unit</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                                <span class="n">val</span> <span class="o">=</span> <span class="n">FloatWithUnit</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">unit</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">unit</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&lt;sup&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;^&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&lt;/sup&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&amp;Omega;&quot;</span><span class="p">,</span> <span class="s2">&quot;ohm&quot;</span><span class="p">)</span>
                                <span class="n">units</span> <span class="o">=</span> <span class="n">Unit</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
                                <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">units</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">SUPPORTED_UNIT_NAMES</span><span class="p">):</span>
                                    <span class="n">val</span> <span class="o">=</span> <span class="n">FloatWithUnit</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">unit</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                            <span class="c1"># Ignore error. val will just remain a string.</span>
                            <span class="k">pass</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="n">item</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;refractive_index&quot;</span><span class="p">,</span> <span class="s2">&quot;melting_point&quot;</span><span class="p">)</span>
                        <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
                        <span class="ow">and</span> <span class="p">(</span><span class="n">match</span> <span class="o">:=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[\.\d]+&quot;</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span>
                    <span class="p">):</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;Ambiguous values (</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">) for </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="si">}</span><span class="s2">. Returning first float value.&quot;</span><span class="p">,</span>
                            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">match</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">val</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Element has no attribute </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Element</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Element</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">Z</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">A</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="c1"># multiply Z by 1000 to avoid hash collisions of element N with isotopes of elements N+/-1,2,3...</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_named_isotope</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Element </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set a default sort order for atomic species by Pauling electronegativity. Very</span>
<span class="sd">        useful for getting correct formulas. For example, FeO4PLi is</span>
<span class="sd">        automatically sorted into LiFePO4.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">&quot;X&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">&quot;symbol&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">X</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">X</span> <span class="k">else</span> <span class="n">other</span><span class="o">.</span><span class="n">X</span>
        <span class="k">if</span> <span class="n">x1</span> <span class="o">!=</span> <span class="n">x2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x1</span> <span class="o">&lt;</span> <span class="n">x2</span>

        <span class="c1"># There are cases where the Pauling electronegativity are exactly equal.</span>
        <span class="c1"># We then sort by symbol.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">symbol</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Element</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">X</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pauling electronegativity of element. Note that if an element does not</span>
<span class="sd">        have an Pauling electronegativity, a NaN float is returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">X</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">X</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;No Pauling electronegativity for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="si">}</span><span class="s2">. Setting to NaN. This has no physical meaning, &quot;</span>
            <span class="s2">&quot;and is mainly done to avoid errors caused by the code expecting a float.&quot;</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;NaN&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">atomic_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FloatWithUnit</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            float | None: The atomic radius of the element in Ångstroms. Can be None for</span>
<span class="sd">            some elements like noble gases.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atomic_radius</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">atomic_mass</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FloatWithUnit</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            float: The atomic mass of the element in amu.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atomic_mass</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">atomic_mass_number</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FloatWithUnit</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            float: The atomic mass of the element in amu.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atomic_mass_number</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">atomic_orbitals_eV</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The LDA energies in eV for neutral atoms, by orbital.</span>

<span class="sd">        This property contains the same info as `self.atomic_orbitals`,</span>
<span class="sd">        but uses eV for units, per matsci issue https://matsci.org/t/unit-of-atomic-orbitals-energy/54325</span>
<span class="sd">        In short, self.atomic_orbitals was meant to be in eV all along but is now kept</span>
<span class="sd">        as Hartree for backwards compatibility.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">orb_idx</span><span class="p">:</span> <span class="n">energy</span> <span class="o">*</span> <span class="n">Ha_to_eV</span> <span class="k">for</span> <span class="n">orb_idx</span><span class="p">,</span> <span class="n">energy</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomic_orbitals</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Dict of data for element.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ionization_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;First ionization energy of element.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ionization_energies</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No data available for ionization_energy for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ionization_energies</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">electron_affinity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The amount of energy released when an electron is attached to a neutral atom.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s2">&quot;Electron affinity&quot;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">electronic_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Electronic structure as string, with only valence electrons. The</span>
<span class="sd">        electrons are listed in order of increasing prinicpal quantum number</span>
<span class="sd">         (orbital number), irrespective of the actual energy level,</span>
<span class="sd">        e.g., The electronic structure for Fe is represented as &#39;[Ar].3d6.4s2&#39;</span>
<span class="sd">        even though the 3d electrons are higher in energy than the 4s.</span>

<span class="sd">        References:</span>
<span class="sd">            Kramida, A., Ralchenko, Yu., Reader, J., and NIST ASD Team (2023). NIST</span>
<span class="sd">            Atomic Spectra Database (ver. 5.11). https://physics.nist.gov/asd [2024,</span>
<span class="sd">            June 3]. National Institute of Standards and Technology, Gaithersburg,</span>
<span class="sd">            MD. DOI: https://doi.org/10.18434/T4W30F</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;&lt;/*sup&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s2">&quot;Electronic structure&quot;</span><span class="p">][</span><span class="s2">&quot;0&quot;</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">average_ionic_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FloatWithUnit</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Average ionic radius for element (with units). The average is taken</span>
<span class="sd">        over all oxidation states of the element for which data is present.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;Ionic radii&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="n">radii</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s2">&quot;Ionic radii&quot;</span><span class="p">]</span>
            <span class="n">radius</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">radii</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">radii</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">radius</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">return</span> <span class="n">FloatWithUnit</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="s2">&quot;ang&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">average_cationic_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FloatWithUnit</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Average cationic radius for element (with units). The average is</span>
<span class="sd">        taken over all positive oxidation states of the element for which</span>
<span class="sd">        data is present.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;Ionic radii&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="ow">and</span> <span class="p">(</span><span class="n">radii</span> <span class="o">:=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s2">&quot;Ionic radii&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">FloatWithUnit</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">radii</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">radii</span><span class="p">),</span> <span class="s2">&quot;ang&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">FloatWithUnit</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;ang&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">average_anionic_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FloatWithUnit</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Average anionic radius for element (with units). The average is</span>
<span class="sd">        taken over all negative oxidation states of the element for which</span>
<span class="sd">        data is present.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;Ionic radii&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="ow">and</span> <span class="p">(</span><span class="n">radii</span> <span class="o">:=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s2">&quot;Ionic radii&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]):</span>
            <span class="k">return</span> <span class="n">FloatWithUnit</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">radii</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">radii</span><span class="p">),</span> <span class="s2">&quot;ang&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">FloatWithUnit</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;ang&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ionic_radii</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">FloatWithUnit</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;All ionic radii of the element as a dict of</span>
<span class="sd">        {oxidation state: ionic radii}. Radii are given in angstrom.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;Ionic radii&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">):</span> <span class="n">FloatWithUnit</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">&quot;ang&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s2">&quot;Ionic radii&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="k">return</span> <span class="p">{}</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">number</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alternative attribute for atomic number Z.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">max_oxidation_state</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Maximum oxidation state for element.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;Oxidation states&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s2">&quot;Oxidation states&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">min_oxidation_state</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Minimum oxidation state for element.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;Oxidation states&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s2">&quot;Oxidation states&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">oxidation_states</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Tuple of all known oxidation states.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Oxidation states&quot;</span><span class="p">,</span> <span class="p">[])))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">common_oxidation_states</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Tuple of common oxidation states.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Common oxidation states&quot;</span><span class="p">,</span> <span class="p">[]))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">icsd_oxidation_states</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Tuple of all oxidation states with at least 10 instances in</span>
<span class="sd">        ICSD database AND at least 1% of entries for that element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ICSD oxidation states&quot;</span><span class="p">,</span> <span class="p">[]))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">full_electronic_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Full electronic structure as list of tuples, in order of increasing</span>
<span class="sd">        energy level (according to the Madelung rule). Therefore, the final</span>
<span class="sd">        element in the list gives the electronic structure of the valence shell.</span>

<span class="sd">        For example, the electronic structure for Fe is represented as:</span>
<span class="sd">        [(1, &quot;s&quot;, 2), (2, &quot;s&quot;, 2), (2, &quot;p&quot;, 6), (3, &quot;s&quot;, 2), (3, &quot;p&quot;, 6),</span>
<span class="sd">        (4, &quot;s&quot;, 2), (3, &quot;d&quot;, 6)].</span>

<span class="sd">        References:</span>
<span class="sd">            Kramida, A., Ralchenko, Yu., Reader, J., and NIST ASD Team (2023). NIST</span>
<span class="sd">            Atomic Spectra Database (ver. 5.11). https://physics.nist.gov/asd [2024,</span>
<span class="sd">            June 3]. National Institute of Standards and Technology, Gaithersburg,</span>
<span class="sd">            MD. DOI: https://doi.org/10.18434/T4W30F</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">e_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">electronic_structure</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">parse_orbital</span><span class="p">(</span><span class="n">orb_str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">match</span> <span class="o">:=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(\d+)([spdfg]+)(\d+)&quot;</span><span class="p">,</span> <span class="n">orb_str</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">match</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">match</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">orb_str</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_orbital</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">e_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;[&quot;</span><span class="p">:</span>
            <span class="n">sym</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Element</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span><span class="o">.</span><span class="n">full_electronic_structure</span><span class="p">)</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="c1"># sort the final electronic structure by increasing energy level</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_madelung</span><span class="o">.</span><span class="n">index</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">n_electrons</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Total number of electrons in the Element.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_electronic_structure</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">valence</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Valence subshell angular moment (L) and number of valence e- (v_e),</span>
<span class="sd">        obtained from full electron config, where L=0, 1, 2, or 3 for s, p, d,</span>
<span class="sd">        and f orbitals, respectively.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">group</span> <span class="o">==</span> <span class="mi">18</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">0</span>  <span class="c1"># The number of valence of noble gas is 0</span>

        <span class="n">L_symbols</span> <span class="o">=</span> <span class="s2">&quot;SPDFGHIKLMNOQRTUVWXYZ&quot;</span>
        <span class="n">valence</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">full_electron_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_electronic_structure</span>
        <span class="n">last_orbital</span> <span class="o">=</span> <span class="n">full_electron_config</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">l_symbol</span><span class="p">,</span> <span class="n">ne</span> <span class="ow">in</span> <span class="n">full_electron_config</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">L_symbols</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">l_symbol</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ne</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="ow">or</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">l_symbol</span><span class="p">,</span> <span class="n">ne</span><span class="p">)</span> <span class="o">==</span> <span class="n">last_orbital</span> <span class="ow">and</span> <span class="n">ne</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">valence</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
            <span class="p">):</span>  <span class="c1"># check for full last shell (e.g. column 2)</span>
                <span class="n">valence</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">idx</span><span class="p">,</span> <span class="n">ne</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">valence</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2"> has ambiguous valence&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">valence</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">term_symbols</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;All possible Russell-Saunders term symbol of the Element.</span>
<span class="sd">        eg. L = 1, n_e = 2 (s2) returns [[&#39;1D2&#39;], [&#39;3P0&#39;, &#39;3P1&#39;, &#39;3P2&#39;], [&#39;1S0&#39;]].</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_noble_gas</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[[</span><span class="s2">&quot;1S0&quot;</span><span class="p">]]</span>

        <span class="n">L</span><span class="p">,</span> <span class="n">v_e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valence</span>

        <span class="c1"># for one electron in subshell L</span>
        <span class="n">ml</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">L</span><span class="p">,</span> <span class="n">L</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">ms</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]</span>
        <span class="c1"># all possible configurations of ml,ms for one e in subshell L</span>
        <span class="n">ml_ms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="n">ml</span><span class="p">,</span> <span class="n">ms</span><span class="p">))</span>

        <span class="c1"># Number of possible configurations for r electrons in subshell L.</span>
        <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">L</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="c1"># the combination of n_e electrons configurations</span>
        <span class="c1"># C^{n}_{n_e}</span>
        <span class="n">e_config_combs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">v_e</span><span class="p">))</span>

        <span class="c1"># Total ML = sum(ml1, ml2), Total MS = sum(ms1, ms2)</span>
        <span class="n">TL</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">ml_ms</span><span class="p">[</span><span class="n">comb</span><span class="p">[</span><span class="n">e</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">v_e</span><span class="p">))</span> <span class="k">for</span> <span class="n">comb</span> <span class="ow">in</span> <span class="n">e_config_combs</span><span class="p">]</span>
        <span class="n">TS</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">ml_ms</span><span class="p">[</span><span class="n">comb</span><span class="p">[</span><span class="n">e</span><span class="p">]][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">v_e</span><span class="p">))</span> <span class="k">for</span> <span class="n">comb</span> <span class="ow">in</span> <span class="n">e_config_combs</span><span class="p">]</span>
        <span class="n">comb_counter</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">TL</span><span class="p">,</span> <span class="n">TS</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

        <span class="n">term_symbols</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">L_symbols</span> <span class="o">=</span> <span class="s2">&quot;SPDFGHIKLMNOQRTUVWXYZ&quot;</span>
        <span class="k">while</span> <span class="nb">sum</span><span class="p">(</span><span class="n">comb_counter</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Start from the lowest freq combination,</span>
            <span class="c1"># which corresponds to largest abs(L) and smallest abs(S)</span>
            <span class="n">L</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">comb_counter</span><span class="p">)</span>

            <span class="n">J</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">L</span> <span class="o">-</span> <span class="n">S</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">term_symbols</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">S</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}{</span><span class="n">L_symbols</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">L</span><span class="p">)]</span><span class="si">}{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">J</span><span class="p">])</span>

            <span class="c1"># Delete all configurations included in this term</span>
            <span class="k">for</span> <span class="n">ML</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">L</span><span class="p">,</span> <span class="n">L</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">MS</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="o">-</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">ML</span><span class="p">,</span> <span class="n">MS</span><span class="p">)</span> <span class="ow">in</span> <span class="n">comb_counter</span><span class="p">:</span>
                        <span class="n">comb_counter</span><span class="p">[</span><span class="n">ML</span><span class="p">,</span> <span class="n">MS</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
                        <span class="k">if</span> <span class="n">comb_counter</span><span class="p">[</span><span class="n">ML</span><span class="p">,</span> <span class="n">MS</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="k">del</span> <span class="n">comb_counter</span><span class="p">[</span><span class="n">ML</span><span class="p">,</span> <span class="n">MS</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">term_symbols</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ground_state_term_symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Ground state term symbol.</span>
<span class="sd">        Selected based on Hund&#39;s Rule.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">L_symbols</span> <span class="o">=</span> <span class="s2">&quot;SPDFGHIKLMNOQRTUVWXYZ&quot;</span>

        <span class="n">term_symbols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">term_symbols</span>
        <span class="n">term_symbol_flat</span> <span class="o">=</span> <span class="p">{</span>  <span class="c1"># type: ignore[var-annotated]</span>
            <span class="n">term</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;multiplicity&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">term</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                <span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="n">L_symbols</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">term</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                <span class="s2">&quot;J&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">term</span><span class="p">[</span><span class="mi">2</span><span class="p">:]),</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">term_symbols</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
        <span class="p">}</span>

        <span class="n">multi</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;multiplicity&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">_terms</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">term_symbol_flat</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="n">max_multi_terms</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">symbol</span><span class="p">:</span> <span class="n">item</span> <span class="k">for</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">term_symbol_flat</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;multiplicity&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">multi</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="n">Ls</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">_terms</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">max_multi_terms</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="n">max_L_terms</span> <span class="o">=</span> <span class="p">{</span><span class="n">symbol</span><span class="p">:</span> <span class="n">item</span> <span class="k">for</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">term_symbol_flat</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">Ls</span><span class="p">)}</span>

        <span class="n">J_sorted_terms</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">max_L_terms</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;J&quot;</span><span class="p">])</span>
        <span class="n">L</span><span class="p">,</span> <span class="n">v_e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valence</span>
        <span class="k">return</span> <span class="n">J_sorted_terms</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">v_e</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">L</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="n">J_sorted_terms</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<div class="viewcode-block" id="ElementBase.from_Z">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.ElementBase.from_Z">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_Z</span><span class="p">(</span><span class="n">Z</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">A</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Element</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an element from an atomic number.</span>

<span class="sd">        Args:</span>
<span class="sd">            Z (int): Atomic number (number of protons)</span>
<span class="sd">            A (int | None) : Atomic mass number (number of protons + neutrons)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Element with atomic number Z.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">sym</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">_pt_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">atomic_mass_num</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Atomic mass no&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">A</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Atomic no&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">Z</span> <span class="ow">and</span> <span class="n">atomic_mass_num</span> <span class="o">==</span> <span class="n">A</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Element</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected atomic number </span><span class="si">{</span><span class="n">Z</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="ElementBase.from_name">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.ElementBase.from_name">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_name</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Element</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an element from its long name.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: Long name of the element, e.g. &#39;Hydrogen&#39; or &#39;Iron&#39;. Not case-sensitive.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Element with the name &#39;name&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Accommodate the British-English world</span>
        <span class="n">uk_to_us</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;aluminium&quot;</span><span class="p">:</span> <span class="s2">&quot;aluminum&quot;</span><span class="p">,</span> <span class="s2">&quot;caesium&quot;</span><span class="p">:</span> <span class="s2">&quot;cesium&quot;</span><span class="p">}</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">uk_to_us</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">name</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">sym</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">_pt_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">name</span><span class="o">.</span><span class="n">capitalize</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">Element</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No element with the </span><span class="si">{</span><span class="n">name</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="ElementBase.from_row_and_group">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.ElementBase.from_row_and_group">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_row_and_group</span><span class="p">(</span><span class="n">row</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">group</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Element</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an element from a row and group number.</span>

<span class="sd">        Important Note: For lanthanoids and actinoids, the row number must</span>
<span class="sd">        be 8 and 9, respectively, and the group number must be</span>
<span class="sd">        between 3 (La, Ac) and 17 (Lu, Lr). This is different than the</span>
<span class="sd">        value for Element(symbol).row and Element(symbol).group for these</span>
<span class="sd">        elements.</span>

<span class="sd">        Args:</span>
<span class="sd">            row (int): (pseudo) row number. This is the</span>
<span class="sd">                standard row number except for the lanthanoids</span>
<span class="sd">                and actinoids for which it is 8 or 9, respectively.</span>
<span class="sd">            group (int): (pseudo) group number. This is the</span>
<span class="sd">                standard group number except for the lanthanoids</span>
<span class="sd">                and actinoids for which it is 3 (La, Ac) to 17 (Lu, Lr).</span>

<span class="sd">        Note:</span>
<span class="sd">            The 18 group number system is used, i.e. noble gases are group 18.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">_pt_data</span><span class="p">:</span>
            <span class="n">el</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span>
            <span class="k">if</span> <span class="mi">57</span> <span class="o">&lt;=</span> <span class="n">el</span><span class="o">.</span><span class="n">Z</span> <span class="o">&lt;=</span> <span class="mi">71</span><span class="p">:</span>
                <span class="n">el_pseudo_row</span> <span class="o">=</span> <span class="mi">8</span>
                <span class="n">el_pseudo_group</span> <span class="o">=</span> <span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">Z</span> <span class="o">-</span> <span class="mi">54</span><span class="p">)</span> <span class="o">%</span> <span class="mi">32</span>
            <span class="k">elif</span> <span class="mi">89</span> <span class="o">&lt;=</span> <span class="n">el</span><span class="o">.</span><span class="n">Z</span> <span class="o">&lt;=</span> <span class="mi">103</span><span class="p">:</span>
                <span class="n">el_pseudo_row</span> <span class="o">=</span> <span class="mi">9</span>
                <span class="n">el_pseudo_group</span> <span class="o">=</span> <span class="p">(</span><span class="n">el</span><span class="o">.</span><span class="n">Z</span> <span class="o">-</span> <span class="mi">54</span><span class="p">)</span> <span class="o">%</span> <span class="mi">32</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">el_pseudo_row</span> <span class="o">=</span> <span class="n">el</span><span class="o">.</span><span class="n">row</span>
                <span class="n">el_pseudo_group</span> <span class="o">=</span> <span class="n">el</span><span class="o">.</span><span class="n">group</span>
            <span class="k">if</span> <span class="n">el_pseudo_row</span> <span class="o">==</span> <span class="n">row</span> <span class="ow">and</span> <span class="n">el_pseudo_group</span> <span class="o">==</span> <span class="n">group</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">el</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No element with this row and group!&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="ElementBase.is_valid_symbol">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.ElementBase.is_valid_symbol">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_valid_symbol</span><span class="p">(</span><span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if symbol (e.g., &quot;H&quot;) is a valid element symbol.</span>

<span class="sd">        Args:</span>
<span class="sd">            symbol (str): Element symbol</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if symbol is a valid element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">Element</span><span class="o">.</span><span class="n">__members__</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">row</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The periodic table row of the element.</span>
<span class="sd">        Note: For lanthanoids and actinoids, the row is always 6 or 7,</span>
<span class="sd">        respectively.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="mi">57</span> <span class="o">&lt;=</span> <span class="n">z</span> <span class="o">&lt;=</span> <span class="mi">71</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">6</span>
        <span class="k">if</span> <span class="mi">89</span> <span class="o">&lt;=</span> <span class="n">z</span> <span class="o">&lt;=</span> <span class="mi">103</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">7</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">size</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">_pt_row_sizes</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">total</span> <span class="o">+=</span> <span class="n">size</span>
            <span class="k">if</span> <span class="n">total</span> <span class="o">&gt;=</span> <span class="n">z</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">idx</span>
        <span class="k">return</span> <span class="mi">8</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">group</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The periodic table group of the element.</span>
<span class="sd">        Note: For lanthanoids and actinoids, the group is always 3.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span>
        <span class="k">if</span> <span class="n">z</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">z</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">18</span>

        <span class="k">if</span> <span class="mi">3</span> <span class="o">&lt;=</span> <span class="n">z</span> <span class="o">&lt;=</span> <span class="mi">18</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="mi">8</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">18</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="mi">8</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="mi">8</span>
            <span class="k">return</span> <span class="mi">10</span> <span class="o">+</span> <span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="mi">8</span>

        <span class="k">if</span> <span class="mi">19</span> <span class="o">&lt;=</span> <span class="n">z</span> <span class="o">&lt;=</span> <span class="mi">54</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="mi">18</span><span class="p">)</span> <span class="o">%</span> <span class="mi">18</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">18</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="mi">18</span><span class="p">)</span> <span class="o">%</span> <span class="mi">18</span>

        <span class="k">if</span> <span class="p">(</span><span class="mi">57</span> <span class="o">&lt;=</span> <span class="n">z</span> <span class="o">&lt;=</span> <span class="mi">71</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="mi">89</span> <span class="o">&lt;=</span> <span class="n">z</span> <span class="o">&lt;=</span> <span class="mi">103</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">3</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="mi">54</span><span class="p">)</span> <span class="o">%</span> <span class="mi">32</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">18</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="mi">54</span><span class="p">)</span> <span class="o">%</span> <span class="mi">32</span> <span class="o">&gt;=</span> <span class="mi">18</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="mi">54</span><span class="p">)</span> <span class="o">%</span> <span class="mi">32</span> <span class="o">-</span> <span class="mi">14</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="mi">54</span><span class="p">)</span> <span class="o">%</span> <span class="mi">32</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">block</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The block character &quot;s, p, d, f&quot;.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_actinoid</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_lanthanoid</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">71</span><span class="p">,</span> <span class="mi">103</span><span class="p">]:</span>
            <span class="k">return</span> <span class="s2">&quot;f&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_actinoid</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_lanthanoid</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">group</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">13</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;d&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">group</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
            <span class="k">return</span> <span class="s2">&quot;s&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">group</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">19</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;p&quot;</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unable to determine block.&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_noble_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;True if element is noble gas.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">118</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_transition_metal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;True if element is a transition metal.&quot;&quot;&quot;</span>
        <span class="n">ns</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span> <span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">39</span><span class="p">,</span> <span class="mi">49</span><span class="p">),</span> <span class="mi">57</span><span class="p">,</span> <span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">72</span><span class="p">,</span> <span class="mi">81</span><span class="p">),</span> <span class="mi">89</span><span class="p">,</span> <span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">104</span><span class="p">,</span> <span class="mi">113</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="ow">in</span> <span class="n">ns</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_post_transition_metal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;True if element is a post-transition or poor metal.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Al&quot;</span><span class="p">,</span> <span class="s2">&quot;Ga&quot;</span><span class="p">,</span> <span class="s2">&quot;In&quot;</span><span class="p">,</span> <span class="s2">&quot;Tl&quot;</span><span class="p">,</span> <span class="s2">&quot;Sn&quot;</span><span class="p">,</span> <span class="s2">&quot;Pb&quot;</span><span class="p">,</span> <span class="s2">&quot;Bi&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_rare_earth</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;True if element is a rare earth element, including Lanthanides (La)</span>
<span class="sd">        series, Actinides (Ac) series, Scandium (Sc) and Yttrium (Y).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_lanthanoid</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_actinoid</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;Sc&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_metal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;True if is a metal.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_alkali</span>
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_alkaline</span>
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_post_transition_metal</span>
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_transition_metal</span>
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_lanthanoid</span>
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_actinoid</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_metalloid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;True if element is a metalloid.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;Si&quot;</span><span class="p">,</span> <span class="s2">&quot;Ge&quot;</span><span class="p">,</span> <span class="s2">&quot;As&quot;</span><span class="p">,</span> <span class="s2">&quot;Sb&quot;</span><span class="p">,</span> <span class="s2">&quot;Te&quot;</span><span class="p">,</span> <span class="s2">&quot;Po&quot;</span><span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_alkali</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;True if element is an alkali metal.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">87</span><span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_alkaline</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;True if element is an alkaline earth metal (group II).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">88</span><span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_halogen</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;True if element is a halogen.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">9</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">85</span><span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_chalcogen</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;True if element is a chalcogen.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">84</span><span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_lanthanoid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;True if element is a lanthanoid.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">56</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="o">&lt;</span> <span class="mi">72</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_actinoid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;True if element is a actinoid.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">88</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="o">&lt;</span> <span class="mi">104</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_radioactive</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;True if element is radioactive.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">43</span><span class="p">,</span> <span class="mi">61</span><span class="p">}</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="o">&gt;=</span> <span class="mi">84</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_quadrupolar</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this element can be quadrupolar.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;NMR Quadrupole Moment&quot;</span><span class="p">,</span> <span class="p">{}))</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">nmr_quadrupole_moment</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">FloatWithUnit</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A dictionary the nuclear electric quadrupole moment in units of</span>
<span class="sd">        e*millibarns for various isotopes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">FloatWithUnit</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">&quot;mbarn&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;NMR Quadrupole Moment&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">iupac_ordering</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Ordering according to Table VI of &quot;Nomenclature of Inorganic Chemistry</span>
<span class="sd">        (IUPAC Recommendations 2005)&quot;. This ordering effectively follows the</span>
<span class="sd">        groups and rows of the periodic table, except the Lanthanides, Actinides</span>
<span class="sd">        and hydrogen.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s2">&quot;IUPAC ordering&quot;</span><span class="p">]</span>

<div class="viewcode-block" id="ElementBase.as_dict">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.ElementBase.as_dict">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">,</span> <span class="s2">&quot;@module&quot;</span><span class="p">,</span> <span class="s2">&quot;@class&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Serialize to MSONable dict representation e.g. to write to disk as JSON.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;@module&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__module__</span><span class="p">,</span>
            <span class="s2">&quot;@class&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
            <span class="s2">&quot;element&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">,</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="ElementBase.from_dict">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.ElementBase.from_dict">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span><span class="n">dct</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Element</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deserialize from MSONable dict representation.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Element</span><span class="p">(</span><span class="n">dct</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">])</span></div>


<div class="viewcode-block" id="ElementBase.print_periodic_table">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.ElementBase.print_periodic_table">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">print_periodic_table</span><span class="p">(</span><span class="n">filter_function</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A pretty ASCII printer for the periodic table, based on some</span>
<span class="sd">        filter_function.</span>

<span class="sd">        Args:</span>
<span class="sd">            filter_function: A filtering function taking an Element as input</span>
<span class="sd">                and returning a boolean. For example, setting</span>
<span class="sd">                filter_function = lambda el: el.X &gt; 2 will print a periodic</span>
<span class="sd">                table containing only elements with Pauling electronegativity &gt; 2.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
            <span class="n">row_str</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">19</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">el</span> <span class="o">=</span> <span class="n">Element</span><span class="o">.</span><span class="n">from_row_and_group</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="n">el</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">el</span> <span class="ow">and</span> <span class="p">((</span><span class="ow">not</span> <span class="n">filter_function</span><span class="p">)</span> <span class="ow">or</span> <span class="n">filter_function</span><span class="p">(</span><span class="n">el</span><span class="p">)):</span>
                    <span class="n">row_str</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">el</span><span class="o">.</span><span class="n">symbol</span><span class="si">:</span><span class="s2">3s</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">row_str</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;   &quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row_str</span><span class="p">))</span></div>
</div>



<span class="k">class</span><span class="w"> </span><span class="nc">_ElementMeta</span><span class="p">(</span><span class="n">EnumMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Override Element to handle isotopes.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Skip named isotopes when iterating.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">elem</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">elem</span><span class="o">.</span><span class="n">_is_named_isotope</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">named_isotopes</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all named isotopes.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">elem</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">()</span> <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">_is_named_isotope</span><span class="p">)</span>


<div class="viewcode-block" id="Element">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.Element">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Element</span><span class="p">(</span><span class="n">ElementBase</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">_ElementMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Enum representing an element in the periodic table.&quot;&quot;&quot;</span>

    <span class="c1"># This name = value convention is redundant and dumb, but unfortunately is</span>
    <span class="c1"># necessary to preserve backwards compatibility with a time when Element is</span>
    <span class="c1"># a regular object that is constructed with Element(symbol).</span>
    <span class="n">H</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span>
    <span class="n">D</span> <span class="o">=</span> <span class="s2">&quot;D&quot;</span>
    <span class="n">T</span> <span class="o">=</span> <span class="s2">&quot;T&quot;</span>
    <span class="n">He</span> <span class="o">=</span> <span class="s2">&quot;He&quot;</span>
    <span class="n">Li</span> <span class="o">=</span> <span class="s2">&quot;Li&quot;</span>
    <span class="n">Be</span> <span class="o">=</span> <span class="s2">&quot;Be&quot;</span>
    <span class="n">B</span> <span class="o">=</span> <span class="s2">&quot;B&quot;</span>
    <span class="n">C</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="s2">&quot;N&quot;</span>
    <span class="n">O</span> <span class="o">=</span> <span class="s2">&quot;O&quot;</span>  <span class="c1"># noqa: E741</span>
    <span class="n">F</span> <span class="o">=</span> <span class="s2">&quot;F&quot;</span>
    <span class="n">Ne</span> <span class="o">=</span> <span class="s2">&quot;Ne&quot;</span>
    <span class="n">Na</span> <span class="o">=</span> <span class="s2">&quot;Na&quot;</span>
    <span class="n">Mg</span> <span class="o">=</span> <span class="s2">&quot;Mg&quot;</span>
    <span class="n">Al</span> <span class="o">=</span> <span class="s2">&quot;Al&quot;</span>
    <span class="n">Si</span> <span class="o">=</span> <span class="s2">&quot;Si&quot;</span>
    <span class="n">P</span> <span class="o">=</span> <span class="s2">&quot;P&quot;</span>
    <span class="n">S</span> <span class="o">=</span> <span class="s2">&quot;S&quot;</span>
    <span class="n">Cl</span> <span class="o">=</span> <span class="s2">&quot;Cl&quot;</span>
    <span class="n">Ar</span> <span class="o">=</span> <span class="s2">&quot;Ar&quot;</span>
    <span class="n">K</span> <span class="o">=</span> <span class="s2">&quot;K&quot;</span>
    <span class="n">Ca</span> <span class="o">=</span> <span class="s2">&quot;Ca&quot;</span>
    <span class="n">Sc</span> <span class="o">=</span> <span class="s2">&quot;Sc&quot;</span>
    <span class="n">Ti</span> <span class="o">=</span> <span class="s2">&quot;Ti&quot;</span>
    <span class="n">V</span> <span class="o">=</span> <span class="s2">&quot;V&quot;</span>
    <span class="n">Cr</span> <span class="o">=</span> <span class="s2">&quot;Cr&quot;</span>
    <span class="n">Mn</span> <span class="o">=</span> <span class="s2">&quot;Mn&quot;</span>
    <span class="n">Fe</span> <span class="o">=</span> <span class="s2">&quot;Fe&quot;</span>
    <span class="n">Co</span> <span class="o">=</span> <span class="s2">&quot;Co&quot;</span>
    <span class="n">Ni</span> <span class="o">=</span> <span class="s2">&quot;Ni&quot;</span>
    <span class="n">Cu</span> <span class="o">=</span> <span class="s2">&quot;Cu&quot;</span>
    <span class="n">Zn</span> <span class="o">=</span> <span class="s2">&quot;Zn&quot;</span>
    <span class="n">Ga</span> <span class="o">=</span> <span class="s2">&quot;Ga&quot;</span>
    <span class="n">Ge</span> <span class="o">=</span> <span class="s2">&quot;Ge&quot;</span>
    <span class="n">As</span> <span class="o">=</span> <span class="s2">&quot;As&quot;</span>
    <span class="n">Se</span> <span class="o">=</span> <span class="s2">&quot;Se&quot;</span>
    <span class="n">Br</span> <span class="o">=</span> <span class="s2">&quot;Br&quot;</span>
    <span class="n">Kr</span> <span class="o">=</span> <span class="s2">&quot;Kr&quot;</span>
    <span class="n">Rb</span> <span class="o">=</span> <span class="s2">&quot;Rb&quot;</span>
    <span class="n">Sr</span> <span class="o">=</span> <span class="s2">&quot;Sr&quot;</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="s2">&quot;Y&quot;</span>
    <span class="n">Zr</span> <span class="o">=</span> <span class="s2">&quot;Zr&quot;</span>
    <span class="n">Nb</span> <span class="o">=</span> <span class="s2">&quot;Nb&quot;</span>
    <span class="n">Mo</span> <span class="o">=</span> <span class="s2">&quot;Mo&quot;</span>
    <span class="n">Tc</span> <span class="o">=</span> <span class="s2">&quot;Tc&quot;</span>
    <span class="n">Ru</span> <span class="o">=</span> <span class="s2">&quot;Ru&quot;</span>
    <span class="n">Rh</span> <span class="o">=</span> <span class="s2">&quot;Rh&quot;</span>
    <span class="n">Pd</span> <span class="o">=</span> <span class="s2">&quot;Pd&quot;</span>
    <span class="n">Ag</span> <span class="o">=</span> <span class="s2">&quot;Ag&quot;</span>
    <span class="n">Cd</span> <span class="o">=</span> <span class="s2">&quot;Cd&quot;</span>
    <span class="n">In</span> <span class="o">=</span> <span class="s2">&quot;In&quot;</span>
    <span class="n">Sn</span> <span class="o">=</span> <span class="s2">&quot;Sn&quot;</span>
    <span class="n">Sb</span> <span class="o">=</span> <span class="s2">&quot;Sb&quot;</span>
    <span class="n">Te</span> <span class="o">=</span> <span class="s2">&quot;Te&quot;</span>
    <span class="n">I</span> <span class="o">=</span> <span class="s2">&quot;I&quot;</span>  <span class="c1"># noqa: E741</span>
    <span class="n">Xe</span> <span class="o">=</span> <span class="s2">&quot;Xe&quot;</span>
    <span class="n">Cs</span> <span class="o">=</span> <span class="s2">&quot;Cs&quot;</span>
    <span class="n">Ba</span> <span class="o">=</span> <span class="s2">&quot;Ba&quot;</span>
    <span class="n">La</span> <span class="o">=</span> <span class="s2">&quot;La&quot;</span>
    <span class="n">Ce</span> <span class="o">=</span> <span class="s2">&quot;Ce&quot;</span>
    <span class="n">Pr</span> <span class="o">=</span> <span class="s2">&quot;Pr&quot;</span>
    <span class="n">Nd</span> <span class="o">=</span> <span class="s2">&quot;Nd&quot;</span>
    <span class="n">Pm</span> <span class="o">=</span> <span class="s2">&quot;Pm&quot;</span>
    <span class="n">Sm</span> <span class="o">=</span> <span class="s2">&quot;Sm&quot;</span>
    <span class="n">Eu</span> <span class="o">=</span> <span class="s2">&quot;Eu&quot;</span>
    <span class="n">Gd</span> <span class="o">=</span> <span class="s2">&quot;Gd&quot;</span>
    <span class="n">Tb</span> <span class="o">=</span> <span class="s2">&quot;Tb&quot;</span>
    <span class="n">Dy</span> <span class="o">=</span> <span class="s2">&quot;Dy&quot;</span>
    <span class="n">Ho</span> <span class="o">=</span> <span class="s2">&quot;Ho&quot;</span>
    <span class="n">Er</span> <span class="o">=</span> <span class="s2">&quot;Er&quot;</span>
    <span class="n">Tm</span> <span class="o">=</span> <span class="s2">&quot;Tm&quot;</span>
    <span class="n">Yb</span> <span class="o">=</span> <span class="s2">&quot;Yb&quot;</span>
    <span class="n">Lu</span> <span class="o">=</span> <span class="s2">&quot;Lu&quot;</span>
    <span class="n">Hf</span> <span class="o">=</span> <span class="s2">&quot;Hf&quot;</span>
    <span class="n">Ta</span> <span class="o">=</span> <span class="s2">&quot;Ta&quot;</span>
    <span class="n">W</span> <span class="o">=</span> <span class="s2">&quot;W&quot;</span>
    <span class="n">Re</span> <span class="o">=</span> <span class="s2">&quot;Re&quot;</span>
    <span class="n">Os</span> <span class="o">=</span> <span class="s2">&quot;Os&quot;</span>
    <span class="n">Ir</span> <span class="o">=</span> <span class="s2">&quot;Ir&quot;</span>
    <span class="n">Pt</span> <span class="o">=</span> <span class="s2">&quot;Pt&quot;</span>
    <span class="n">Au</span> <span class="o">=</span> <span class="s2">&quot;Au&quot;</span>
    <span class="n">Hg</span> <span class="o">=</span> <span class="s2">&quot;Hg&quot;</span>
    <span class="n">Tl</span> <span class="o">=</span> <span class="s2">&quot;Tl&quot;</span>
    <span class="n">Pb</span> <span class="o">=</span> <span class="s2">&quot;Pb&quot;</span>
    <span class="n">Bi</span> <span class="o">=</span> <span class="s2">&quot;Bi&quot;</span>
    <span class="n">Po</span> <span class="o">=</span> <span class="s2">&quot;Po&quot;</span>
    <span class="n">At</span> <span class="o">=</span> <span class="s2">&quot;At&quot;</span>
    <span class="n">Rn</span> <span class="o">=</span> <span class="s2">&quot;Rn&quot;</span>
    <span class="n">Fr</span> <span class="o">=</span> <span class="s2">&quot;Fr&quot;</span>
    <span class="n">Ra</span> <span class="o">=</span> <span class="s2">&quot;Ra&quot;</span>
    <span class="n">Ac</span> <span class="o">=</span> <span class="s2">&quot;Ac&quot;</span>
    <span class="n">Th</span> <span class="o">=</span> <span class="s2">&quot;Th&quot;</span>
    <span class="n">Pa</span> <span class="o">=</span> <span class="s2">&quot;Pa&quot;</span>
    <span class="n">U</span> <span class="o">=</span> <span class="s2">&quot;U&quot;</span>
    <span class="n">Np</span> <span class="o">=</span> <span class="s2">&quot;Np&quot;</span>
    <span class="n">Pu</span> <span class="o">=</span> <span class="s2">&quot;Pu&quot;</span>
    <span class="n">Am</span> <span class="o">=</span> <span class="s2">&quot;Am&quot;</span>
    <span class="n">Cm</span> <span class="o">=</span> <span class="s2">&quot;Cm&quot;</span>
    <span class="n">Bk</span> <span class="o">=</span> <span class="s2">&quot;Bk&quot;</span>
    <span class="n">Cf</span> <span class="o">=</span> <span class="s2">&quot;Cf&quot;</span>
    <span class="n">Es</span> <span class="o">=</span> <span class="s2">&quot;Es&quot;</span>
    <span class="n">Fm</span> <span class="o">=</span> <span class="s2">&quot;Fm&quot;</span>
    <span class="n">Md</span> <span class="o">=</span> <span class="s2">&quot;Md&quot;</span>
    <span class="n">No</span> <span class="o">=</span> <span class="s2">&quot;No&quot;</span>
    <span class="n">Lr</span> <span class="o">=</span> <span class="s2">&quot;Lr&quot;</span>
    <span class="n">Rf</span> <span class="o">=</span> <span class="s2">&quot;Rf&quot;</span>
    <span class="n">Db</span> <span class="o">=</span> <span class="s2">&quot;Db&quot;</span>
    <span class="n">Sg</span> <span class="o">=</span> <span class="s2">&quot;Sg&quot;</span>
    <span class="n">Bh</span> <span class="o">=</span> <span class="s2">&quot;Bh&quot;</span>
    <span class="n">Hs</span> <span class="o">=</span> <span class="s2">&quot;Hs&quot;</span>
    <span class="n">Mt</span> <span class="o">=</span> <span class="s2">&quot;Mt&quot;</span>
    <span class="n">Ds</span> <span class="o">=</span> <span class="s2">&quot;Ds&quot;</span>
    <span class="n">Rg</span> <span class="o">=</span> <span class="s2">&quot;Rg&quot;</span>
    <span class="n">Cn</span> <span class="o">=</span> <span class="s2">&quot;Cn&quot;</span>
    <span class="n">Nh</span> <span class="o">=</span> <span class="s2">&quot;Nh&quot;</span>
    <span class="n">Fl</span> <span class="o">=</span> <span class="s2">&quot;Fl&quot;</span>
    <span class="n">Mc</span> <span class="o">=</span> <span class="s2">&quot;Mc&quot;</span>
    <span class="n">Lv</span> <span class="o">=</span> <span class="s2">&quot;Lv&quot;</span>
    <span class="n">Ts</span> <span class="o">=</span> <span class="s2">&quot;Ts&quot;</span>
    <span class="n">Og</span> <span class="o">=</span> <span class="s2">&quot;Og&quot;</span></div>



<div class="viewcode-block" id="Species">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.Species">[docs]</a>
<span class="nd">@functools</span><span class="o">.</span><span class="n">total_ordering</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Species</span><span class="p">(</span><span class="n">MSONable</span><span class="p">,</span> <span class="n">Stringify</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An extension of Element with optional oxidation state and spin. Properties associated</span>
<span class="sd">    with Species should be &quot;idealized&quot; values, not calculated values. For example,</span>
<span class="sd">    high-spin Fe2+ may be assigned an idealized spin of +5, but an actual Fe2+ site may be</span>
<span class="sd">    calculated to have a magmom of +4.5. Calculated properties should be assigned to Site</span>
<span class="sd">    objects, and not Species.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">STRING_MODE</span> <span class="o">=</span> <span class="s2">&quot;SUPERSCRIPT&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">symbol</span><span class="p">:</span> <span class="n">SpeciesLike</span><span class="p">,</span>
        <span class="n">oxidation_state</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">spin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            symbol (str): Element symbol optionally incl. oxidation state. E.g. Fe, Fe2+, O2-.</span>
<span class="sd">            oxidation_state (float): Explicit oxidation state of element, e.g. -2, -1, 0, 1, 2, ...</span>
<span class="sd">                If oxidation state is present in symbol, this argument is ignored.</span>
<span class="sd">            spin: Spin associated with Species. Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If oxidation state passed both in symbol string and via</span>
<span class="sd">                oxidation_state kwarg.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">oxidation_state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">symbol</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Oxidation state should be specified either in </span><span class="si">{</span><span class="n">symbol</span><span class="si">=}</span><span class="s2"> or as </span><span class="si">{</span><span class="n">oxidation_state</span><span class="si">=}</span><span class="s2">, not both.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">symbol</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)):</span>
            <span class="c1"># Extract oxidation state from symbol</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">symbol</span><span class="p">,</span> <span class="n">oxi</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([A-Za-z]+)([0-9\.0-9]*[\+\-])&quot;</span><span class="p">,</span> <span class="n">symbol</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>  <span class="c1"># type: ignore[union-attr]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_oxi_state</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="s2">&quot;+&quot;</span> <span class="ow">in</span> <span class="n">oxi</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">oxi</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ParseError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to parse </span><span class="si">{</span><span class="n">symbol</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_oxi_state</span> <span class="o">=</span> <span class="n">oxidation_state</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_el</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_spin</span> <span class="o">=</span> <span class="n">spin</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Allow Specie to inherit properties of underlying element.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_el</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dct</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dct</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Species is equal to other only if element and oxidation states are exactly the same.&quot;&quot;&quot;</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;oxi_state&quot;</span><span class="p">,</span> <span class="s2">&quot;symbol&quot;</span><span class="p">,</span> <span class="s2">&quot;spin&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">attribute</span><span class="p">)</span> <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="o">==</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Equal Species should have the same str representation, hence</span>
<span class="sd">        should hash equally. Unequal Species will have different str</span>
<span class="sd">        representations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set a default sort order for atomic species by Pauling electronegativity,</span>
<span class="sd">        followed by oxidation state, followed by spin.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

        <span class="n">x1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">X</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">X</span> <span class="k">else</span> <span class="n">other</span><span class="o">.</span><span class="n">X</span>
        <span class="k">if</span> <span class="n">x1</span> <span class="o">!=</span> <span class="n">x2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x1</span> <span class="o">&lt;</span> <span class="n">x2</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">symbol</span><span class="p">:</span>
            <span class="c1"># There are cases where the Pauling electronegativity are exactly equal.</span>
            <span class="c1"># We then sort by symbol.</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">symbol</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">oxi_state</span><span class="p">:</span>
            <span class="n">other_oxi</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Element</span><span class="p">)</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">oxi_state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">other</span><span class="o">.</span><span class="n">oxi_state</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">oxi_state</span> <span class="o">&lt;</span> <span class="n">other_oxi</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">spin</span> <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">spin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Species </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">oxi_state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">abs_charge</span> <span class="o">=</span> <span class="n">formula_double_format</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oxi_state</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">abs_charge</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
                <span class="n">abs_charge</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">abs_charge</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">abs_charge</span><span class="si">}{</span><span class="s1">&#39;+&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">oxi_state</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">spin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spin</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;,</span><span class="si">{</span><span class="n">spin</span><span class="si">=}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oxi_state</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_spin</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">element</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Element</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Underlying element object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_el</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">oxi_state</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Oxidation state of Species.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oxi_state</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">spin</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Spin of Species.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spin</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">electronic_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Electronic structure as string, with only valence electrons. The</span>
<span class="sd">        electrons are listed in order of increasing prinicpal quantum number</span>
<span class="sd">         (orbital number), irrespective of the actual energy level,</span>
<span class="sd">        e.g., The electronic structure for Fe is represented as &#39;[Ar].3d6.4s2&#39;</span>
<span class="sd">        even though the 3d electrons are higher in energy than the 4s.</span>

<span class="sd">        References:</span>
<span class="sd">            Kramida, A., Ralchenko, Yu., Reader, J., and NIST ASD Team (2023). NIST</span>
<span class="sd">            Atomic Spectra Database (ver. 5.11). https://physics.nist.gov/asd [2024,</span>
<span class="sd">            June 3]. National Institute of Standards and Technology, Gaithersburg,</span>
<span class="sd">            MD. DOI: https://doi.org/10.18434/T4W30F</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s2">&quot;Electronic structure&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_oxi_state</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;&lt;/*sup&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="s2">&quot;Electronic structure&quot;</span><span class="p">][</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_oxi_state</span><span class="p">)])</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No electronic structure data for oxidation state </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">oxi_state</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># NOTE - copied exactly from Element. Refactoring / inheritance may improve</span>
    <span class="c1"># robustness</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">full_electronic_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Full electronic structure as list of tuples, in order of increasing</span>
<span class="sd">        energy level (according to the Madelung rule). Therefore, the final</span>
<span class="sd">        element in the list gives the electronic structure of the valence shell.</span>

<span class="sd">        For example, the electronic structure for Fe+2 is represented as:</span>
<span class="sd">        [(1, &quot;s&quot;, 2), (2, &quot;s&quot;, 2), (2, &quot;p&quot;, 6), (3, &quot;s&quot;, 2), (3, &quot;p&quot;, 6),</span>
<span class="sd">        (3, &quot;d&quot;, 6)].</span>

<span class="sd">        References:</span>
<span class="sd">            Kramida, A., Ralchenko, Yu., Reader, J., and NIST ASD Team (2023). NIST</span>
<span class="sd">            Atomic Spectra Database (ver. 5.11). https://physics.nist.gov/asd [2024,</span>
<span class="sd">            June 3]. National Institute of Standards and Technology, Gaithersburg,</span>
<span class="sd">            MD. DOI: https://doi.org/10.18434/T4W30F</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">e_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">electronic_structure</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">parse_orbital</span><span class="p">(</span><span class="n">orb_str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">match</span> <span class="o">:=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(\d+)([spdfg]+)(\d+)&quot;</span><span class="p">,</span> <span class="n">orb_str</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">match</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">match</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">orb_str</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_orbital</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">e_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;[&quot;</span><span class="p">:</span>
            <span class="n">sym</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Element</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span><span class="o">.</span><span class="n">full_electronic_structure</span><span class="p">)</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="c1"># sort the final electronic structure by increasing energy level</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">_madelung</span><span class="o">.</span><span class="n">index</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>

    <span class="c1"># NOTE - copied exactly from Element. Refactoring / inheritance may improve</span>
    <span class="c1"># robustness</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">n_electrons</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Total number of electrons in the Species.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_electronic_structure</span><span class="p">)</span>

    <span class="c1"># NOTE - copied exactly from Element. Refactoring / inheritance may improve</span>
    <span class="c1"># robustness</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">valence</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Valence subshell angular moment (L) and number of valence e- (v_e),</span>
<span class="sd">        obtained from full electron config, where L=0, 1, 2, or 3 for s, p, d,</span>
<span class="sd">        and f orbitals, respectively.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">group</span> <span class="o">==</span> <span class="mi">18</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">0</span>  <span class="c1"># The number of valence of noble gas is 0</span>

        <span class="n">L_symbols</span> <span class="o">=</span> <span class="s2">&quot;SPDFGHIKLMNOQRTUVWXYZ&quot;</span>
        <span class="n">valence</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">full_electron_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_electronic_structure</span>
        <span class="n">last_orbital</span> <span class="o">=</span> <span class="n">full_electron_config</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">l_symbol</span><span class="p">,</span> <span class="n">ne</span> <span class="ow">in</span> <span class="n">full_electron_config</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">L_symbols</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">l_symbol</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ne</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="ow">or</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">l_symbol</span><span class="p">,</span> <span class="n">ne</span><span class="p">)</span> <span class="o">==</span> <span class="n">last_orbital</span> <span class="ow">and</span> <span class="n">ne</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">valence</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
            <span class="p">):</span>  <span class="c1"># check for full last shell (e.g. column 2)</span>
                <span class="n">valence</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">idx</span><span class="p">,</span> <span class="n">ne</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">valence</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2"> has ambiguous valence&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">valence</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ionic_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Ionic radius of specie. Returns None if data is not present.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oxi_state</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ionic_radii</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ionic_radii</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_oxi_state</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oxi_state</span><span class="p">:</span>
            <span class="n">dct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_el</span><span class="o">.</span><span class="n">data</span>
            <span class="n">oxi_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_oxi_state</span><span class="p">))</span>
            <span class="n">warn_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;No default ionic radius for </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">if</span> <span class="n">ion_rad</span> <span class="o">:=</span> <span class="n">dct</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Ionic radii hs&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">oxi_str</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">warn_msg</span><span class="si">}</span><span class="s2"> Using hs data.&quot;</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">ion_rad</span>
            <span class="k">if</span> <span class="n">ion_rad</span> <span class="o">:=</span> <span class="n">dct</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Ionic radii ls&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">oxi_str</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">warn_msg</span><span class="si">}</span><span class="s2"> Using ls data.&quot;</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">ion_rad</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No ionic radius for </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

<div class="viewcode-block" id="Species.from_str">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.Species.from_str">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_str</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">species_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a Species from a string representation.</span>

<span class="sd">        Args:</span>
<span class="sd">            species_string (str): A typical string representation of a</span>
<span class="sd">                species, e.g. &quot;Mn2+&quot;, &quot;Fe3+&quot;, &quot;O2-&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A Species object.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError if species_string cannot be interpreted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># e.g. Fe2+,spin=5</span>
        <span class="c1"># 1st group: ([A-Z][a-z]*)    --&gt; Fe</span>
        <span class="c1"># 2nd group: ([0-9.]*)        --&gt; &quot;2&quot;</span>
        <span class="c1"># 3rd group: ([+\-])          --&gt; +</span>
        <span class="c1"># 4th group: (.*)             --&gt; everything else, &quot;,spin=5&quot;</span>

        <span class="k">if</span> <span class="n">match</span> <span class="o">:=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([A-Z][a-z]*)([0-9.]*)([+\-]*)(.*)&quot;</span><span class="p">,</span> <span class="n">species_string</span><span class="p">):</span>
            <span class="n">sym</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># parse symbol</span>

            <span class="c1"># Parse oxidation state (optional)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">match</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
                <span class="n">oxi</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">oxi</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">match</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">match</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">oxi</span> <span class="o">=</span> <span class="o">-</span><span class="n">oxi</span> <span class="k">if</span> <span class="n">match</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span> <span class="k">else</span> <span class="n">oxi</span>

            <span class="c1"># Parse properties (optional)</span>
            <span class="n">properties</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span>  <span class="c1"># has Spin properties</span>
                <span class="n">tokens</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)</span>
                <span class="n">properties</span> <span class="o">=</span> <span class="p">{</span><span class="n">tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">])}</span>

            <span class="c1"># But we need either an oxidation state or a property</span>
            <span class="k">if</span> <span class="n">oxi</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">properties</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid species string&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">sym</span><span class="p">,</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">oxi</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">oxi</span><span class="p">,</span> <span class="o">**</span><span class="n">properties</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid species string&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Species.to_pretty_string">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.Species.to_pretty_string">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_pretty_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;String without properties.&quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">oxi_state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">abs_charge</span> <span class="o">=</span> <span class="n">formula_double_format</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oxi_state</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">abs_charge</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
                <span class="n">abs_charge</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">abs_charge</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">abs_charge</span><span class="si">}{</span><span class="s1">&#39;+&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">oxi_state</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">output</span></div>


<div class="viewcode-block" id="Species.get_nmr_quadrupole_moment">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.Species.get_nmr_quadrupole_moment">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_nmr_quadrupole_moment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isotope</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the nuclear electric quadrupole moment in units of e * millibarns.</span>

<span class="sd">        Args:</span>
<span class="sd">            isotope (str): the isotope to get the quadrupole moment for</span>
<span class="sd">                default is None, which gets the lowest mass isotope</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">quad_mom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_el</span><span class="o">.</span><span class="n">nmr_quadrupole_moment</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">quad_mom</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>

        <span class="k">if</span> <span class="n">isotope</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">isotopes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">quad_mom</span><span class="p">)</span>
            <span class="n">isotopes</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">quad_mom</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">isotopes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">isotope</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">quad_mom</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No quadrupole moment for </span><span class="si">{</span><span class="n">isotope</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">quad_mom</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">isotope</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span></div>


<div class="viewcode-block" id="Species.get_shannon_radius">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.Species.get_shannon_radius">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_shannon_radius</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">cn</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">spin</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Low Spin&quot;</span><span class="p">,</span> <span class="s2">&quot;High Spin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">radius_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ionic&quot;</span><span class="p">,</span> <span class="s2">&quot;crystal&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ionic&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the local environment specific ionic radius for species.</span>

<span class="sd">        Args:</span>
<span class="sd">            cn (str): Coordination using roman letters. Supported values are</span>
<span class="sd">                I-IX, as well as IIIPY, IVPY and IVSQ.</span>
<span class="sd">            spin (str): Some species have different radii for different</span>
<span class="sd">                spins. You can get specific values using &quot;High Spin&quot; or</span>
<span class="sd">                &quot;Low Spin&quot;. Leave it as &quot;&quot; if not available. If only one spin</span>
<span class="sd">                data is available, it is returned and this spin parameter is</span>
<span class="sd">                ignored.</span>
<span class="sd">            radius_type (str): Either &quot;crystal&quot; or &quot;ionic&quot; (default).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Shannon radius for specie in the specified environment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">radii</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_el</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Shannon radii&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oxi_state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;oxi_state is None.&quot;</span><span class="p">)</span>
        <span class="n">radii</span> <span class="o">=</span> <span class="n">radii</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_oxi_state</span><span class="p">))][</span><span class="n">cn</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">radii</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">key</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">radii</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="n">spin</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Specified </span><span class="si">{</span><span class="n">spin</span><span class="si">=}</span><span class="s2"> not consistent with database spin of </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">. &quot;</span>
                    <span class="s2">&quot;Only one spin data available, and that value is returned.&quot;</span><span class="p">,</span>
                    <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">radii</span><span class="p">[</span><span class="n">spin</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">radius_type</span><span class="si">}</span><span class="s2">_radius&quot;</span><span class="p">]</span></div>


<div class="viewcode-block" id="Species.get_crystal_field_spin">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.Species.get_crystal_field_spin">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_crystal_field_spin</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">coordination</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;oct&quot;</span><span class="p">,</span> <span class="s2">&quot;tet&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;oct&quot;</span><span class="p">,</span>
        <span class="n">spin_config</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;low&quot;</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the crystal field spin based on coordination and spin</span>
<span class="sd">        configuration. Only works for transition metal species.</span>

<span class="sd">        Args:</span>
<span class="sd">            coordination (&quot;oct&quot; | &quot;tet&quot;): Tetrahedron or octahedron crystal site coordination</span>
<span class="sd">            spin_config (&quot;low&quot; | &quot;high&quot;): Whether the species is in a high or low spin state</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Crystal field spin in Bohr magneton.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError if species is not a valid transition metal or has</span>
<span class="sd">                an invalid oxidation state.</span>
<span class="sd">            ValueError if invalid coordination or spin_config.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">coordination</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;oct&quot;</span><span class="p">,</span> <span class="s2">&quot;tet&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">spin_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid coordination or spin config&quot;</span><span class="p">)</span>

        <span class="n">elec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">full_electronic_structure</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">elec</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span> <span class="ow">or</span> <span class="n">elec</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;s&quot;</span> <span class="ow">or</span> <span class="n">elec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;d&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid element </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> for crystal field calculation&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">oxi_state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;oxi_state is None.&quot;</span><span class="p">)</span>
        <span class="n">n_electrons</span> <span class="o">=</span> <span class="n">elec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">elec</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">oxi_state</span>
        <span class="k">if</span> <span class="n">n_electrons</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n_electrons</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid oxidation state </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">oxi_state</span><span class="si">}</span><span class="s2"> for element </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">spin_config</span> <span class="o">==</span> <span class="s2">&quot;high&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">n_electrons</span> <span class="k">if</span> <span class="n">n_electrons</span> <span class="o">&lt;=</span> <span class="mi">5</span> <span class="k">else</span> <span class="mi">10</span> <span class="o">-</span> <span class="n">n_electrons</span>

        <span class="k">if</span> <span class="n">spin_config</span> <span class="o">==</span> <span class="s2">&quot;low&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">coordination</span> <span class="o">==</span> <span class="s2">&quot;oct&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">n_electrons</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">n_electrons</span>
                <span class="k">if</span> <span class="n">n_electrons</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">:</span>
                    <span class="k">return</span> <span class="mi">6</span> <span class="o">-</span> <span class="n">n_electrons</span>
                <span class="k">if</span> <span class="n">n_electrons</span> <span class="o">&lt;=</span> <span class="mi">8</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">n_electrons</span> <span class="o">-</span> <span class="mi">6</span>
                <span class="k">return</span> <span class="mi">10</span> <span class="o">-</span> <span class="n">n_electrons</span>

            <span class="k">if</span> <span class="n">coordination</span> <span class="o">==</span> <span class="s2">&quot;tet&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">n_electrons</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">n_electrons</span>
                <span class="k">if</span> <span class="n">n_electrons</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="k">return</span> <span class="mi">4</span> <span class="o">-</span> <span class="n">n_electrons</span>
                <span class="k">if</span> <span class="n">n_electrons</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">n_electrons</span> <span class="o">-</span> <span class="mi">4</span>
                <span class="k">return</span> <span class="mi">10</span> <span class="o">-</span> <span class="n">n_electrons</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Species.as_dict">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.Species.as_dict">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;JSON-able dictionary representation.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;@module&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__module__</span><span class="p">,</span>
            <span class="s2">&quot;@class&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
            <span class="s2">&quot;element&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">,</span>
            <span class="s2">&quot;oxidation_state&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oxi_state</span><span class="p">,</span>
            <span class="s2">&quot;spin&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spin</span><span class="p">,</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="Species.from_dict">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.Species.from_dict">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dct</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            dct (dict): Dict representation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Species.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">dct</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">],</span> <span class="n">dct</span><span class="p">[</span><span class="s2">&quot;oxidation_state&quot;</span><span class="p">],</span> <span class="n">spin</span><span class="o">=</span><span class="n">dct</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;spin&quot;</span><span class="p">))</span></div>
</div>



<div class="viewcode-block" id="DummySpecies">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.DummySpecies">[docs]</a>
<span class="nd">@functools</span><span class="o">.</span><span class="n">total_ordering</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DummySpecies</span><span class="p">(</span><span class="n">Species</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A special specie for representing non-traditional elements or species. For</span>
<span class="sd">    example, representation of vacancies (charged or otherwise), or special</span>
<span class="sd">    sites, etc.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        oxi_state (int): Oxidation state associated with Species.</span>
<span class="sd">        Z (int): DummySpecies is always assigned an atomic number equal to the hash</span>
<span class="sd">            number of the symbol. Obviously, it makes no sense whatsoever to use</span>
<span class="sd">            the atomic number of a Dummy specie for anything scientific. The purpose</span>
<span class="sd">            of this is to ensure that for most use cases, a DummySpecies behaves no</span>
<span class="sd">            differently from an Element or Species.</span>
<span class="sd">        A (int): Just as for Z, to get a DummySpecies to behave like an Element,</span>
<span class="sd">            it needs atomic mass number A (arbitrarily set to twice Z).</span>
<span class="sd">        X (float): DummySpecies is always assigned a Pauling electronegativity of 0.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;X&quot;</span><span class="p">,</span>
        <span class="n">oxidation_state</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">spin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            symbol (str): An assigned symbol for the dummy specie. Strict</span>
<span class="sd">                rules are applied to the choice of the symbol. The dummy</span>
<span class="sd">                symbol cannot have any part of first two letters that will</span>
<span class="sd">                constitute an Element symbol. Otherwise, a composition may</span>
<span class="sd">                be parsed wrongly. e.g. &quot;X&quot; is fine, but &quot;Vac&quot; is not</span>
<span class="sd">                because Vac contains V, a valid Element.</span>
<span class="sd">            oxidation_state (float): Oxidation state for dummy specie. Defaults to 0.</span>
<span class="sd">                deprecated and retained purely for backward compatibility.</span>
<span class="sd">            spin: Spin associated with Species. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># enforce title case to match other elements, reduces confusion</span>
        <span class="c1"># when multiple DummySpecies in a &quot;formula&quot; string</span>
        <span class="n">symbol</span> <span class="o">=</span> <span class="n">symbol</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">symbol</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">Element</span><span class="o">.</span><span class="n">is_valid_symbol</span><span class="p">(</span><span class="n">symbol</span><span class="p">[:</span><span class="n">idx</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> contains </span><span class="si">{</span><span class="n">symbol</span><span class="p">[:</span><span class="n">idx</span><span class="p">]</span><span class="si">}</span><span class="s2">, which is a valid element symbol&quot;</span><span class="p">)</span>

        <span class="c1"># Set required attributes for DummySpecies to function like a Species in</span>
        <span class="c1"># most instances.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_symbol</span> <span class="o">=</span> <span class="n">symbol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oxi_state</span> <span class="o">=</span> <span class="n">oxidation_state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_spin</span> <span class="o">=</span> <span class="n">spin</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set a default sort order for atomic species by Pauling electronegativity,</span>
<span class="sd">        followed by oxidation state.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">X</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">X</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">symbol</span><span class="p">:</span>
            <span class="c1"># There are cases where the Pauling electronegativity are exactly equal.</span>
            <span class="c1"># We then sort by symbol.</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">symbol</span>
        <span class="n">other_oxi</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Element</span><span class="p">)</span> <span class="k">else</span> <span class="n">other</span><span class="o">.</span><span class="n">oxi_state</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">oxi_state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other_oxi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">oxi_state</span> <span class="o">&lt;</span> <span class="n">other_oxi</span>

        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;oxi_state for both species are None&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;DummySpecies </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">oxi_state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formula_double_format</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oxi_state</span><span class="p">))</span><span class="si">}{</span><span class="s1">&#39;+&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">oxi_state</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">spin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spin</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;,</span><span class="si">{</span><span class="n">spin</span><span class="si">=}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oxi_state</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Z</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Proton number of DummySpecies.</span>

<span class="sd">        DummySpecies is always assigned an atomic number equal to the hash of</span>
<span class="sd">        the symbol. This is necessary for the DummySpecies object to behave like</span>
<span class="sd">        an ElementBase object (which Species inherits from).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">A</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Atomic mass number of a DummySpecies.</span>

<span class="sd">        To behave like an ElementBase object (from which Species inherits),</span>
<span class="sd">        DummySpecies needs an atomic mass number. Consistent with the</span>
<span class="sd">        implementation for ElementBase, this can return an int or None (default).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">oxi_state</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Oxidation state associated with DummySpecies.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oxi_state</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">X</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;DummySpecies is always assigned a Pauling electronegativity of 0. The effect of</span>
<span class="sd">        this is that DummySpecies are always sorted in front of actual Species.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">0.0</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Symbol for DummySpecies.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_symbol</span>

<div class="viewcode-block" id="DummySpecies.from_str">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.DummySpecies.from_str">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_str</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">species_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a Dummy from a string representation.</span>

<span class="sd">        Args:</span>
<span class="sd">            species_string (str): A string representation of a dummy</span>
<span class="sd">                species, e.g. &quot;X2+&quot;, &quot;X3+&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A DummySpecies object.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError if species_string cannot be interpreted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">match</span> <span class="o">:=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([A-ZAa-z]*)([0-9.]*)([+\-]*)(.*)&quot;</span><span class="p">,</span> <span class="n">species_string</span><span class="p">):</span>
            <span class="n">sym</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">match</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">oxi</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">oxi</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="k">if</span> <span class="n">match</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">match</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">oxi</span> <span class="o">=</span> <span class="o">-</span><span class="n">oxi</span> <span class="k">if</span> <span class="n">match</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span> <span class="k">else</span> <span class="n">oxi</span>
            <span class="n">properties</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span>  <span class="c1"># has Spin property</span>
                <span class="n">tokens</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)</span>
                <span class="n">properties</span> <span class="o">=</span> <span class="p">{</span><span class="n">tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="nb">float</span><span class="p">(</span><span class="n">tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">])}</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">sym</span><span class="p">,</span> <span class="n">oxi</span><span class="p">,</span> <span class="o">**</span><span class="n">properties</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid DummySpecies String&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="DummySpecies.as_dict">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.DummySpecies.as_dict">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;MSONable dict representation.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;@module&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__module__</span><span class="p">,</span>
            <span class="s2">&quot;@class&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
            <span class="s2">&quot;element&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">,</span>
            <span class="s2">&quot;oxidation_state&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oxi_state</span><span class="p">,</span>
            <span class="s2">&quot;spin&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spin</span><span class="p">,</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="DummySpecies.from_dict">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.DummySpecies.from_dict">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dct</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            dct (dict): Dict representation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DummySpecies</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">dct</span><span class="p">[</span><span class="s2">&quot;element&quot;</span><span class="p">],</span> <span class="n">dct</span><span class="p">[</span><span class="s2">&quot;oxidation_state&quot;</span><span class="p">],</span> <span class="n">spin</span><span class="o">=</span><span class="n">dct</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;spin&quot;</span><span class="p">))</span></div>
</div>



<div class="viewcode-block" id="Specie">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.Specie">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Specie</span><span class="p">(</span><span class="n">Species</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This maps the historical grammatically inaccurate Specie to Species</span>
<span class="sd">    to maintain backwards compatibility.</span>
<span class="sd">    &quot;&quot;&quot;</span></div>



<div class="viewcode-block" id="DummySpecie">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.DummySpecie">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DummySpecie</span><span class="p">(</span><span class="n">DummySpecies</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This maps the historical grammatically inaccurate DummySpecie to DummySpecies</span>
<span class="sd">    to maintain backwards compatibility.</span>
<span class="sd">    &quot;&quot;&quot;</span></div>



<span class="nd">@overload</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_el_sp</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Element</span><span class="p">:</span>
    <span class="k">pass</span>


<span class="nd">@overload</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_el_sp</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">SpeciesLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Element</span> <span class="o">|</span> <span class="n">Species</span> <span class="o">|</span> <span class="n">DummySpecies</span><span class="p">:</span>
    <span class="k">pass</span>


<div class="viewcode-block" id="get_el_sp">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.get_el_sp">[docs]</a>
<span class="nd">@functools</span><span class="o">.</span><span class="n">lru_cache</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_el_sp</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">SpeciesLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Element</span> <span class="o">|</span> <span class="n">Species</span> <span class="o">|</span> <span class="n">DummySpecies</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Utility function to get an Element, Species or DummySpecies from any input.</span>

<span class="sd">    If obj is an Element or a Species, it is returned as is.</span>
<span class="sd">    If obj is an int or a string representing an integer, the Element with the</span>
<span class="sd">    atomic number obj is returned.</span>
<span class="sd">    If obj is a string, Species parsing will be attempted (e.g. Mn2+). Failing that</span>
<span class="sd">    Element parsing will be attempted (e.g. Mn). Failing that DummyElement parsing</span>
<span class="sd">    will be attempted.</span>

<span class="sd">    Args:</span>
<span class="sd">        obj (SpeciesLike): An arbitrary object. Supported objects are actual Element/Species,</span>
<span class="sd">            integers (representing atomic numbers) or strings (element symbols or species strings).</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if obj cannot be converted into an Element or Species.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Element | Species | DummySpecies: with a bias for the maximum number</span>
<span class="sd">            of properties that can be determined.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># If obj is already an Element or Species, return as is</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Element</span> <span class="o">|</span> <span class="n">Species</span> <span class="o">|</span> <span class="n">DummySpecies</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="c1"># If obj is an integer, return the Element with atomic number obj</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">flt</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">flt</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">flt</span><span class="p">)</span>  <span class="c1"># noqa: S101</span>
        <span class="k">return</span> <span class="n">Element</span><span class="o">.</span><span class="n">from_Z</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">flt</span><span class="p">))</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">AssertionError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="c1"># If obj is a string, attempt to parse it as a Species</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Species</span><span class="o">.</span><span class="n">from_str</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="c1"># If Species parsing failed, try Element</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Element</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="c1"># If Element parsing failed, try DummySpecies</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">DummySpecies</span><span class="o">.</span><span class="n">from_str</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can&#39;t parse Element or Species from </span><span class="si">{</span><span class="n">obj</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span></div>



<div class="viewcode-block" id="ElementType">
<a class="viewcode-back" href="../../../pymatgen.core.html#pymatgen.core.periodic_table.ElementType">[docs]</a>
<span class="nd">@unique</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ElementType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Enum for element types.&quot;&quot;&quot;</span>

    <span class="n">noble_gas</span> <span class="o">=</span> <span class="s2">&quot;noble_gas&quot;</span>  <span class="c1"># He, Ne, Ar, Kr, Xe, Rn</span>
    <span class="n">transition_metal</span> <span class="o">=</span> <span class="s2">&quot;transition_metal&quot;</span>  <span class="c1"># Sc-Zn, Y-Cd, La-Hg, Ac-Cn</span>
    <span class="n">post_transition_metal</span> <span class="o">=</span> <span class="s2">&quot;post_transition_metal&quot;</span>  <span class="c1"># Al, Ga, In, Tl, Sn, Pb, Bi, Po</span>
    <span class="n">rare_earth_metal</span> <span class="o">=</span> <span class="s2">&quot;rare_earth_metal&quot;</span>  <span class="c1"># Ce-Lu, Th-Lr</span>
    <span class="n">metal</span> <span class="o">=</span> <span class="s2">&quot;metal&quot;</span>
    <span class="n">metalloid</span> <span class="o">=</span> <span class="s2">&quot;metalloid&quot;</span>  <span class="c1"># B, Si, Ge, As, Sb, Te, Po</span>
    <span class="n">alkali</span> <span class="o">=</span> <span class="s2">&quot;alkali&quot;</span>  <span class="c1"># Li, Na, K, Rb, Cs, Fr</span>
    <span class="n">alkaline</span> <span class="o">=</span> <span class="s2">&quot;alkaline&quot;</span>  <span class="c1"># Be, Mg, Ca, Sr, Ba, Ra</span>
    <span class="n">halogen</span> <span class="o">=</span> <span class="s2">&quot;halogen&quot;</span>  <span class="c1"># F, Cl, Br, I, At</span>
    <span class="n">chalcogen</span> <span class="o">=</span> <span class="s2">&quot;chalcogen&quot;</span>  <span class="c1"># O, S, Se, Te, Po</span>
    <span class="n">lanthanoid</span> <span class="o">=</span> <span class="s2">&quot;lanthanoid&quot;</span>  <span class="c1"># La-Lu</span>
    <span class="n">actinoid</span> <span class="o">=</span> <span class="s2">&quot;actinoid&quot;</span>  <span class="c1"># Ac-Lr</span>
    <span class="n">radioactive</span> <span class="o">=</span> <span class="s2">&quot;radioactive&quot;</span>  <span class="c1"># Tc, Pm, Po-Lr</span>
    <span class="n">quadrupolar</span> <span class="o">=</span> <span class="s2">&quot;quadrupolar&quot;</span>
    <span class="n">s_block</span> <span class="o">=</span> <span class="s2">&quot;s-block&quot;</span>
    <span class="n">p_block</span> <span class="o">=</span> <span class="s2">&quot;p-block&quot;</span>
    <span class="n">d_block</span> <span class="o">=</span> <span class="s2">&quot;d-block&quot;</span>
    <span class="n">f_block</span> <span class="o">=</span> <span class="s2">&quot;f-block&quot;</span></div>

</pre></div>

            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">pymatgen 2025.1.24 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pymatgen.core.periodic_table</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2011, Pymatgen Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
  </body>
</html>