<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pymatgen.phonon.plotter &#8212; pymatgen 2025.1.24 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css?v=5c69cfe2" />
    <script src="../../../_static/documentation_options.js?v=d2bc030c"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">pymatgen 2025.1.24 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pymatgen.phonon.plotter</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <h1>Source code for pymatgen.phonon.plotter</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;This module implements plotter for DOS and band structure.&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span><span class="p">,</span> <span class="n">NamedTuple</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.constants</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">const</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">colors</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">LineCollection</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearSegmentedColormap</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">monty.json</span><span class="w"> </span><span class="kn">import</span> <span class="n">jsanitize</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pymatgen.electronic_structure.plotter</span><span class="w"> </span><span class="kn">import</span> <span class="n">BSDOSPlotter</span><span class="p">,</span> <span class="n">plot_brillouin_zone</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pymatgen.phonon.bandstructure</span><span class="w"> </span><span class="kn">import</span> <span class="n">PhononBandStructureSymmLine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pymatgen.phonon.gruneisen</span><span class="w"> </span><span class="kn">import</span> <span class="n">GruneisenPhononBandStructureSymmLine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pymatgen.util.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">add_fig_kwargs</span><span class="p">,</span> <span class="n">get_ax_fig</span><span class="p">,</span> <span class="n">pretty_plot</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">collections.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Sequence</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">os</span><span class="w"> </span><span class="kn">import</span> <span class="n">PathLike</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Literal</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.axes</span><span class="w"> </span><span class="kn">import</span> <span class="n">Axes</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.figure</span><span class="w"> </span><span class="kn">import</span> <span class="n">Figure</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">pymatgen.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">Structure</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">pymatgen.phonon.dos</span><span class="w"> </span><span class="kn">import</span> <span class="n">PhononDos</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">pymatgen.phonon.gruneisen</span><span class="w"> </span><span class="kn">import</span> <span class="n">GruneisenParameter</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="FreqUnits">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.FreqUnits">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">FreqUnits</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Conversion factor from THz to the required units and the label.&quot;&quot;&quot;</span>

    <span class="n">factor</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">label</span><span class="p">:</span> <span class="nb">str</span></div>



<div class="viewcode-block" id="freq_units">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.freq_units">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">freq_units</span><span class="p">(</span><span class="n">units</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;thz&quot;</span><span class="p">,</span> <span class="s2">&quot;ev&quot;</span><span class="p">,</span> <span class="s2">&quot;mev&quot;</span><span class="p">,</span> <span class="s2">&quot;ha&quot;</span><span class="p">,</span> <span class="s2">&quot;cm-1&quot;</span><span class="p">,</span> <span class="s2">&quot;cm^-1&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">FreqUnits</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        units: str, accepted values: thz, ev, mev, ha, cm-1, cm^-1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Conversion factor from THz to the required units and the label in the form of a namedtuple.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dct</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;thz&quot;</span><span class="p">:</span> <span class="n">FreqUnits</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;THz&quot;</span><span class="p">),</span>
        <span class="s2">&quot;ev&quot;</span><span class="p">:</span> <span class="n">FreqUnits</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">&quot;hertz-electron volt relationship&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">tera</span><span class="p">,</span> <span class="s2">&quot;eV&quot;</span><span class="p">),</span>
        <span class="s2">&quot;mev&quot;</span><span class="p">:</span> <span class="n">FreqUnits</span><span class="p">(</span>
            <span class="n">const</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">&quot;hertz-electron volt relationship&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">tera</span> <span class="o">/</span> <span class="n">const</span><span class="o">.</span><span class="n">milli</span><span class="p">,</span>
            <span class="s2">&quot;meV&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="s2">&quot;ha&quot;</span><span class="p">:</span> <span class="n">FreqUnits</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">&quot;hertz-hartree relationship&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">tera</span><span class="p">,</span> <span class="s2">&quot;Ha&quot;</span><span class="p">),</span>
        <span class="s2">&quot;cm-1&quot;</span><span class="p">:</span> <span class="n">FreqUnits</span><span class="p">(</span>
            <span class="n">const</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">&quot;hertz-inverse meter relationship&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">tera</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">centi</span><span class="p">,</span>
            <span class="s2">&quot;cm^{-1}&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="s2">&quot;cm^-1&quot;</span><span class="p">:</span> <span class="n">FreqUnits</span><span class="p">(</span>
            <span class="n">const</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">&quot;hertz-inverse meter relationship&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">tera</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">centi</span><span class="p">,</span>
            <span class="s2">&quot;cm^{-1}&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dct</span><span class="p">[</span><span class="n">units</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Value for units `</span><span class="si">{</span><span class="n">units</span><span class="si">}</span><span class="s2">` unknown</span><span class="se">\n</span><span class="s2">Possible values are:</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">dct</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>



<div class="viewcode-block" id="PhononDosPlotter">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.PhononDosPlotter">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">PhononDosPlotter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot phonon DOSs. The interface is very flexible to accommodate the many</span>
<span class="sd">    different ways in which people want to view DOS.</span>
<span class="sd">    Typical usage is:</span>
<span class="sd">        # Initializes plotter with some optional args. Defaults are usually fine</span>
<span class="sd">        plotter = PhononDosPlotter().</span>

<span class="sd">        # Add DOS with a label</span>
<span class="sd">        plotter.add_dos(&quot;Total DOS&quot;, dos)</span>

<span class="sd">        # Alternatively, you can add a dict of DOSes. This is the typical form</span>
<span class="sd">        # returned by CompletePhononDos.get_element_dos().</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stack</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">sigma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            stack: Whether to plot the DOS as a stacked area graph</span>
<span class="sd">            sigma: A float specifying a standard deviation for Gaussian smearing</span>
<span class="sd">                the DOS for nicer looking plots. Defaults to None for no smearing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># a likely user mistake is to try to pass a DOS as the first argument (similar to PhononBSPlotter) but</span>
        <span class="c1"># without the isinstance check, this would not raise an error and just silently cause a blank plot</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stack</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;The first argument stack expects a boolean. If you are trying to add a DOS, use the add_dos() method.&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stack</span> <span class="o">=</span> <span class="n">stack</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_doses</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="PhononDosPlotter.add_dos">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.PhononDosPlotter.add_dos">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_dos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dos</span><span class="p">:</span> <span class="n">PhononDos</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a dos for plotting.</span>

<span class="sd">        Args:</span>
<span class="sd">            label (str): label for the DOS. Must be unique.</span>
<span class="sd">            dos (PhononDos): DOS object</span>
<span class="sd">            **kwargs: kwargs supported by matplotlib.pyplot.plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">densities</span> <span class="o">=</span> <span class="n">dos</span><span class="o">.</span><span class="n">get_smeared_densities</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="k">else</span> <span class="n">dos</span><span class="o">.</span><span class="n">densities</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_doses</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;frequencies&quot;</span><span class="p">:</span> <span class="n">dos</span><span class="o">.</span><span class="n">frequencies</span><span class="p">,</span>
            <span class="s2">&quot;densities&quot;</span><span class="p">:</span> <span class="n">densities</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="PhononDosPlotter.add_dos_dict">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.PhononDosPlotter.add_dos_dict">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_dos_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dos_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">key_sort_func</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a dictionary of doses, with an optional sorting function for the</span>
<span class="sd">        keys.</span>

<span class="sd">        Args:</span>
<span class="sd">            dos_dict: dict of {label: Dos}</span>
<span class="sd">            key_sort_func: function used to sort the dos_dict keys.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dos_dict</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key_sort_func</span><span class="p">)</span> <span class="k">if</span> <span class="n">key_sort_func</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="n">dos_dict</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_dos</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">dos_dict</span><span class="p">[</span><span class="n">label</span><span class="p">])</span></div>


<div class="viewcode-block" id="PhononDosPlotter.get_dos_dict">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.PhononDosPlotter.get_dos_dict">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_dos_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the added doses as a json-serializable dict. Note that if you</span>
<span class="sd">        have specified smearing for the DOS plot, the densities returned will</span>
<span class="sd">        be the smeared densities, not the original densities.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: DOS data. Generally of the form {label: {&#39;frequencies&#39;:.., &#39;densities&#39;: ...}}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">jsanitize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_doses</span><span class="p">)</span></div>


<div class="viewcode-block" id="PhononDosPlotter.get_plot">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.PhononDosPlotter.get_plot">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">xlim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ylim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">invert_axes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">units</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;thz&quot;</span><span class="p">,</span> <span class="s2">&quot;ev&quot;</span><span class="p">,</span> <span class="s2">&quot;mev&quot;</span><span class="p">,</span> <span class="s2">&quot;ha&quot;</span><span class="p">,</span> <span class="s2">&quot;cm-1&quot;</span><span class="p">,</span> <span class="s2">&quot;cm^-1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;thz&quot;</span><span class="p">,</span>
        <span class="n">legend</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">:</span> <span class="n">Axes</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Axes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a matplotlib plot showing the DOS.</span>

<span class="sd">        Args:</span>
<span class="sd">            xlim: Specifies the x-axis limits. Set to None for automatic determination.</span>
<span class="sd">            ylim: Specifies the y-axis limits.</span>
<span class="sd">            invert_axes (bool): Whether to invert the x and y axes. Enables chemist style DOS plotting.</span>
<span class="sd">                Defaults to False.</span>
<span class="sd">            units (thz | ev | mev | ha | cm-1 | cm^-1): units for the frequencies. Defaults to &quot;thz&quot;.</span>
<span class="sd">            legend: dict with legend options. For example, {&quot;loc&quot;: &quot;upper right&quot;}</span>
<span class="sd">                will place the legend in the upper right corner. Defaults to {&quot;fontsize&quot;: 30}.</span>
<span class="sd">            ax (Axes): An existing axes object onto which the plot will be added.</span>
<span class="sd">                If None, a new figure will be created.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="n">legend</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">legend</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;fontsize&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
        <span class="n">unit</span> <span class="o">=</span> <span class="n">freq_units</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>

        <span class="n">n_colors</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_doses</span><span class="p">))</span>
        <span class="n">n_colors</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">n_colors</span><span class="p">)</span>

        <span class="n">ys</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">all_densities</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">all_frequencies</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">pretty_plot</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span> <span class="k">if</span> <span class="n">invert_axes</span> <span class="k">else</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

        <span class="c1"># Note that this complicated processing of frequencies is to allow for</span>
        <span class="c1"># stacked plots in matplotlib.</span>
        <span class="k">for</span> <span class="n">dos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_doses</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">frequencies</span> <span class="o">=</span> <span class="n">dos</span><span class="p">[</span><span class="s2">&quot;frequencies&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">factor</span>
            <span class="n">densities</span> <span class="o">=</span> <span class="n">dos</span><span class="p">[</span><span class="s2">&quot;densities&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">frequencies</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">:</span>
                <span class="n">ys</span> <span class="o">+=</span> <span class="n">densities</span>
                <span class="n">new_dens</span> <span class="o">=</span> <span class="n">ys</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_dens</span> <span class="o">=</span> <span class="n">densities</span>
            <span class="n">all_frequencies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frequencies</span><span class="p">)</span>
            <span class="n">all_densities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_dens</span><span class="p">)</span>

        <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_doses</span><span class="p">))</span>
        <span class="n">all_densities</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="n">all_frequencies</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="n">all_pts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;blue&quot;</span><span class="p">,</span>
            <span class="s2">&quot;red&quot;</span><span class="p">,</span>
            <span class="s2">&quot;green&quot;</span><span class="p">,</span>
            <span class="s2">&quot;orange&quot;</span><span class="p">,</span>
            <span class="s2">&quot;purple&quot;</span><span class="p">,</span>
            <span class="s2">&quot;brown&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pink&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gray&quot;</span><span class="p">,</span>
            <span class="s2">&quot;olive&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">frequencies</span><span class="p">,</span> <span class="n">densities</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">all_frequencies</span><span class="p">,</span> <span class="n">all_densities</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)):</span>
            <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_doses</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="n">idx</span> <span class="o">%</span> <span class="n">n_colors</span><span class="p">])</span>
            <span class="n">linewidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_doses</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;linewidth&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">key</span><span class="p">:</span> <span class="n">val</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_doses</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;frequencies&quot;</span><span class="p">,</span> <span class="s2">&quot;densities&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">]</span>
            <span class="p">}</span>
            <span class="n">all_pts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">densities</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">invert_axes</span><span class="p">:</span>
                <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">densities</span><span class="p">,</span> <span class="n">frequencies</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">frequencies</span><span class="p">,</span> <span class="n">densities</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stack</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">xlim</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ylim</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">invert_axes</span><span class="p">:</span>
            <span class="n">_ylim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
            <span class="n">relevant_x</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">all_pts</span> <span class="k">if</span> <span class="n">_ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">_ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="ow">or</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="nb">min</span><span class="p">(</span><span class="n">relevant_x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">relevant_x</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_xlim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
            <span class="n">relevant_y</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">all_pts</span> <span class="k">if</span> <span class="n">_xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">_xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="ow">or</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="nb">min</span><span class="p">(</span><span class="n">relevant_y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">relevant_y</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">invert_axes</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mathrm{Density\ of\ states}$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">legend</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;fontsize&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span>
                <span class="sa">rf</span><span class="s2">&quot;$\mathrm</span><span class="se">{{</span><span class="s2">Frequencies\ (</span><span class="si">{</span><span class="n">unit</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">)</span><span class="se">}}</span><span class="s2">$&quot;</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="n">legend</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;fontsize&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span>
                <span class="sa">rf</span><span class="s2">&quot;$\mathrm</span><span class="se">{{</span><span class="s2">Frequencies\ (</span><span class="si">{</span><span class="n">unit</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">)</span><span class="se">}}</span><span class="s2">$&quot;</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="n">legend</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;fontsize&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mathrm{Density\ of\ states}$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">legend</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;fontsize&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>

        <span class="c1"># only show legend if there are labels</span>
        <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">keys</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">**</span><span class="n">legend</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="PhononDosPlotter.save_plot">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.PhononDosPlotter.save_plot">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">save_plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">,</span>
        <span class="n">img_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;eps&quot;</span><span class="p">,</span>
        <span class="n">xlim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ylim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">invert_axes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">units</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;thz&quot;</span><span class="p">,</span> <span class="s2">&quot;ev&quot;</span><span class="p">,</span> <span class="s2">&quot;mev&quot;</span><span class="p">,</span> <span class="s2">&quot;ha&quot;</span><span class="p">,</span> <span class="s2">&quot;cm-1&quot;</span><span class="p">,</span> <span class="s2">&quot;cm^-1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;thz&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save matplotlib plot to a file.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename: Filename to write to.</span>
<span class="sd">            img_format: Image format to use. Defaults to EPS.</span>
<span class="sd">            xlim: Specifies the x-axis limits. Set to None for automatic</span>
<span class="sd">                determination.</span>
<span class="sd">            ylim: Specifies the y-axis limits.</span>
<span class="sd">            invert_axes: Whether to invert the x and y axes. Enables chemist style DOS plotting.</span>
<span class="sd">                Defaults to False.</span>
<span class="sd">            units: units for the frequencies. Accepted values thz, ev, mev, ha, cm-1, cm^-1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_plot</span><span class="p">(</span><span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">,</span> <span class="n">invert_axes</span><span class="o">=</span><span class="n">invert_axes</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">img_format</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PhononDosPlotter.show">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.PhononDosPlotter.show">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">xlim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ylim</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">invert_axes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">units</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;thz&quot;</span><span class="p">,</span> <span class="s2">&quot;ev&quot;</span><span class="p">,</span> <span class="s2">&quot;mev&quot;</span><span class="p">,</span> <span class="s2">&quot;ha&quot;</span><span class="p">,</span> <span class="s2">&quot;cm-1&quot;</span><span class="p">,</span> <span class="s2">&quot;cm^-1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;thz&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Show the plot using matplotlib.</span>

<span class="sd">        Args:</span>
<span class="sd">            xlim: Specifies the x-axis limits. Set to None for automatic</span>
<span class="sd">                determination.</span>
<span class="sd">            ylim: Specifies the y-axis limits.</span>
<span class="sd">            invert_axes: Whether to invert the x and y axes. Enables chemist style DOS plotting.</span>
<span class="sd">                Defaults to False.</span>
<span class="sd">            units: units for the frequencies. Accepted values thz, ev, mev, ha, cm-1, cm^-1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_plot</span><span class="p">(</span><span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">,</span> <span class="n">invert_axes</span><span class="o">=</span><span class="n">invert_axes</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="PhononBSPlotter">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.PhononBSPlotter">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">PhononBSPlotter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot or get data to facilitate the plot of band structure objects.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bs</span><span class="p">:</span> <span class="n">PhononBandStructureSymmLine</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            bs: A PhononBandStructureSymmLine object.</span>
<span class="sd">            label: A label for the plot. Defaults to None for no label. Esp. useful with</span>
<span class="sd">                the plot_compare method to distinguish the band structures.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="n">PhononBandStructureSymmLine</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;PhononBSPlotter only works with PhononBandStructureSymmLine objects. &quot;</span>
                <span class="s2">&quot;A PhononBandStructure object (on a uniform grid for instance and &quot;</span>
                <span class="s2">&quot;not along symmetry lines won&#39;t work)&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bs</span> <span class="o">=</span> <span class="n">bs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_label</span> <span class="o">=</span> <span class="n">label</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">n_bands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of bands.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">nb_bands</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_make_ticks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">Axes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Axes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Utility private method to add ticks to a band structure.&quot;&quot;&quot;</span>
        <span class="n">ticks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>

        <span class="c1"># zip to sanitize, only plot the uniq values</span>
        <span class="k">if</span> <span class="n">ticks_labels</span> <span class="o">:=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="n">ticks</span><span class="p">[</span><span class="s2">&quot;distance&quot;</span><span class="p">],</span> <span class="n">ticks</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">],</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ticks_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ticks_labels</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># plot vertical lines at each of the ticks</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ticks</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">ticks</span><span class="p">[</span><span class="s2">&quot;distance&quot;</span><span class="p">][</span><span class="n">idx</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax</span>

<div class="viewcode-block" id="PhononBSPlotter.bs_plot_data">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.PhononBSPlotter.bs_plot_data">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">bs_plot_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the data nicely formatted for a plot.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dict of the following format:</span>
<span class="sd">            ticks: A dict with the &#39;distances&#39; at which there is a qpoint (the</span>
<span class="sd">            x axis) and the labels (None if no label)</span>
<span class="sd">            frequencies: A list (one element for each branch) of frequencies for</span>
<span class="sd">            each qpoint: [branch][qpoint][mode]. The data is</span>
<span class="sd">            stored by branch to facilitate the plotting</span>
<span class="sd">            lattice: The reciprocal lattice.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">distance</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">frequency</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">ticks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">branch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">branches</span><span class="p">:</span>
            <span class="n">frequency</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="n">distance</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">distance</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">branch</span><span class="p">[</span><span class="s2">&quot;start_index&quot;</span><span class="p">],</span> <span class="n">branch</span><span class="p">[</span><span class="s2">&quot;end_index&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>

            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bands</span><span class="p">):</span>
                <span class="n">frequency</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">bands</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">branch</span><span class="p">[</span><span class="s2">&quot;start_index&quot;</span><span class="p">],</span> <span class="n">branch</span><span class="p">[</span><span class="s2">&quot;end_index&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;ticks&quot;</span><span class="p">:</span> <span class="n">ticks</span><span class="p">,</span>
            <span class="s2">&quot;distances&quot;</span><span class="p">:</span> <span class="n">distance</span><span class="p">,</span>
            <span class="s2">&quot;frequency&quot;</span><span class="p">:</span> <span class="n">frequency</span><span class="p">,</span>
            <span class="s2">&quot;lattice&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">lattice_rec</span><span class="o">.</span><span class="n">as_dict</span><span class="p">(),</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="PhononBSPlotter.get_plot">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.PhononBSPlotter.get_plot">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ylim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">units</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;thz&quot;</span><span class="p">,</span> <span class="s2">&quot;ev&quot;</span><span class="p">,</span> <span class="s2">&quot;mev&quot;</span><span class="p">,</span> <span class="s2">&quot;ha&quot;</span><span class="p">,</span> <span class="s2">&quot;cm-1&quot;</span><span class="p">,</span> <span class="s2">&quot;cm^-1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;thz&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Axes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a matplotlib object for the bandstructure plot.</span>

<span class="sd">        Args:</span>
<span class="sd">            ylim: Specify the y-axis (frequency) limits; by default None let</span>
<span class="sd">                the code choose.</span>
<span class="sd">            units: units for the frequencies. Accepted values thz, ev, mev, ha, cm-1, cm^-1.</span>
<span class="sd">                Defaults to &quot;thz&quot;.</span>
<span class="sd">            **kwargs: passed to ax.plot function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">freq_units</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">pretty_plot</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bs_plot_data</span><span class="p">()</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">dists</span><span class="p">,</span> <span class="n">freqs</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;frequency&quot;</span><span class="p">],</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bands</span><span class="p">):</span>
                <span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">freqs</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">factor</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dists</span><span class="p">))]</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dists</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_make_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

        <span class="c1"># plot y=0 line</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

        <span class="c1"># Main X and Y Labels</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mathrm{Wave\ Vector}$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
        <span class="n">ylabel</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;$\mathrm</span><span class="se">{{</span><span class="s2">Frequencies\ (</span><span class="si">{</span><span class="n">u</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">)</span><span class="se">}}</span><span class="s2">$&quot;</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

        <span class="c1"># X range (K)</span>
        <span class="c1"># last distance point</span>
        <span class="n">x_max</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_max</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ax</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_get_weight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vec</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the weight for each combination of sites according to the</span>
<span class="sd">        eigenvector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">num_atom</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bands</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">new_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_atom</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_atom</span><span class="p">):</span>
            <span class="n">new_vec</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vec</span><span class="p">[</span><span class="n">idx</span> <span class="o">*</span> <span class="mi">3</span> <span class="p">:</span> <span class="n">idx</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>
        <span class="c1"># get the projectors for each group</span>
        <span class="n">gw</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">norm_f</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">comb</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
            <span class="n">projector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_vec</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">projector</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">comb</span><span class="p">:</span>
                    <span class="n">projector</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">group_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">projector</span><span class="p">,</span> <span class="n">new_vec</span><span class="p">)</span>
            <span class="n">gw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group_weight</span><span class="p">)</span>
            <span class="n">norm_f</span> <span class="o">+=</span> <span class="n">group_weight</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">gw</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm_f</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_make_color</span><span class="p">(</span><span class="n">colors</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the eigen-displacements to rgb colors.&quot;&quot;&quot;</span>
        <span class="c1"># if there are two groups, use red and blue</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">colors</span>
        <span class="c1"># if there are four groups, use cyan, magenta, yellow and black</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">red</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">colors</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="n">green</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">colors</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="n">blue</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">colors</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">colors</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">red</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">blue</span><span class="p">]</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected 2, 3 or 4 colors, got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="PhononBSPlotter.get_proj_plot">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.PhononBSPlotter.get_proj_plot">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_proj_plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">site_comb</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="s2">&quot;element&quot;</span><span class="p">,</span>
        <span class="n">ylim</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="kc">None</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">units</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;thz&quot;</span><span class="p">,</span> <span class="s2">&quot;ev&quot;</span><span class="p">,</span> <span class="s2">&quot;mev&quot;</span><span class="p">,</span> <span class="s2">&quot;ha&quot;</span><span class="p">,</span> <span class="s2">&quot;cm-1&quot;</span><span class="p">,</span> <span class="s2">&quot;cm^-1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;thz&quot;</span><span class="p">,</span>
        <span class="n">rgb_labels</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="kc">None</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Axes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a matplotlib object for the bandstructure plot projected along atomic</span>
<span class="sd">        sites.</span>

<span class="sd">        Args:</span>
<span class="sd">            site_comb: a list of list, for example, [[0],[1],[2,3,4]];</span>
<span class="sd">                the numbers in each sublist represents the indices of atoms;</span>
<span class="sd">                the atoms in a same sublist will be plotted in a same color;</span>
<span class="sd">                if not specified, unique elements are automatically grouped.</span>
<span class="sd">            ylim: Specify the y-axis (frequency) limits; by default None let</span>
<span class="sd">                the code choose.</span>
<span class="sd">            units: units for the frequencies. Accepted values thz, ev, mev, ha, cm-1, cm^-1.</span>
<span class="sd">                Defaults to &quot;thz&quot;.</span>
<span class="sd">            rgb_labels: a list of rgb colors for the labels; if not specified,</span>
<span class="sd">                the colors will be automatically generated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">structure</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Structure is required for get_proj_plot&quot;</span><span class="p">)</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span><span class="o">.</span><span class="n">symbol</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">site_comb</span> <span class="o">==</span> <span class="s2">&quot;element&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">}:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;the compound must have 2, 3 or 4 unique elements&quot;</span><span class="p">)</span>
            <span class="n">indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">))]</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">species</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">unique_species</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">elements</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">elem</span> <span class="o">==</span> <span class="n">unique_species</span><span class="p">:</span>
                        <span class="n">indices</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">site_comb</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Site_comb should be a list.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">site_comb</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">}:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;the length of site_comb must be 2, 3 or 4&quot;</span><span class="p">)</span>
            <span class="n">all_sites</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">sites</span>
            <span class="n">all_indices</span> <span class="o">=</span> <span class="p">{</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_sites</span><span class="p">))}</span>
            <span class="k">for</span> <span class="n">comb</span> <span class="ow">in</span> <span class="n">site_comb</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">comb</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_sites</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;one or more indices in site_comb does not exist&quot;</span><span class="p">)</span>
                    <span class="n">all_indices</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_indices</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;not all </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">all_sites</span><span class="p">)</span><span class="si">}</span><span class="s2"> indices are included in site_comb&quot;</span><span class="p">)</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="n">site_comb</span>  <span class="c1"># type: ignore[assignment]</span>
        <span class="k">if</span> <span class="n">rgb_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">rgb_labels</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;wrong number of rgb_labels&quot;</span><span class="p">)</span>

        <span class="n">u</span> <span class="o">=</span> <span class="n">freq_units</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
        <span class="n">_fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bs_plot_data</span><span class="p">()</span>
        <span class="n">k_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">k_dist</span><span class="p">)):</span>
            <span class="c1"># consider 2 k points each time so they connect</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bands</span><span class="p">):</span>
                <span class="n">eigenvec_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">eigendisplacements</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">d</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
                <span class="n">eigenvec_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">eigendisplacements</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
                <span class="n">colors1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_weight</span><span class="p">(</span><span class="n">eigenvec_1</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
                <span class="n">colors2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_weight</span><span class="p">(</span><span class="n">eigenvec_2</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
                <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_make_color</span><span class="p">((</span><span class="n">colors1</span> <span class="o">+</span> <span class="n">colors2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
            <span class="n">seg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bands</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
            <span class="n">seg</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">bands</span><span class="p">[:,</span> <span class="n">d</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">d</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">factor</span>
            <span class="n">seg</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">k_dist</span><span class="p">[</span><span class="n">d</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">seg</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">k_dist</span><span class="p">[</span><span class="n">d</span><span class="p">]</span>
            <span class="n">ls</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">band</span><span class="p">)</span> <span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">bands</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">factor</span>
            <span class="n">y_min</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">band</span><span class="p">)</span> <span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">bands</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">factor</span>
            <span class="n">y_margin</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_max</span> <span class="o">-</span> <span class="n">y_min</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.05</span>
            <span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_min</span> <span class="o">-</span> <span class="n">y_margin</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">+</span> <span class="n">y_margin</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">k_dist</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">k_dist</span><span class="p">)]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mathrm{Wave\ Vector}$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>
        <span class="n">ylabel</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;$\mathrm</span><span class="se">{{</span><span class="s2">Frequencies\ (</span><span class="si">{</span><span class="n">u</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">)</span><span class="se">}}</span><span class="s2">$&quot;</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>
        <span class="c1"># make color legend</span>
        <span class="n">labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">rgb_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="n">rgb_labels</span>  <span class="c1"># type: ignore[assignment]</span>
        <span class="k">elif</span> <span class="n">site_comb</span> <span class="o">==</span> <span class="s2">&quot;element&quot;</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span><span class="o">.</span><span class="n">symbol</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">site_comb</span><span class="p">))]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">BSDOSPlotter</span><span class="o">.</span><span class="n">_rb_line</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;best&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">BSDOSPlotter</span><span class="o">.</span><span class="n">_rgb_triangle</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">labels</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;best&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># for 4 combinations, build a color square?</span>
            <span class="k">pass</span>
        <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="PhononBSPlotter.show">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.PhononBSPlotter.show">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ylim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">units</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;thz&quot;</span><span class="p">,</span> <span class="s2">&quot;ev&quot;</span><span class="p">,</span> <span class="s2">&quot;mev&quot;</span><span class="p">,</span> <span class="s2">&quot;ha&quot;</span><span class="p">,</span> <span class="s2">&quot;cm-1&quot;</span><span class="p">,</span> <span class="s2">&quot;cm^-1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;thz&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Show the plot using matplotlib.</span>

<span class="sd">        Args:</span>
<span class="sd">            ylim (float): Specifies the y-axis limits.</span>
<span class="sd">            units (&quot;thz&quot; | &quot;ev&quot; | &quot;mev&quot; | &quot;ha&quot; | &quot;cm-1&quot; | &quot;cm^-1&quot;): units for the frequencies.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_plot</span><span class="p">(</span><span class="n">ylim</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="PhononBSPlotter.save_plot">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.PhononBSPlotter.save_plot">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">save_plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">,</span>
        <span class="n">ylim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">units</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;thz&quot;</span><span class="p">,</span> <span class="s2">&quot;ev&quot;</span><span class="p">,</span> <span class="s2">&quot;mev&quot;</span><span class="p">,</span> <span class="s2">&quot;ha&quot;</span><span class="p">,</span> <span class="s2">&quot;cm-1&quot;</span><span class="p">,</span> <span class="s2">&quot;cm^-1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;thz&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save matplotlib plot to a file.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str | Path): Filename to write to.</span>
<span class="sd">            ylim (float): Specifies the y-axis limits.</span>
<span class="sd">            units (&quot;thz&quot; | &quot;ev&quot; | &quot;mev&quot; | &quot;ha&quot; | &quot;cm-1&quot; | &quot;cm^-1&quot;): units for the frequencies.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_plot</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PhononBSPlotter.show_proj">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.PhononBSPlotter.show_proj">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">show_proj</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">site_comb</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="s2">&quot;element&quot;</span><span class="p">,</span>
        <span class="n">ylim</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="kc">None</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">units</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;thz&quot;</span><span class="p">,</span> <span class="s2">&quot;ev&quot;</span><span class="p">,</span> <span class="s2">&quot;mev&quot;</span><span class="p">,</span> <span class="s2">&quot;ha&quot;</span><span class="p">,</span> <span class="s2">&quot;cm-1&quot;</span><span class="p">,</span> <span class="s2">&quot;cm^-1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;thz&quot;</span><span class="p">,</span>
        <span class="n">rgb_labels</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Show the projected plot using matplotlib.</span>

<span class="sd">        Args:</span>
<span class="sd">            site_comb: A list of list of indices of sites to combine. For example,</span>
<span class="sd">                [[0, 1], [2, 3]] will combine the projections of sites 0 and 1,</span>
<span class="sd">                and sites 2 and 3. Defaults to &quot;element&quot;, which will combine</span>
<span class="sd">                sites by element.</span>
<span class="sd">            ylim: Specify the y-axis (frequency) limits; by default None let</span>
<span class="sd">                the code choose.</span>
<span class="sd">            units: units for the frequencies. Accepted values thz, ev, mev, ha, cm-1, cm^-1.</span>
<span class="sd">                Defaults to &quot;thz&quot;.</span>
<span class="sd">            rgb_labels: A list of labels for the rgb triangle. Defaults to None,</span>
<span class="sd">                which will use the element symbols.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_proj_plot</span><span class="p">(</span><span class="n">site_comb</span><span class="o">=</span><span class="n">site_comb</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span> <span class="n">rgb_labels</span><span class="o">=</span><span class="n">rgb_labels</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="PhononBSPlotter.get_ticks">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.PhononBSPlotter.get_ticks">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_ticks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all ticks and labels for a band structure plot.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dict with &#39;distance&#39;: a list of distance at which ticks should</span>
<span class="sd">            be set and &#39;label&#39;: a list of label for each of those ticks.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tick_distance</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tick_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">prev_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">qpoints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label</span>
        <span class="n">prev_branch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">branches</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">qpoints</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">point</span><span class="o">.</span><span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">tick_distance</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">distance</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
                <span class="n">this_branch</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">for</span> <span class="n">branch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">branches</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">branch</span><span class="p">[</span><span class="s2">&quot;start_index&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">idx</span> <span class="o">&lt;=</span> <span class="n">branch</span><span class="p">[</span><span class="s2">&quot;end_index&quot;</span><span class="p">]:</span>
                        <span class="n">this_branch</span> <span class="o">=</span> <span class="n">branch</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="n">point</span><span class="o">.</span><span class="n">label</span> <span class="o">!=</span> <span class="n">prev_label</span> <span class="ow">and</span> <span class="n">prev_branch</span> <span class="o">!=</span> <span class="n">this_branch</span><span class="p">:</span>
                    <span class="n">label1</span> <span class="o">=</span> <span class="n">point</span><span class="o">.</span><span class="n">label</span>
                    <span class="k">if</span> <span class="n">label1</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">label1</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">label1</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;$</span><span class="si">{</span><span class="n">label1</span><span class="si">}</span><span class="s2">$&quot;</span>
                    <span class="n">label0</span> <span class="o">=</span> <span class="n">prev_label</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">if</span> <span class="n">label0</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">label0</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">label0</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;$</span><span class="si">{</span><span class="n">label0</span><span class="si">}</span><span class="s2">$&quot;</span>
                    <span class="n">tick_labels</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                    <span class="n">tick_distance</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                    <span class="n">tick_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label0</span><span class="si">}</span><span class="s2">|</span><span class="si">{</span><span class="n">label1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">point</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">point</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">tick_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;$</span><span class="si">{</span><span class="n">point</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">tick_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">point</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
                <span class="n">prev_label</span> <span class="o">=</span> <span class="n">point</span><span class="o">.</span><span class="n">label</span>
                <span class="n">prev_branch</span> <span class="o">=</span> <span class="n">this_branch</span>
        <span class="c1"># map atomate2 all-upper-case labels like GAMMA/DELTA to pretty symbols</span>
        <span class="n">tick_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;GAMMA&quot;</span><span class="p">,</span> <span class="s2">&quot;Γ&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;DELTA&quot;</span><span class="p">,</span> <span class="s2">&quot;Δ&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;SIGMA&quot;</span><span class="p">,</span> <span class="s2">&quot;Σ&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">tick_labels</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;distance&quot;</span><span class="p">:</span> <span class="n">tick_distance</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">tick_labels</span><span class="p">}</span></div>


<div class="viewcode-block" id="PhononBSPlotter.plot_compare">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.PhononBSPlotter.plot_compare">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_compare</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">other_plotter</span><span class="p">:</span> <span class="n">PhononBSPlotter</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PhononBSPlotter</span><span class="p">],</span>
        <span class="n">units</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;thz&quot;</span><span class="p">,</span> <span class="s2">&quot;ev&quot;</span><span class="p">,</span> <span class="s2">&quot;mev&quot;</span><span class="p">,</span> <span class="s2">&quot;ha&quot;</span><span class="p">,</span> <span class="s2">&quot;cm-1&quot;</span><span class="p">,</span> <span class="s2">&quot;cm^-1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;thz&quot;</span><span class="p">,</span>
        <span class="n">self_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;self&quot;</span><span class="p">,</span>
        <span class="n">colors</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">legend_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">on_incompatible</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;raise&quot;</span><span class="p">,</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span> <span class="s2">&quot;ignore&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;raise&quot;</span><span class="p">,</span>
        <span class="n">other_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Axes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot two band structure for comparison. self in blue, others in red, green, ...</span>
<span class="sd">        The band structures need to be defined on the same symmetry lines!</span>
<span class="sd">        The distance between symmetry lines is determined by the band structure used to</span>
<span class="sd">        initialize PhononBSPlotter (self).</span>

<span class="sd">        Args:</span>
<span class="sd">            other_plotter (PhononBSPlotter | dict[str, PhononBSPlotter]): Other PhononBSPlotter object(s) defined along</span>
<span class="sd">                the same symmetry lines</span>
<span class="sd">            units (str): units for the frequencies. Accepted values thz, ev, mev, ha, cm-1, cm^-1.</span>
<span class="sd">                Defaults to &#39;thz&#39;.</span>
<span class="sd">            self_label (str): label for the self band structure. Defaults to to the label passed to PhononBSPlotter.init</span>
<span class="sd">                or, if None, &#39;self&#39;.</span>
<span class="sd">            colors (list[str]): list of colors for the other band structures. Defaults to None for automatic colors.</span>
<span class="sd">            legend_kwargs: dict[str, Any]: kwargs passed to ax.legend().</span>
<span class="sd">            on_incompatible (&#39;raise&#39; | &#39;warn&#39; | &#39;ignore&#39;): What to do if the band structures</span>
<span class="sd">                are not compatible. Defaults to &#39;raise&#39;.</span>
<span class="sd">            other_kwargs: dict[str, Any]: kwargs passed to other_plotter ax.plot().</span>
<span class="sd">            **kwargs: passed to ax.plot().</span>

<span class="sd">        Returns:</span>
<span class="sd">            plt.Axes: with two band structures.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">unit</span> <span class="o">=</span> <span class="n">freq_units</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
        <span class="n">legend_kwargs</span> <span class="o">=</span> <span class="n">legend_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">other_kwargs</span> <span class="o">=</span> <span class="n">other_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">legend_kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;fontsize&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="n">_colors</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;blue&quot;</span><span class="p">,</span>
            <span class="s2">&quot;red&quot;</span><span class="p">,</span>
            <span class="s2">&quot;green&quot;</span><span class="p">,</span>
            <span class="s2">&quot;orange&quot;</span><span class="p">,</span>
            <span class="s2">&quot;purple&quot;</span><span class="p">,</span>
            <span class="s2">&quot;brown&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pink&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gray&quot;</span><span class="p">,</span>
            <span class="s2">&quot;olive&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other_plotter</span><span class="p">,</span> <span class="n">PhononBSPlotter</span><span class="p">):</span>
            <span class="n">other_plotter</span> <span class="o">=</span> <span class="p">{</span><span class="n">other_plotter</span><span class="o">.</span><span class="n">_label</span> <span class="ow">or</span> <span class="s2">&quot;other&quot;</span><span class="p">:</span> <span class="n">other_plotter</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">colors</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_plotter</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Wrong number of colors&quot;</span><span class="p">)</span>

        <span class="n">self_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bs_plot_data</span><span class="p">()</span>

        <span class="n">line_width</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;linewidth&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">colors</span> <span class="k">else</span> <span class="n">_colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">colors_other</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">plotter</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">other_plotter</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
            <span class="n">other_data</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">bs_plot_data</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">self_data</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">other_data</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">on_incompatible</span> <span class="o">==</span> <span class="s2">&quot;raise&quot;</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The two band structures are not compatible.&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">on_incompatible</span> <span class="o">==</span> <span class="s2">&quot;warn&quot;</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;The two band structures are not compatible.&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># ignore/warn</span>

            <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">colors</span> <span class="k">else</span> <span class="n">_colors</span><span class="p">[</span><span class="mi">1</span> <span class="o">+</span> <span class="n">idx</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">_colors</span><span class="p">)]</span>
            <span class="n">_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># Don&#39;t set the color in kwargs, or every band will be red</span>
            <span class="n">colors_other</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">_kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
            <span class="p">)</span>  <span class="c1"># don&#39;t move this line up! it would mess up self.get_plot color</span>

            <span class="k">for</span> <span class="n">band_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">plotter</span><span class="o">.</span><span class="n">n_bands</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">dist_idx</span><span class="p">,</span> <span class="n">dists</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">self_data</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">]):</span>
                    <span class="n">xs</span> <span class="o">=</span> <span class="n">dists</span>
                    <span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">other_data</span><span class="p">[</span><span class="s2">&quot;frequency&quot;</span><span class="p">][</span><span class="n">dist_idx</span><span class="p">][</span><span class="n">band_idx</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">factor</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dists</span><span class="p">))]</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="o">**</span><span class="p">(</span><span class="n">_kwargs</span> <span class="o">|</span> <span class="n">other_kwargs</span><span class="p">))</span>

        <span class="c1"># add legend showing which color corresponds to which band structure</span>
        <span class="n">color_self</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="p">[],</span>
            <span class="p">[],</span>
            <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_label</span> <span class="ow">or</span> <span class="n">self_label</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">line_width</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color_self</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">linestyle</span> <span class="o">=</span> <span class="n">other_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;linestyle&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">color_other</span><span class="p">,</span> <span class="n">label_other</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">colors_other</span><span class="p">,</span> <span class="n">other_plotter</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="p">[],</span>
                <span class="p">[],</span>
                <span class="n">label</span><span class="o">=</span><span class="n">label_other</span><span class="p">,</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">line_width</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color_other</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">**</span><span class="n">legend_kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="PhononBSPlotter.plot_brillouin">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.PhononBSPlotter.plot_brillouin">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_brillouin</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the Brillouin zone.&quot;&quot;&quot;</span>
        <span class="n">q_pts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">qpoints</span>
        <span class="c1"># get labels and lines</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">q_pt</span><span class="o">.</span><span class="n">label</span><span class="p">:</span> <span class="n">q_pt</span><span class="o">.</span><span class="n">frac_coords</span> <span class="k">for</span> <span class="n">q_pt</span> <span class="ow">in</span> <span class="n">q_pts</span> <span class="k">if</span> <span class="n">q_pt</span><span class="o">.</span><span class="n">label</span><span class="p">}</span>

        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span>
                <span class="n">q_pts</span><span class="p">[</span><span class="n">branch</span><span class="p">[</span><span class="s2">&quot;start_index&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">frac_coords</span><span class="p">,</span>
                <span class="n">q_pts</span><span class="p">[</span><span class="n">branch</span><span class="p">[</span><span class="s2">&quot;end_index&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">frac_coords</span><span class="p">,</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">branch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">branches</span>
        <span class="p">]</span>

        <span class="n">plot_brillouin_zone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">lattice_rec</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="n">lines</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="ThermoPlotter">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.ThermoPlotter">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">ThermoPlotter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plotter for thermodynamic properties obtained from phonon DOS.</span>
<span class="sd">    If the structure corresponding to the DOS, it will be used to extract the formula unit and provide</span>
<span class="sd">    the plots in units of mol instead of mole-cell.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dos</span><span class="p">:</span> <span class="n">PhononDos</span><span class="p">,</span> <span class="n">structure</span><span class="p">:</span> <span class="n">Structure</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            dos: A PhononDos object.</span>
<span class="sd">            structure: A Structure object corresponding to the structure used for the calculation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dos</span> <span class="o">=</span> <span class="n">dos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="n">structure</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_plot_thermo</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Structure</span> <span class="o">|</span> <span class="kc">None</span><span class="p">],</span> <span class="nb">float</span><span class="p">],</span>
        <span class="n">temperatures</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
        <span class="n">factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">:</span> <span class="n">Axes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ylabel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ylim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots a thermodynamic property for a generic function from a PhononDos instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            func (Callable[[float, Structure | None], float]): Takes a temperature and structure (in that order)</span>
<span class="sd">                and returns a thermodynamic property (e.g., heat capacity, entropy, etc.).</span>
<span class="sd">            temperatures (list[float]): temperatures (in K) at which to evaluate func.</span>
<span class="sd">            factor: a multiplicative factor applied to the thermodynamic property calculated. Used to change</span>
<span class="sd">                the units. Defaults to 1.</span>
<span class="sd">            ax: matplotlib Axes or None if a new figure should be created.</span>
<span class="sd">            ylabel: label for the y axis</span>
<span class="sd">            label: label of the plot</span>
<span class="sd">            ylim: tuple specifying the y-axis limits.</span>
<span class="sd">            kwargs: kwargs passed to the matplotlib function &#39;plot&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            plt.figure: matplotlib figure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ax</span><span class="p">,</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">get_ax_fig</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

        <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">temperatures</span><span class="p">:</span>
            <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span> <span class="o">*</span> <span class="n">factor</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">temperatures</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ylim</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">temperatures</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">temperatures</span><span class="p">)))</span>
        <span class="n">_ylim</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">_ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">_ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;k-&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$T$ (K)&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ylabel</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>

<div class="viewcode-block" id="ThermoPlotter.plot_cv">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.ThermoPlotter.plot_cv">[docs]</a>
    <span class="nd">@add_fig_kwargs</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_cv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tmin</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">tmax</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ntemp</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ylim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots the constant volume specific heat C_v in a temperature range.</span>

<span class="sd">        Args:</span>
<span class="sd">            tmin: minimum temperature</span>
<span class="sd">            tmax: maximum temperature</span>
<span class="sd">            ntemp: number of steps</span>
<span class="sd">            ylim: tuple specifying the y-axis limits.</span>
<span class="sd">            kwargs: kwargs passed to the matplotlib function &#39;plot&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            plt.figure: matplotlib figure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">temperatures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="n">ntemp</span><span class="p">)</span>

        <span class="n">ylabel</span> <span class="o">=</span> <span class="s2">&quot;$C_v$ (J/K/mol)&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="k">else</span> <span class="s2">&quot;$C_v$ (J/K/mol-c)&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_thermo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dos</span><span class="o">.</span><span class="n">cv</span><span class="p">,</span> <span class="n">temperatures</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="ThermoPlotter.plot_entropy">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.ThermoPlotter.plot_entropy">[docs]</a>
    <span class="nd">@add_fig_kwargs</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tmin</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">tmax</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ntemp</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ylim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots the vibrational entrpy in a temperature range.</span>

<span class="sd">        Args:</span>
<span class="sd">            tmin: minimum temperature</span>
<span class="sd">            tmax: maximum temperature</span>
<span class="sd">            ntemp: number of steps</span>
<span class="sd">            ylim: tuple specifying the y-axis limits.</span>
<span class="sd">            kwargs: kwargs passed to the matplotlib function &#39;plot&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            plt.figure: matplotlib figure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">temperatures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="n">ntemp</span><span class="p">)</span>

        <span class="n">ylabel</span> <span class="o">=</span> <span class="s2">&quot;$S$ (J/K/mol)&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="k">else</span> <span class="s2">&quot;$S$ (J/K/mol-c)&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_thermo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dos</span><span class="o">.</span><span class="n">entropy</span><span class="p">,</span> <span class="n">temperatures</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="ThermoPlotter.plot_internal_energy">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.ThermoPlotter.plot_internal_energy">[docs]</a>
    <span class="nd">@add_fig_kwargs</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_internal_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tmin</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">tmax</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ntemp</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ylim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots the vibrational internal energy in a temperature range.</span>

<span class="sd">        Args:</span>
<span class="sd">            tmin: minimum temperature</span>
<span class="sd">            tmax: maximum temperature</span>
<span class="sd">            ntemp: number of steps</span>
<span class="sd">            ylim: tuple specifying the y-axis limits.</span>
<span class="sd">            kwargs: kwargs passed to the matplotlib function &#39;plot&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            plt.figure: matplotlib figure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">temperatures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="n">ntemp</span><span class="p">)</span>

        <span class="n">ylabel</span> <span class="o">=</span> <span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">Delta E$ (kJ/mol)&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="k">else</span> <span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">Delta E$ (kJ/mol-c)&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_thermo</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dos</span><span class="o">.</span><span class="n">internal_energy</span><span class="p">,</span>
            <span class="n">temperatures</span><span class="p">,</span>
            <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span>
            <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span>
            <span class="n">factor</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="ThermoPlotter.plot_helmholtz_free_energy">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.ThermoPlotter.plot_helmholtz_free_energy">[docs]</a>
    <span class="nd">@add_fig_kwargs</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_helmholtz_free_energy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">tmin</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">tmax</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ntemp</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ylim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots the vibrational contribution to the Helmoltz free energy in a temperature range.</span>

<span class="sd">        Args:</span>
<span class="sd">            tmin: minimum temperature</span>
<span class="sd">            tmax: maximum temperature</span>
<span class="sd">            ntemp: number of steps</span>
<span class="sd">            ylim: tuple specifying the y-axis limits.</span>
<span class="sd">            kwargs: kwargs passed to the matplotlib function &#39;plot&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            plt.figure: matplotlib figure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">temperatures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="n">ntemp</span><span class="p">)</span>

        <span class="n">ylabel</span> <span class="o">=</span> <span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">Delta F$ (kJ/mol)&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="k">else</span> <span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">Delta F$ (kJ/mol-c)&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_thermo</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dos</span><span class="o">.</span><span class="n">helmholtz_free_energy</span><span class="p">,</span>
            <span class="n">temperatures</span><span class="p">,</span>
            <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span>
            <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span>
            <span class="n">factor</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="ThermoPlotter.plot_thermodynamic_properties">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.ThermoPlotter.plot_thermodynamic_properties">[docs]</a>
    <span class="nd">@add_fig_kwargs</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_thermodynamic_properties</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">tmin</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">tmax</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ntemp</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ylim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots all the thermodynamic properties in a temperature range.</span>

<span class="sd">        Args:</span>
<span class="sd">            tmin: minimum temperature</span>
<span class="sd">            tmax: maximum temperature</span>
<span class="sd">            ntemp: number of steps</span>
<span class="sd">            ylim: tuple specifying the y-axis limits.</span>
<span class="sd">            kwargs: kwargs passed to the matplotlib function &#39;plot&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            plt.figure: matplotlib figure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">temperatures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="n">ntemp</span><span class="p">)</span>

        <span class="n">mol</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="k">else</span> <span class="s2">&quot;-c&quot;</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_thermo</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dos</span><span class="o">.</span><span class="n">cv</span><span class="p">,</span>
            <span class="n">temperatures</span><span class="p">,</span>
            <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Thermodynamic properties&quot;</span><span class="p">,</span>
            <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s2">&quot;$C_v$ (J/K/mol</span><span class="si">{</span><span class="n">mol</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_thermo</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dos</span><span class="o">.</span><span class="n">entropy</span><span class="p">,</span>
            <span class="n">temperatures</span><span class="p">,</span>
            <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s2">&quot;$S$ (J/K/mol</span><span class="si">{</span><span class="n">mol</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_thermo</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dos</span><span class="o">.</span><span class="n">internal_energy</span><span class="p">,</span>
            <span class="n">temperatures</span><span class="p">,</span>
            <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">factor</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s2">&quot;$\Delta E$ (kJ/mol</span><span class="si">{</span><span class="n">mol</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_thermo</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dos</span><span class="o">.</span><span class="n">helmholtz_free_energy</span><span class="p">,</span>
            <span class="n">temperatures</span><span class="p">,</span>
            <span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">factor</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s2">&quot;$\Delta F$ (kJ/mol</span><span class="si">{</span><span class="n">mol</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div>
</div>



<div class="viewcode-block" id="GruneisenPlotter">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.GruneisenPlotter">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">GruneisenPlotter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot GruneisenParameter.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gruneisen</span><span class="p">:</span> <span class="n">GruneisenParameter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot information from GruneisenParameter.</span>

<span class="sd">        Args:</span>
<span class="sd">            gruneisen (GruneisenParameter): containing the data to plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gruneisen</span> <span class="o">=</span> <span class="n">gruneisen</span>

<div class="viewcode-block" id="GruneisenPlotter.get_plot">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.GruneisenPlotter.get_plot">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">markersize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">units</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;thz&quot;</span><span class="p">,</span> <span class="s2">&quot;ev&quot;</span><span class="p">,</span> <span class="s2">&quot;mev&quot;</span><span class="p">,</span> <span class="s2">&quot;ha&quot;</span><span class="p">,</span> <span class="s2">&quot;cm-1&quot;</span><span class="p">,</span> <span class="s2">&quot;cm^-1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;thz&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Axes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Will produce a plot.</span>

<span class="sd">        Args:</span>
<span class="sd">            marker: marker for the depiction</span>
<span class="sd">            markersize: size of the marker</span>
<span class="sd">            units: unit for the plots, accepted units: thz, ev, mev, ha, cm-1, cm^-1.</span>

<span class="sd">        Returns:</span>
<span class="sd">            plt.Axes: matplotlib axes object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">freq_unit</span> <span class="o">=</span> <span class="n">freq_units</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>

        <span class="n">xs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gruneisen</span><span class="o">.</span><span class="n">frequencies</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">*</span> <span class="n">freq_unit</span><span class="o">.</span><span class="n">factor</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gruneisen</span><span class="o">.</span><span class="n">gruneisen</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">pretty_plot</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;$\mathrm</span><span class="se">{{</span><span class="s2">Frequency\ (</span><span class="si">{</span><span class="n">freq_unit</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">)</span><span class="se">}}</span><span class="s2">$&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mathrm{Grüneisen\ parameter}$&quot;</span><span class="p">)</span>

        <span class="n">n_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)):</span>
            <span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">n_points</span> <span class="o">*</span> <span class="n">idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">n_points</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_points</span> <span class="o">-</span> <span class="n">idx</span><span class="p">))</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="GruneisenPlotter.show">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.GruneisenPlotter.show">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">units</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;thz&quot;</span><span class="p">,</span> <span class="s2">&quot;ev&quot;</span><span class="p">,</span> <span class="s2">&quot;mev&quot;</span><span class="p">,</span> <span class="s2">&quot;ha&quot;</span><span class="p">,</span> <span class="s2">&quot;cm-1&quot;</span><span class="p">,</span> <span class="s2">&quot;cm^-1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;thz&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Will show the plot.</span>

<span class="sd">        Args:</span>
<span class="sd">            units: units for the plot, accepted units: thz, ev, mev, ha, cm-1, cm^-1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_plot</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="GruneisenPlotter.save_plot">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.GruneisenPlotter.save_plot">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">save_plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">,</span>
        <span class="n">img_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;pdf&quot;</span><span class="p">,</span>
        <span class="n">units</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;thz&quot;</span><span class="p">,</span> <span class="s2">&quot;ev&quot;</span><span class="p">,</span> <span class="s2">&quot;mev&quot;</span><span class="p">,</span> <span class="s2">&quot;ha&quot;</span><span class="p">,</span> <span class="s2">&quot;cm-1&quot;</span><span class="p">,</span> <span class="s2">&quot;cm^-1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;thz&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Will save the plot to a file.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename: name of the filename</span>
<span class="sd">            img_format: format of the saved plot</span>
<span class="sd">            units: accepted units: thz, ev, mev, ha, cm-1, cm^-1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_plot</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">img_format</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="GruneisenPhononBSPlotter">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.GruneisenPhononBSPlotter">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">GruneisenPhononBSPlotter</span><span class="p">(</span><span class="n">PhononBSPlotter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot or get data to facilitate the plot of band structure objects.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bs</span><span class="p">:</span> <span class="n">GruneisenPhononBandStructureSymmLine</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            bs: A GruneisenPhononBandStructureSymmLine object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span> <span class="n">GruneisenPhononBandStructureSymmLine</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;GruneisenPhononBSPlotter only works with GruneisenPhononBandStructureSymmLine objects. &quot;</span>
                <span class="s2">&quot;A GruneisenPhononBandStructure object (on a uniform grid for instance and &quot;</span>
                <span class="s2">&quot;not along symmetry lines won&#39;t work)&quot;</span>
            <span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">bs</span><span class="p">)</span>

<div class="viewcode-block" id="GruneisenPhononBSPlotter.bs_plot_data">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.GruneisenPhononBSPlotter.bs_plot_data">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">bs_plot_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the data nicely formatted for a plot.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dict of the following format:</span>
<span class="sd">            ticks: A dict with the &#39;distances&#39; at which there is a qpoint (the</span>
<span class="sd">            x axis) and the labels (None if no label)</span>
<span class="sd">            frequencies: A list (one element for each branch) of frequencies for</span>
<span class="sd">            each qpoint: [branch][qpoint][mode]. The data is</span>
<span class="sd">            stored by branch to facilitate the plotting</span>
<span class="sd">            gruneisen: GruneisenPhononBandStructureSymmLine</span>
<span class="sd">            lattice: The reciprocal lattice.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">distance</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">frequency</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">gruneisen</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">ticks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">branch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">branches</span><span class="p">:</span>
            <span class="n">frequency</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="n">gruneisen</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="n">distance</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">distance</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">branch</span><span class="p">[</span><span class="s2">&quot;start_index&quot;</span><span class="p">],</span> <span class="n">branch</span><span class="p">[</span><span class="s2">&quot;end_index&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>

            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bands</span><span class="p">):</span>
                <span class="n">frequency</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">bands</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">branch</span><span class="p">[</span><span class="s2">&quot;start_index&quot;</span><span class="p">],</span> <span class="n">branch</span><span class="p">[</span><span class="s2">&quot;end_index&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
                <span class="p">)</span>
                <span class="n">gruneisen</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">gruneisen</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">branch</span><span class="p">[</span><span class="s2">&quot;start_index&quot;</span><span class="p">],</span> <span class="n">branch</span><span class="p">[</span><span class="s2">&quot;end_index&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;ticks&quot;</span><span class="p">:</span> <span class="n">ticks</span><span class="p">,</span>
            <span class="s2">&quot;distances&quot;</span><span class="p">:</span> <span class="n">distance</span><span class="p">,</span>
            <span class="s2">&quot;frequency&quot;</span><span class="p">:</span> <span class="n">frequency</span><span class="p">,</span>
            <span class="s2">&quot;gruneisen&quot;</span><span class="p">:</span> <span class="n">gruneisen</span><span class="p">,</span>
            <span class="s2">&quot;lattice&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">lattice_rec</span><span class="o">.</span><span class="n">as_dict</span><span class="p">(),</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="GruneisenPhononBSPlotter.get_plot_gs">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.GruneisenPhononBSPlotter.get_plot_gs">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_plot_gs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ylim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">plot_ph_bs_with_gruneisen</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Axes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a matplotlib object for the Gruneisen bandstructure plot.</span>

<span class="sd">        Args:</span>
<span class="sd">            ylim: Specify the y-axis (gruneisen) limits; by default None let</span>
<span class="sd">                the code choose.</span>
<span class="sd">            plot_ph_bs_with_gruneisen (bool): Plot phonon band-structure with bands coloured</span>
<span class="sd">                as per Gruneisen parameter values on a logarithmic scale</span>
<span class="sd">            **kwargs: additional keywords passed to ax.plot().</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">freq_units</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;units&quot;</span><span class="p">,</span> <span class="s2">&quot;THz&quot;</span><span class="p">))</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">pretty_plot</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

        <span class="c1"># Create a colormap (default is red to blue)</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s2">&quot;cmap&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cmap&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">]))</span>

        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;linewidth&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;marker&quot;</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;markersize&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bs_plot_data</span><span class="p">()</span>

        <span class="c1"># extract min and max Grüneisen parameter values</span>
        <span class="n">max_gruneisen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;gruneisen&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">min_gruneisen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;gruneisen&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

        <span class="c1"># LogNormalize colormap based on the min and max Grüneisen parameter values</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">SymLogNorm</span><span class="p">(</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">min_gruneisen</span><span class="p">,</span>
            <span class="n">vmax</span><span class="o">=</span><span class="n">max_gruneisen</span><span class="p">,</span>
            <span class="n">linthresh</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
            <span class="n">linscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">sc</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">dists_inx</span><span class="p">,</span> <span class="n">dists</span><span class="p">),</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">freqs</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">]),</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;frequency&quot;</span><span class="p">]),</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">):</span>
            <span class="k">for</span> <span class="n">band_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bands</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">plot_ph_bs_with_gruneisen</span><span class="p">:</span>
                    <span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">freqs</span><span class="p">[</span><span class="n">band_idx</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">factor</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dists</span><span class="p">))]</span>
                    <span class="n">ys_gru</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;gruneisen&quot;</span><span class="p">][</span><span class="n">dists_inx</span><span class="p">][</span><span class="n">band_idx</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">][</span><span class="n">dists_inx</span><span class="p">]))</span>
                    <span class="p">]</span>
                    <span class="n">sc</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dists</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">ys_gru</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">keys_to_remove</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="s2">&quot;units&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;cmap&quot;</span><span class="p">,</span>
                    <span class="p">)</span>  <span class="c1"># needs to be removed before passing to line-plot</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys_to_remove</span><span class="p">:</span>
                        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                    <span class="n">ys</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;gruneisen&quot;</span><span class="p">][</span><span class="n">dists_inx</span><span class="p">][</span><span class="n">band_idx</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">][</span><span class="n">dists_inx</span><span class="p">]))</span>
                    <span class="p">]</span>

                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">][</span><span class="n">dists_inx</span><span class="p">],</span> <span class="n">ys</span><span class="p">,</span> <span class="s2">&quot;b-&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_make_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

        <span class="c1"># plot y=0 line</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

        <span class="c1"># Main X and Y Labels</span>
        <span class="k">if</span> <span class="n">plot_ph_bs_with_gruneisen</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mathrm{Wave\ Vector}$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
            <span class="n">units</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;units&quot;</span><span class="p">,</span> <span class="s2">&quot;THz&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Frequencies (</span><span class="si">{</span><span class="n">units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

            <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\gamma \ \mathrm{(logarithmized)}$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mathrm{Wave\ Vector}$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\mathrm{Grüneisen\ Parameter}$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

        <span class="c1"># X range (K)</span>
        <span class="c1"># last distance point</span>
        <span class="n">x_max</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_max</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="GruneisenPhononBSPlotter.show_gs">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.GruneisenPhononBSPlotter.show_gs">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">show_gs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ylim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">plot_ph_bs_with_gruneisen</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Show the plot using matplotlib.</span>

<span class="sd">        Args:</span>
<span class="sd">            ylim: Specifies the y-axis limits.</span>
<span class="sd">            plot_ph_bs_with_gruneisen: Plot phonon band-structure with bands coloured</span>
<span class="sd">                as per Gruneisen parameter values on a logarithmic scale</span>
<span class="sd">            **kwargs: kwargs passed to get_plot_gs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_plot_gs</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span> <span class="n">plot_ph_bs_with_gruneisen</span><span class="o">=</span><span class="n">plot_ph_bs_with_gruneisen</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="GruneisenPhononBSPlotter.save_plot_gs">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.GruneisenPhononBSPlotter.save_plot_gs">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">save_plot_gs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PathLike</span><span class="p">,</span>
        <span class="n">img_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;eps&quot;</span><span class="p">,</span>
        <span class="n">ylim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">plot_ph_bs_with_gruneisen</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save matplotlib plot to a file.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename: Filename to write to.</span>
<span class="sd">            img_format: Image format to use. Defaults to EPS.</span>
<span class="sd">            ylim: Specifies the y-axis limits.</span>
<span class="sd">            plot_ph_bs_with_gruneisen: Plot phonon band-structure with bands coloured</span>
<span class="sd">                as per Gruneisen parameter values on a logarithmic scale</span>
<span class="sd">            **kwargs: kwargs passed to get_plot_gs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_plot_gs</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="n">ylim</span><span class="p">,</span> <span class="n">plot_ph_bs_with_gruneisen</span><span class="o">=</span><span class="n">plot_ph_bs_with_gruneisen</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">img_format</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="GruneisenPhononBSPlotter.plot_compare_gs">
<a class="viewcode-back" href="../../../pymatgen.phonon.html#pymatgen.phonon.plotter.GruneisenPhononBSPlotter.plot_compare_gs">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_compare_gs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_plotter</span><span class="p">:</span> <span class="n">GruneisenPhononBSPlotter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Axes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot two band structure for comparison. One is in red the other in blue.</span>
<span class="sd">        The two band structures need to be defined on the same symmetry lines!</span>
<span class="sd">        and the distance between symmetry lines is</span>
<span class="sd">        the one of the band structure used to build the PhononBSPlotter.</span>

<span class="sd">        Args:</span>
<span class="sd">            other_plotter (GruneisenPhononBSPlotter): another phonon DOS plotter defined along</span>
<span class="sd">                the same symmetry lines.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if the two plotters are incompatible (due to different data lengths)</span>

<span class="sd">        Returns:</span>
<span class="sd">            plt.Axes: with both band structures</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_orig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bs_plot_data</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">other_plotter</span><span class="o">.</span><span class="n">bs_plot_data</span><span class="p">()</span>

        <span class="n">len_orig</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_orig</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">])</span>
        <span class="n">len_other</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">len_orig</span> <span class="o">!=</span> <span class="n">len_other</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The two plotters are incompatible, plotting data have different lengths (</span><span class="si">{</span><span class="n">len_orig</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">len_other</span><span class="si">}</span><span class="s2">).&quot;</span>
            <span class="p">)</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot</span><span class="p">()</span>
        <span class="n">band_linewidth</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">band_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">other_plotter</span><span class="o">.</span><span class="n">n_bands</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">dist_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_orig</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">])):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">data_orig</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">][</span><span class="n">dist_idx</span><span class="p">],</span>
                    <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;gruneisen&quot;</span><span class="p">][</span><span class="n">dist_idx</span><span class="p">][</span><span class="n">band_idx</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_orig</span><span class="p">[</span><span class="s2">&quot;distances&quot;</span><span class="p">][</span><span class="n">dist_idx</span><span class="p">]))],</span>
                    <span class="s2">&quot;r-&quot;</span><span class="p">,</span>
                    <span class="n">linewidth</span><span class="o">=</span><span class="n">band_linewidth</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">ax</span></div>
</div>

</pre></div>

            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">pymatgen 2025.1.24 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pymatgen.phonon.plotter</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2011, Pymatgen Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
  </body>
</html>