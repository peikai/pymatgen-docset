
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pymatgen.io.cp2k.inputs &#8212; pymatgen 2022.4.19 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/basic.css" />
    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
 
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-33990148-1']);
  _gaq.push(['_trackPageview']);
</script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">pymatgen 2022.4.19 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pymatgen.io.cp2k.inputs</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <h1>Source code for pymatgen.io.cp2k.inputs</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module defines the building blocks of a CP2K input file. The cp2k input structure is</span>
<span class="sd">essentially a collection of &quot;sections&quot; which are similar to dictionary objects that activate</span>
<span class="sd">modules of the cp2k executable, and then &quot;keywords&quot; which adjust variables inside of those</span>
<span class="sd">modules. For example, FORCE_EVAL section will activate CP2K&#39;s ability to calculate forces,</span>
<span class="sd">and inside FORCE_EVAL, the Keyword &quot;METHOD can be set to &quot;QS&quot; to set the method of force</span>
<span class="sd">evaluation to be the quickstep (DFT) module.</span>

<span class="sd">A quick overview of the module:</span>

<span class="sd">-- Section class defines the basis of Cp2k input and contains methods for manipulating these</span>
<span class="sd">   objects similarly to Dicts.</span>
<span class="sd">-- Keyword class defines the keywords used inside of Section objects that changes variables in</span>
<span class="sd">   Cp2k programs.</span>
<span class="sd">-- SectionList and KeywordList classes are lists of Section and Keyword objects that have</span>
<span class="sd">   the same dictionary key. This deals with repeated sections and keywords.</span>
<span class="sd">-- Cp2kInput class is special instantiation of Section that is used to represent the full cp2k</span>
<span class="sd">   calculation input.</span>
<span class="sd">-- The rest of the classes are children of Section intended to make initialization of common</span>
<span class="sd">   sections easier.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">textwrap</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Sequence</span>

<span class="kn">from</span> <span class="nn">monty.io</span> <span class="kn">import</span> <span class="n">zopen</span>
<span class="kn">from</span> <span class="nn">monty.json</span> <span class="kn">import</span> <span class="n">MSONable</span>

<span class="kn">from</span> <span class="nn">pymatgen.core.lattice</span> <span class="kn">import</span> <span class="n">Lattice</span>
<span class="kn">from</span> <span class="nn">pymatgen.core.periodic_table</span> <span class="kn">import</span> <span class="n">Element</span>
<span class="kn">from</span> <span class="nn">pymatgen.core.structure</span> <span class="kn">import</span> <span class="n">Molecule</span><span class="p">,</span> <span class="n">Structure</span>
<span class="kn">from</span> <span class="nn">pymatgen.io.cp2k.utils</span> <span class="kn">import</span> <span class="n">_postprocessor</span><span class="p">,</span> <span class="n">_preprocessor</span>
<span class="kn">from</span> <span class="nn">pymatgen.symmetry.analyzer</span> <span class="kn">import</span> <span class="n">SpacegroupAnalyzer</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Nicholas Winner&quot;</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;1.0&quot;</span>
<span class="n">__email__</span> <span class="o">=</span> <span class="s2">&quot;nwinner@berkeley.edu&quot;</span>
<span class="n">__date__</span> <span class="o">=</span> <span class="s2">&quot;March 2022&quot;</span>


<div class="viewcode-block" id="Keyword"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Keyword">[docs]</a><span class="k">class</span> <span class="nc">Keyword</span><span class="p">(</span><span class="n">MSONable</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class representing a keyword argument in CP2K. Within CP2K Sections, which activate features</span>
<span class="sd">    of the CP2K code, the keywords are arguments that control the functionality of that feature.</span>
<span class="sd">    For example, the section &quot;FORCE_EVAL&quot; activates the evaluation of forces/energies, but within</span>
<span class="sd">    &quot;FORCE_EVAL&quot; the keyword &quot;METHOD&quot; controls whether or not this will be done with, say,</span>
<span class="sd">    &quot;Quickstep&quot; (DFT) or &quot;EIP&quot; (empirical interatomic potential).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="n">values</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">units</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">repeats</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes a keyword. These Keywords and the value passed to them are sometimes as simple</span>
<span class="sd">        as KEYWORD VALUE, but can also be more elaborate such as KEYWORD [UNITS] VALUE1 VALUE2,</span>
<span class="sd">        which is why this class exists: to handle many values and control easy printing to an</span>
<span class="sd">        input file.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name of this keyword. Must match an acceptable keyword from CP2K</span>
<span class="sd">            args: All non-keyword arguments after &#39;name&#39; are interpreted as the values to set for</span>
<span class="sd">                this keyword. i.e: KEYWORD ARG1 ARG2 would provide two values to the keyword.</span>
<span class="sd">            description (str): The description for this keyword. This can make readability of</span>
<span class="sd">                input files easier for some. Default=None.</span>
<span class="sd">            units (str): The units for this keyword. If not specified, CP2K default units will be</span>
<span class="sd">                used. Consult manual for default units. Default=None.</span>
<span class="sd">            repeats (bool): Whether or not this keyword may be repeated. Default=False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">description</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repeats</span> <span class="o">=</span> <span class="n">repeats</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
            <span class="o">+</span> <span class="s2">&quot; &quot;</span>
            <span class="o">+</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="si">}</span><span class="s2">] &quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
            <span class="o">+</span> <span class="p">(</span><span class="s2">&quot; ! &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
            <span class="n">v1</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
            <span class="n">v2</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">v1</span> <span class="o">==</span> <span class="n">v2</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">KeywordList</span><span class="p">(</span><span class="n">keywords</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>

<div class="viewcode-block" id="Keyword.as_dict"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Keyword.as_dict">[docs]</a>    <span class="k">def</span> <span class="nf">as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a dictionary representation of the Keyword</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">d</span><span class="p">[</span><span class="s2">&quot;@module&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__module__</span>
        <span class="n">d</span><span class="p">[</span><span class="s2">&quot;@class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">d</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">d</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span>
        <span class="n">d</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span>
        <span class="n">d</span><span class="p">[</span><span class="s2">&quot;repeats&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeats</span>
        <span class="n">d</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span>
        <span class="n">d</span><span class="p">[</span><span class="s2">&quot;verbose&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span>
        <span class="k">return</span> <span class="n">d</span></div>

<div class="viewcode-block" id="Keyword.get_string"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Keyword.get_string">[docs]</a>    <span class="k">def</span> <span class="nf">get_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        String representation of Keyword</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span></div>

<div class="viewcode-block" id="Keyword.from_dict"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Keyword.from_dict">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise from dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Keyword</span><span class="p">(</span>
            <span class="n">d</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
            <span class="o">*</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">],</span>
            <span class="n">description</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">],</span>
            <span class="n">repeats</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;repeats&quot;</span><span class="p">],</span>
            <span class="n">units</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">],</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;verbose&quot;</span><span class="p">],</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Keyword.from_string"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Keyword.from_string">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise from a string.</span>

<span class="sd">        Keywords must be labeled with strings. If the postprocessor finds</span>
<span class="sd">        that the keywords is a number, then None is return (used by</span>
<span class="sd">        the file reader).</span>

<span class="sd">        returns:</span>
<span class="sd">            Keyword or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="fm">__contains__</span><span class="p">(</span><span class="s2">&quot;!&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">s</span><span class="o">.</span><span class="fm">__contains__</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">):</span>
            <span class="n">s</span><span class="p">,</span> <span class="n">description</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;(?:!|#)&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
            <span class="n">description</span> <span class="o">=</span> <span class="n">description</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">units</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[(.*)\]&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="ow">or</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[(.*)\]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">_postprocessor</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
        <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">Keyword</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">)</span></div>

<div class="viewcode-block" id="Keyword.verbosity"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Keyword.verbosity">[docs]</a>    <span class="k">def</span> <span class="nf">verbosity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change the printing of this keyword&#39;s description.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">v</span></div></div>


<div class="viewcode-block" id="KeywordList"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.KeywordList">[docs]</a><span class="k">class</span> <span class="nc">KeywordList</span><span class="p">(</span><span class="n">MSONable</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Some keywords can be repeated, which makes accessing them via the normal dictionary</span>
<span class="sd">    methods a little unnatural. This class deals with this by defining a collection</span>
<span class="sd">    of same-named keywords that are accessed by one name.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keywords</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Keyword</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes a keyword list given a sequence of keywords.</span>

<span class="sd">        Args:</span>
<span class="sd">            keywords: A list of keywords. Must all have the same name (case-insensitive)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="n">keywords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">)</span> <span class="k">if</span> <span class="n">keywords</span> <span class="k">else</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">keywords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">keywords</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_string</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">k</span> <span class="o">==</span> <span class="n">o</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">keywords</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>

<div class="viewcode-block" id="KeywordList.append"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.KeywordList.append">[docs]</a>    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        append the keyword list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></div>

<div class="viewcode-block" id="KeywordList.extend"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.KeywordList.extend">[docs]</a>    <span class="k">def</span> <span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        extend the keyword list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></div>

<div class="viewcode-block" id="KeywordList.get_string"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.KeywordList.get_string">[docs]</a>    <span class="k">def</span> <span class="nf">get_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        String representation of Keyword</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot; </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="n">indent</span> <span class="o">+</span> <span class="n">k</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">])</span></div>

<div class="viewcode-block" id="KeywordList.verbosity"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.KeywordList.verbosity">[docs]</a>    <span class="k">def</span> <span class="nf">verbosity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Silence all keywords in keyword list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">:</span>
            <span class="n">k</span><span class="o">.</span><span class="n">verbosity</span><span class="p">(</span><span class="n">verbosity</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Section"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Section">[docs]</a><span class="k">class</span> <span class="nc">Section</span><span class="p">(</span><span class="n">MSONable</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Basic input representation of input to Cp2k. Activates functionality inside of the</span>
<span class="sd">    Cp2k executable.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">required_sections</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">required_keywords</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">subsections</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">repeats</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">keywords</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
        <span class="n">section_parameters</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Basic object representing a CP2K Section. Sections activate different parts of the</span>
<span class="sd">        calculation. For example, FORCE_EVAL section will activate CP2K&#39;s ability to calculate</span>
<span class="sd">        forces.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name of the section (must match name in CP2K)</span>
<span class="sd">            subsections (dict): A dictionary of subsections that are nested in this section.</span>
<span class="sd">                Format is {&#39;NAME&#39;: Section(*args, **kwargs). The name you chose for &#39;NAME&#39;</span>
<span class="sd">                to index that subsection does not *have* to be the same as the section&#39;s true name,</span>
<span class="sd">                but we recommend matching them. You can specify a blank dictionary if there are</span>
<span class="sd">                no subsections, or if you want to insert the subsections later.</span>
<span class="sd">            repeats (bool): Whether or not this section can be repeated. Most sections cannot.</span>
<span class="sd">                Default=False.</span>
<span class="sd">            description (str): Description of this section for easier readability</span>
<span class="sd">            keywords (list): the keywords to be set for this section. Each element should be a</span>
<span class="sd">                Keyword object. This can be more cumbersome than simply using kwargs for building</span>
<span class="sd">                a class in a script, but is more convenient for the class instantiations of CP2K</span>
<span class="sd">                sections (see below).</span>
<span class="sd">            section_parameters (list): the section parameters for this section. Section parameters</span>
<span class="sd">                are specialized keywords that modify the behavior of the section overall. Most</span>
<span class="sd">                sections do not have section parameters, but some do. Unlike normal Keywords,</span>
<span class="sd">                these are specified as strings and not as Keyword objects.</span>
<span class="sd">            location (str): the path to the section in the form &#39;SECTION/SUBSECTION1/SUBSECTION3&#39;,</span>
<span class="sd">                example for QS module: &#39;FORCE_EVAL/DFT/QS&#39;. This location is used to automatically</span>
<span class="sd">                determine if a subsection requires a supersection to be activated.</span>
<span class="sd">            verbose (str): Controls how much is printed to Cp2k input files (Also see Keyword).</span>
<span class="sd">                If True, then a description of the section will be printed with it as a comment</span>
<span class="sd">                (if description is set). Default=True.</span>

<span class="sd">            kwargs are interpreted as keyword, value pairs and added to the keywords array as</span>
<span class="sd">            Keyword objects</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span> <span class="o">=</span> <span class="n">subsections</span> <span class="k">if</span> <span class="n">subsections</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repeats</span> <span class="o">=</span> <span class="n">repeats</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">description</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="n">keywords</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span> <span class="o">=</span> <span class="n">section_parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="n">location</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alias</span> <span class="o">=</span> <span class="n">alias</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">Keyword</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">required_sections</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;WARNING: REQUIRED SECTION </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> HAS NOT BEEN INITIALIZED&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">required_keywords</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;WARNING: REQUIRED KEYWORD </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> HAS NOT BEEN PROVIDED&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_string</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">d2</span><span class="o">.</span><span class="n">silence</span><span class="p">()</span>
        <span class="n">s2</span><span class="o">.</span><span class="n">silence</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">d2</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span> <span class="o">==</span> <span class="n">s2</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memodict</span><span class="o">=</span><span class="p">{}):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">as_dict</span><span class="p">())</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="nb">__import__</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s2">&quot;@module&quot;</span><span class="p">],</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">(),</span> <span class="n">c</span><span class="p">[</span><span class="s2">&quot;@class&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span> <span class="n">c</span><span class="p">[</span><span class="s2">&quot;@class&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
            <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">as_dict</span><span class="p">())</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_keyword</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_section</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">r</span>
        <span class="k">raise</span> <span class="ne">KeyError</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Keyword</span><span class="p">,</span> <span class="n">KeywordList</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="n">other</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">+=</span> <span class="n">other</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="n">other</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">other</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Section</span><span class="p">,</span> <span class="n">SectionList</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Can only add sections or keywords.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="n">Section</span><span class="p">,</span> <span class="n">SectionList</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">__deepcopy__</span><span class="p">()</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">strict</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="n">Keyword</span><span class="p">,</span> <span class="n">KeywordList</span><span class="p">)):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">Keyword</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="n">match</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span> <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="n">k</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="n">match</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">strict</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete section with name matching key OR delete all keywords</span>
<span class="sd">        with names matching this key</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span>
        <span class="k">if</span> <span class="n">l</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span><span class="p">[</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">return</span>
        <span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span> <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span>
        <span class="k">if</span> <span class="n">l</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">return</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;No section or keyword matching the given key.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__delitem__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

<div class="viewcode-block" id="Section.add"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Section.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add another keyword to the current section</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Keyword</span><span class="p">,</span> <span class="n">KeywordList</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></div>

<div class="viewcode-block" id="Section.get"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Section.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Similar to get for dictionaries. This will attempt to retrieve the</span>
<span class="sd">        section or keyword matching d. Will not raise an error if d does not</span>
<span class="sd">        exist.</span>

<span class="sd">        Args:</span>
<span class="sd">             d: the key to retrieve, if present</span>
<span class="sd">             default: what to return if d is not found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_keyword</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">r</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_section</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">r</span>
        <span class="k">return</span> <span class="n">default</span></div>

<div class="viewcode-block" id="Section.get_section"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Section.get_section">[docs]</a>    <span class="k">def</span> <span class="nf">get_section</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get function, only for subsections</span>

<span class="sd">        Args:</span>
<span class="sd">            d: Name of section to get</span>
<span class="sd">            default: return if d is not found in subsections</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">default</span></div>

<div class="viewcode-block" id="Section.get_keyword"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Section.get_keyword">[docs]</a>    <span class="k">def</span> <span class="nf">get_keyword</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get function, only for subsections</span>

<span class="sd">        Args:</span>
<span class="sd">            d: Name of keyword to get</span>
<span class="sd">            default: return if d is not found in keyword list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">default</span></div>

<div class="viewcode-block" id="Section.update"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Section.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the Section according to a dictionary argument. This is most useful</span>
<span class="sd">        for providing user-override settings to default parameters. As you pass a</span>
<span class="sd">        dictionary the class variables like &quot;description&quot;, &quot;location&quot;, or &quot;repeats&quot;</span>
<span class="sd">        are not included. Therefore, it is recommended that this be used to modify</span>
<span class="sd">        existing Section objects to a user&#39;s needs, but not used for the creation</span>
<span class="sd">        of new Section child-classes.</span>

<span class="sd">        Args:</span>
<span class="sd">            d (dict): A dictionary containing the update information. Should use nested dictionaries</span>
<span class="sd">                to specify the full path of the update. If a section or keyword does not exist, it</span>
<span class="sd">                will be created, but only with the values that are provided in &quot;d&quot;, not using</span>
<span class="sd">                default values from a Section object.</span>
<span class="sd">                Example: {</span>
<span class="sd">                    &#39;SUBSECTION1&#39;: {</span>
<span class="sd">                        &#39;SUBSEC2&#39;: {&#39;NEW_KEYWORD&#39;: &#39;NEW_VAL&#39;},</span>
<span class="sd">                        &#39;NEW_SUBSEC&#39;: {&#39;NEW_KWD&#39;: &#39;NEW_VAL&#39;}</span>
<span class="sd">                        }</span>
<span class="sd">                    }</span>

<span class="sd">            strict (bool): If true, only update existing sections and keywords. If false, allow</span>
<span class="sd">                new sections and keywords. Default: False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Section</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="n">strict</span><span class="p">)</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_update</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper method for self.update(d) method (see above).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d2</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)):</span>
                <span class="n">d1</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">Keyword</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">),</span> <span class="n">strict</span><span class="o">=</span><span class="n">strict</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="n">Keyword</span><span class="p">,</span> <span class="n">KeywordList</span><span class="p">)):</span>
                <span class="n">d1</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="n">strict</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">d1</span><span class="o">.</span><span class="n">subsections</span> <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="n">_</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">tmp</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">strict</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">d1</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Section</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">subsections</span><span class="o">=</span><span class="p">{}))</span>
                    <span class="n">Section</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">d1</span><span class="o">.</span><span class="n">subsections</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">v</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="n">strict</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">Section</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">d1</span><span class="o">.</span><span class="n">subsections</span><span class="p">[</span><span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">v</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="n">strict</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Section</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">strict</span><span class="p">:</span>
                    <span class="n">d1</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unrecognized type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Section.set"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Section.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Alias for update. Used by custodian.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">d</span><span class="p">)</span></div>

<div class="viewcode-block" id="Section.safeset"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Section.safeset">[docs]</a>    <span class="k">def</span> <span class="nf">safeset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Alias for update with strict (no insertions). Used by custodian.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="Section.unset"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Section.unset">[docs]</a>    <span class="k">def</span> <span class="nf">unset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dict based deletion. Used by custodian.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)):</span>
                <span class="k">del</span> <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">v</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="n">Keyword</span><span class="p">,</span> <span class="n">Section</span><span class="p">,</span> <span class="n">KeywordList</span><span class="p">,</span> <span class="n">SectionList</span><span class="p">)):</span>
                <span class="k">del</span> <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">v</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">unset</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Can only add sections or keywords.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Section.inc"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Section.inc">[docs]</a>    <span class="k">def</span> <span class="nf">inc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mongo style dict modification. Include.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">Keyword</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="n">Keyword</span><span class="p">,</span> <span class="n">Section</span><span class="p">,</span> <span class="n">KeywordList</span><span class="p">,</span> <span class="n">SectionList</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">inc</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Can only add sections or keywords.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Section.insert"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Section.insert">[docs]</a>    <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Insert a new section as a subsection of the current one</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">(</span><span class="n">Section</span><span class="p">,</span> <span class="n">SectionList</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span><span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">alias</span> <span class="ow">or</span> <span class="n">d</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">__deepcopy__</span><span class="p">()</span></div>

<div class="viewcode-block" id="Section.check"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Section.check">[docs]</a>    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if section exists within the current using a path. Can be useful for cross-checking</span>
<span class="sd">        whether or not required dependencies have been satisfied, which CP2K does not enforce.</span>

<span class="sd">        Args:</span>
<span class="sd">            path (str): Path to section of form &#39;SUBSECTION1/SUBSECTION2/SUBSECTION_OF_INTEREST&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">_path</span><span class="p">:</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">s</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="n">_</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span>
            <span class="k">if</span> <span class="n">tmp</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">subsections</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Section.by_path"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Section.by_path">[docs]</a>    <span class="k">def</span> <span class="nf">by_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Access a sub-section using a path. Used by the file parser.</span>

<span class="sd">        Args:</span>
<span class="sd">            path (str): Path to section of form &#39;SUBSECTION1/SUBSECTION2/SUBSECTION_OF_INTEREST&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
            <span class="n">_path</span> <span class="o">=</span> <span class="n">_path</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">_path</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get_section</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">s</span></div>

<div class="viewcode-block" id="Section.get_string"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Section.get_string">[docs]</a>    <span class="k">def</span> <span class="nf">get_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get string representation of Section</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Section</span><span class="o">.</span><span class="n">_get_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_string</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function to return a pretty string of the section. Includes indentation and</span>
<span class="sd">        descriptions (if present).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">description</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="o">+</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
                    <span class="n">d</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
                    <span class="n">initial_indent</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="n">indent</span> <span class="o">+</span> <span class="s2">&quot;! &quot;</span><span class="p">,</span>
                    <span class="n">subsequent_indent</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="n">indent</span> <span class="o">+</span> <span class="s2">&quot;! &quot;</span><span class="p">,</span>
                    <span class="n">width</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="n">indent</span> <span class="o">+</span> <span class="s2">&quot;&amp;&quot;</span> <span class="o">+</span> <span class="n">d</span><span class="o">.</span><span class="n">name</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">section_parameters</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">keywords</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">KeywordList</span><span class="p">):</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="n">v</span><span class="o">.</span><span class="n">get_string</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="n">indent</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="p">(</span><span class="n">indent</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">v</span><span class="o">.</span><span class="n">get_string</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">subsections</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="n">v</span><span class="o">.</span><span class="n">_get_string</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="n">indent</span> <span class="o">+</span> <span class="s2">&quot;&amp;END &quot;</span> <span class="o">+</span> <span class="n">d</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="n">string</span>

<div class="viewcode-block" id="Section.verbosity"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Section.verbosity">[docs]</a>    <span class="k">def</span> <span class="nf">verbosity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change the section verbossity recursively by turning on/off the printing of descriptions.</span>
<span class="sd">        Turning off descriptions may reduce the appealing documentation of input files, but also</span>
<span class="sd">        helps de-clutter them.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbosity</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">v</span><span class="o">.</span><span class="n">verbosity</span><span class="p">(</span><span class="n">verbosity</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">v</span><span class="o">.</span><span class="n">verbosity</span><span class="p">(</span><span class="n">verbosity</span><span class="p">)</span></div>

<div class="viewcode-block" id="Section.silence"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Section.silence">[docs]</a>    <span class="k">def</span> <span class="nf">silence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recursively delete all print sections so that only defaults are printed out.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;PRINT&quot;</span><span class="p">):</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span><span class="p">[</span><span class="s2">&quot;PRINT&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">_s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span><span class="p">[</span><span class="n">_s</span><span class="p">]</span><span class="o">.</span><span class="n">silence</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="SectionList"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.SectionList">[docs]</a><span class="k">class</span> <span class="nc">SectionList</span><span class="p">(</span><span class="n">MSONable</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Section list</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sections</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Section</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes a SectionList object using a sequence of sections.</span>

<span class="sd">        Args:</span>
<span class="sd">            sections: A list of keywords. Must all have the same name (case-insensitive)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">sections</span><span class="p">)</span> <span class="k">if</span> <span class="n">sections</span> <span class="k">else</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">sections</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alias</span> <span class="o">=</span> <span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">alias</span> <span class="k">if</span> <span class="n">sections</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="n">sections</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_string</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">k</span> <span class="o">==</span> <span class="n">o</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">sections</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memodict</span><span class="o">=</span><span class="p">{}):</span>
        <span class="k">return</span> <span class="n">SectionList</span><span class="p">(</span><span class="n">sections</span><span class="o">=</span><span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">__deepcopy__</span><span class="p">()</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">])</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_string</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot; </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">_get_string</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">d</span><span class="p">])</span>

<div class="viewcode-block" id="SectionList.get_string"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.SectionList.get_string">[docs]</a>    <span class="k">def</span> <span class="nf">get_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return string representation of section list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">SectionList</span><span class="o">.</span><span class="n">_get_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">)</span></div>

<div class="viewcode-block" id="SectionList.get"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.SectionList.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">index</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get for section list. If index is specified, return the section at that index.</span>
<span class="sd">        Otherwise, return a get on the last section.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">d</span><span class="p">)</span></div>

<div class="viewcode-block" id="SectionList.append"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.SectionList.append">[docs]</a>    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        append the keyword list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></div>

<div class="viewcode-block" id="SectionList.extend"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.SectionList.extend">[docs]</a>    <span class="k">def</span> <span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        extend the keyword list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></div>

<div class="viewcode-block" id="SectionList.verbosity"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.SectionList.verbosity">[docs]</a>    <span class="k">def</span> <span class="nf">verbosity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Silence all keywords in keyword list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">:</span>
            <span class="n">k</span><span class="o">.</span><span class="n">verbosity</span><span class="p">(</span><span class="n">verbosity</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Cp2kInput"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Cp2kInput">[docs]</a><span class="k">class</span> <span class="nc">Cp2kInput</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Special instance of &#39;Section&#39; class that is meant to represent the overall cp2k input.</span>
<span class="sd">    Distinguishes itself from Section by overriding get_string() to not print this section&#39;s</span>
<span class="sd">    title and by implementing the file i/o.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;CP2K_INPUT&quot;</span><span class="p">,</span> <span class="n">subsections</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize Cp2kInput by calling the super</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span> <span class="o">=</span> <span class="n">subsections</span> <span class="k">if</span> <span class="n">subsections</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;CP2K Input&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">repeats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">section_parameters</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">subsections</span><span class="o">=</span><span class="n">subsections</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="Cp2kInput.get_string"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Cp2kInput.get_string">[docs]</a>    <span class="k">def</span> <span class="nf">get_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get string representation of the Cp2kInput</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_string</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">s</span></div>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize from a dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">Cp2kInput</span><span class="p">(</span>
            <span class="s2">&quot;CP2K_INPUT&quot;</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span>
                <span class="nb">__import__</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;@module&quot;</span><span class="p">],</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">(),</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;@class&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">d</span><span class="p">[</span><span class="s2">&quot;@class&quot;</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="o">.</span><span class="n">subsections</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="Cp2kInput.from_file"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Cp2kInput.from_file">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize from a file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">zopen</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">txt</span> <span class="o">=</span> <span class="n">_preprocessor</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">Cp2kInput</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span></div>

<div class="viewcode-block" id="Cp2kInput.from_string"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Cp2kInput.from_string">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize from a string</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">]</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">]</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span> <span class="k">if</span> <span class="n">line</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">Cp2kInput</span><span class="o">.</span><span class="n">from_lines</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span></div>

<div class="viewcode-block" id="Cp2kInput.from_lines"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Cp2kInput.from_lines">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_lines</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper method to read lines of file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cp2k_input</span> <span class="o">=</span> <span class="n">Cp2kInput</span><span class="p">(</span><span class="s2">&quot;CP2K_INPUT&quot;</span><span class="p">,</span> <span class="n">subsections</span><span class="o">=</span><span class="p">{})</span>
        <span class="n">Cp2kInput</span><span class="o">.</span><span class="n">_from_lines</span><span class="p">(</span><span class="n">cp2k_input</span><span class="p">,</span> <span class="n">lines</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cp2k_input</span></div>

    <span class="k">def</span> <span class="nf">_from_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper method, reads lines of text to get a Cp2kInput</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;!&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">):</span>
                <span class="n">description</span> <span class="o">+=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&amp;END&quot;</span><span class="p">):</span>
                <span class="n">current</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">):</span>
                <span class="n">name</span><span class="p">,</span> <span class="n">subsection_params</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="n">subsection_params</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="p">[]</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">subsection_params</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">subsection_params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="s2">&quot;TRUE&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;FALSE&quot;</span><span class="p">,</span> <span class="s2">&quot;ON&quot;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="n">subsection_params</span>
                <span class="p">)</span>
                <span class="n">alias</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subsection_params</span><span class="p">)</span> <span class="k">if</span> <span class="n">subsection_params</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">Section</span><span class="p">(</span>
                    <span class="n">name</span><span class="p">,</span>
                    <span class="n">section_parameters</span><span class="o">=</span><span class="n">subsection_params</span><span class="p">,</span>
                    <span class="n">alias</span><span class="o">=</span><span class="n">alias</span><span class="p">,</span>
                    <span class="n">subsections</span><span class="o">=</span><span class="p">{},</span>
                    <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">by_path</span><span class="p">(</span><span class="n">current</span><span class="p">)</span><span class="o">.</span><span class="n">get_section</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">alias</span> <span class="ow">or</span> <span class="n">s</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">tmp</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">SectionList</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">by_path</span><span class="p">(</span><span class="n">current</span><span class="p">)[</span><span class="n">s</span><span class="o">.</span><span class="n">alias</span> <span class="ow">or</span> <span class="n">s</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">by_path</span><span class="p">(</span><span class="n">current</span><span class="p">)[</span><span class="n">s</span><span class="o">.</span><span class="n">alias</span> <span class="ow">or</span> <span class="n">s</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">SectionList</span><span class="p">(</span><span class="n">sections</span><span class="o">=</span><span class="p">[</span><span class="n">tmp</span><span class="p">,</span> <span class="n">s</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">by_path</span><span class="p">(</span><span class="n">current</span><span class="p">)</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                <span class="n">current</span> <span class="o">=</span> <span class="n">current</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">alias</span> <span class="k">if</span> <span class="n">alias</span> <span class="k">else</span> <span class="n">current</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">name</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">kwd</span> <span class="o">=</span> <span class="n">Keyword</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">by_path</span><span class="p">(</span><span class="n">current</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">kwd</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">tmp</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">KeywordList</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">by_path</span><span class="p">(</span><span class="n">current</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">kwd</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwd</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">by_path</span><span class="p">(</span><span class="n">current</span><span class="p">),</span> <span class="n">SectionList</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">by_path</span><span class="p">(</span><span class="n">current</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">kwd</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeywordList</span><span class="p">(</span><span class="n">keywords</span><span class="o">=</span><span class="p">[</span><span class="n">tmp</span><span class="p">,</span> <span class="n">kwd</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">by_path</span><span class="p">(</span><span class="n">current</span><span class="p">)[</span><span class="n">kwd</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeywordList</span><span class="p">(</span><span class="n">keywords</span><span class="o">=</span><span class="p">[</span><span class="n">kwd</span><span class="p">,</span> <span class="n">tmp</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">by_path</span><span class="p">(</span><span class="n">current</span><span class="p">),</span> <span class="n">SectionList</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">by_path</span><span class="p">(</span><span class="n">current</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="n">kwd</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwd</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">by_path</span><span class="p">(</span><span class="n">current</span><span class="p">)</span><span class="o">.</span><span class="n">keywords</span><span class="p">[</span><span class="n">kwd</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwd</span>

<div class="viewcode-block" id="Cp2kInput.write_file"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Cp2kInput.write_file">[docs]</a>    <span class="k">def</span> <span class="nf">write_file</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">input_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cp2k.inp&quot;</span><span class="p">,</span>
        <span class="n">output_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span>
        <span class="n">make_dir_if_not_present</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Write input to a file.</span>

<span class="sd">        Args:</span>
<span class="sd">            input_filename (str, optional): Defaults to &quot;cp2k.inp&quot;.</span>
<span class="sd">            output_dir (str, optional): Defaults to &quot;.&quot;.</span>
<span class="sd">            make_dir_if_not_present (bool, optional): Defaults to True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">output_dir</span><span class="p">)</span> <span class="ow">and</span> <span class="n">make_dir_if_not_present</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">output_dir</span><span class="p">)</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">input_filename</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_string</span><span class="p">())</span></div></div>


<div class="viewcode-block" id="Global"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Global">[docs]</a><span class="k">class</span> <span class="nc">Global</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Controls &#39;global&#39; settings for cp2k execution such as RUN_TYPE and PROJECT_NAME</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">project_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;CP2K&quot;</span><span class="p">,</span>
        <span class="n">run_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ENERGY_FORCE&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the global section</span>

<span class="sd">        Args:</span>
<span class="sd">            project_name (str, optional): Defaults to &quot;CP2K&quot;.</span>
<span class="sd">            run_type (str, optional) what type of calculation to run</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span> <span class="o">=</span> <span class="n">project_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_type</span> <span class="o">=</span> <span class="n">run_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="n">description</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Section with general information regarding which kind of simulation&quot;</span> <span class="o">+</span> <span class="s2">&quot; to perform an general settings&quot;</span>
        <span class="p">)</span>

        <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;PROJECT_NAME&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;PROJECT_NAME&quot;</span><span class="p">,</span> <span class="n">project_name</span><span class="p">),</span>
            <span class="s2">&quot;RUN_TYPE&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;RUN_TYPE&quot;</span><span class="p">,</span> <span class="n">run_type</span><span class="p">),</span>
            <span class="s2">&quot;EXTENDED_FFT_LENGTHS&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;EXTENDED_FFT_LENGTHS&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="s2">&quot;GLOBAL&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="p">{},</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="ForceEval"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.ForceEval">[docs]</a><span class="k">class</span> <span class="nc">ForceEval</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Controls the calculation of energy and forces in Cp2k</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subsections</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the ForceEval section</span>

<span class="sd">        Args:</span>
<span class="sd">            subsections (dict, optional): Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span> <span class="o">=</span> <span class="n">subsections</span> <span class="k">if</span> <span class="n">subsections</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="n">description</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Parameters needed to calculate energy and forces&quot;</span> <span class="o">+</span> <span class="s2">&quot; and describe the system you want to analyze.&quot;</span>
        <span class="p">)</span>

        <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;METHOD&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;METHOD&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;METHOD&quot;</span><span class="p">,</span> <span class="s2">&quot;QS&quot;</span><span class="p">)),</span>
            <span class="s2">&quot;STRESS_TENSOR&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;STRESS_TENSOR&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;STRESS_TENSOR&quot;</span><span class="p">,</span> <span class="s2">&quot;ANALYTICAL&quot;</span><span class="p">)),</span>
        <span class="p">}</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="s2">&quot;FORCE_EVAL&quot;</span><span class="p">,</span>
            <span class="n">repeats</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="n">subsections</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Dft"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Dft">[docs]</a><span class="k">class</span> <span class="nc">Dft</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Controls the DFT parameters in Cp2k</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">basis_set_filenames</span><span class="o">=</span><span class="s2">&quot;BASIS_MOLOPT&quot;</span><span class="p">,</span>
        <span class="n">potential_filename</span><span class="o">=</span><span class="s2">&quot;GTH_POTENTIALS&quot;</span><span class="p">,</span>
        <span class="n">uks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">wfn_restart_file_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">subsections</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the DFT section.</span>

<span class="sd">        Args:</span>
<span class="sd">            basis_set_filenames (str, optional): Name of the file that contains the basis set</span>
<span class="sd">                information. Defaults to &quot;BASIS_MOLOPT&quot;.</span>
<span class="sd">            potential_filename (str, optional): Name of the file that contains the pseudopotential</span>
<span class="sd">                information. Defaults to &quot;GTH_POTENTIALS&quot;.</span>
<span class="sd">            uks (bool, optional): Whether to run unrestricted Kohn Sham (spin polarized).</span>
<span class="sd">                Defaults to True.</span>
<span class="sd">            wfn_restart_file_name (str, optional): Defaults to None.</span>
<span class="sd">            subsections (dict, optional): Any subsections to initialize with. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">basis_set_filenames</span> <span class="o">=</span> <span class="n">basis_set_filenames</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">potential_filename</span> <span class="o">=</span> <span class="n">potential_filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uks</span> <span class="o">=</span> <span class="n">uks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wfn_restart_file_name</span> <span class="o">=</span> <span class="n">wfn_restart_file_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span> <span class="o">=</span> <span class="n">subsections</span> <span class="k">if</span> <span class="n">subsections</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Parameter needed by dft programs&quot;</span>

        <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;BASIS_SET_FILE_NAME&quot;</span><span class="p">:</span> <span class="n">KeywordList</span><span class="p">([</span><span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;BASIS_SET_FILE_NAME&quot;</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">basis_set_filenames</span><span class="p">]),</span>
            <span class="s2">&quot;POTENTIAL_FILE_NAME&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;POTENTIAL_FILE_NAME&quot;</span><span class="p">,</span> <span class="n">potential_filename</span><span class="p">),</span>
            <span class="s2">&quot;UKS&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span>
                <span class="s2">&quot;UKS&quot;</span><span class="p">,</span>
                <span class="n">uks</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Whether to run unrestricted Kohn Sham (i.e. spin polarized)&quot;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">wfn_restart_file_name</span><span class="p">:</span>
            <span class="n">keywords</span><span class="p">[</span><span class="s2">&quot;WFN_RESTART_FILE_NAME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;WFN_RESTART_FILE_NAME&quot;</span><span class="p">,</span> <span class="n">wfn_restart_file_name</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="s2">&quot;DFT&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">subsections</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Subsys"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Subsys">[docs]</a><span class="k">class</span> <span class="nc">Subsys</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Controls the definition of the system to be simulated</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subsections</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the subsys section</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span> <span class="o">=</span> <span class="n">subsections</span> <span class="k">if</span> <span class="n">subsections</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;A subsystem: coordinates, topology, molecules and cell&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;SUBSYS&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span> <span class="n">subsections</span><span class="o">=</span><span class="n">subsections</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="QS"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.QS">[docs]</a><span class="k">class</span> <span class="nc">QS</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Controls the quickstep settings (DFT driver)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;GPW&quot;</span><span class="p">,</span>
        <span class="n">eps_default</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-10</span><span class="p">,</span>
        <span class="n">extrapolation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ASPC&quot;</span><span class="p">,</span>
        <span class="n">subsections</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the QS Section</span>

<span class="sd">        Args:</span>
<span class="sd">            method (&quot;GPW&quot; | &quot;GAPW&quot;): What DFT methodology to use. GPW (Gaussian Plane Waves) for</span>
<span class="sd">                DFT with pseudopotentials or GAPW (Gaussian Augmented Plane Waves) for all</span>
<span class="sd">                electron calculations.</span>
<span class="sd">            eps_default (float): The default level of convergence accuracy. NOTE: This is a</span>
<span class="sd">                global value for all the numerical value of all EPS_* values in QS module.</span>
<span class="sd">                It is not the same as EPS_SCF, which sets convergence accuracy of the SCF cycle</span>
<span class="sd">                alone.</span>
<span class="sd">            extrapolation (&quot;PS&quot; | &quot;ASPC&quot;): Method use for extrapolation. If using</span>
<span class="sd">                gamma-point-only calculation, then one should either PS</span>
<span class="sd">                or ASPC (ASPC especially for MD runs). See the manual for other options.</span>
<span class="sd">            subsections (dict): Subsections to initialize with.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eps_default</span> <span class="o">=</span> <span class="n">eps_default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extrapolation</span> <span class="o">=</span> <span class="n">extrapolation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span> <span class="o">=</span> <span class="n">subsections</span> <span class="k">if</span> <span class="n">subsections</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Parameters needed to set up the Quickstep framework&quot;</span>

        <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;METHOD&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;METHOD&quot;</span><span class="p">,</span> <span class="n">method</span><span class="p">),</span>
            <span class="s2">&quot;EPS_DEFAULT&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;EPS_DEFAULT&quot;</span><span class="p">,</span> <span class="n">eps_default</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Base precision level (in Ha)&quot;</span><span class="p">),</span>
            <span class="s2">&quot;EXTRAPOLATION&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;EXTRAPOLATION&quot;</span><span class="p">,</span> <span class="n">extrapolation</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;WFN extrapolation between steps&quot;</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="s2">&quot;QS&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="n">subsections</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Scf"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Scf">[docs]</a><span class="k">class</span> <span class="nc">Scf</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Controls the self consistent field loop</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">max_scf</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
        <span class="n">eps_scf</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span>
        <span class="n">scf_guess</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;RESTART&quot;</span><span class="p">,</span>
        <span class="n">subsections</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the Scf section</span>

<span class="sd">        Args:</span>
<span class="sd">            max_scf (int): Maximum number of SCF loops before terminating. Defaults to 50.</span>
<span class="sd">            eps_scf (float): Convergence criteria for SCF loop. Defaults to 1e-6.</span>
<span class="sd">            scf_guess: Initial guess for SCF loop.</span>
<span class="sd">                &quot;ATOMIC&quot;: Generate an atomic density using the atomic code</span>
<span class="sd">                &quot;CORE&quot;: Diagonalize the core Hamiltonian for an initial guess.</span>
<span class="sd">                &quot;HISTORY_RESTART&quot;: Extrapolated from previous RESTART files.</span>
<span class="sd">                &quot;MOPAC&quot;: Use same guess as MOPAC for semi-empirical methods or a simple</span>
<span class="sd">                    diagonal density matrix for other methods.</span>
<span class="sd">                &quot;NONE&quot;: Skip initial guess (only for NON-SCC DFTB).</span>
<span class="sd">                &quot;RANDOM&quot;: Use random wavefunction coefficients.</span>
<span class="sd">                &quot;RESTART&quot;: Use the RESTART file as an initial guess (and ATOMIC if not present).</span>
<span class="sd">                &quot;SPARSE&quot;: Generate a sparse wavefunction using the atomic code (for OT based</span>
<span class="sd">                    methods).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">max_scf</span> <span class="o">=</span> <span class="n">max_scf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eps_scf</span> <span class="o">=</span> <span class="n">eps_scf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scf_guess</span> <span class="o">=</span> <span class="n">scf_guess</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span> <span class="o">=</span> <span class="n">subsections</span> <span class="k">if</span> <span class="n">subsections</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Parameters needed to perform an SCF run.&quot;</span>

        <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;MAX_SCF&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;MAX_SCF&quot;</span><span class="p">,</span> <span class="n">max_scf</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Max number of steps for an inner SCF loop&quot;</span><span class="p">),</span>
            <span class="s2">&quot;EPS_SCF&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;EPS_SCF&quot;</span><span class="p">,</span> <span class="n">eps_scf</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Convergence threshold for SCF&quot;</span><span class="p">),</span>
            <span class="s2">&quot;SCF_GUESS&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;SCF_GUESS&quot;</span><span class="p">,</span> <span class="n">scf_guess</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;How to initialize the density matrix&quot;</span><span class="p">),</span>
            <span class="s2">&quot;MAX_ITER_LUMO&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span>
                <span class="s2">&quot;MAX_ITER_LUMO&quot;</span><span class="p">,</span>
                <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;max_iter_lumo&quot;</span><span class="p">,</span> <span class="mi">400</span><span class="p">),</span>
                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Iterations for solving for unoccupied levels when running OT&quot;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">}</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="s2">&quot;SCF&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="n">subsections</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Mgrid"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Mgrid">[docs]</a><span class="k">class</span> <span class="nc">Mgrid</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Controls the multigrid for numerical integration</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">cutoff</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1200</span><span class="p">,</span>
        <span class="n">rel_cutoff</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span>
        <span class="n">ngrids</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">progression_factor</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">subsections</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the MGRID section</span>

<span class="sd">        Args:</span>
<span class="sd">            cutoff: Cutoff energy (in Rydbergs for historical reasons) defining how find of</span>
<span class="sd">                Gaussians will be used</span>
<span class="sd">            rel_cutoff: The relative cutoff energy, which defines how to map the Gaussians onto</span>
<span class="sd">                the multigrid. If the the value is too low then, even if you have a high cutoff</span>
<span class="sd">                with sharp Gaussians, they will be mapped to the course part of the multigrid</span>
<span class="sd">            ngrids: number of grids to use</span>
<span class="sd">            progression_factor: divisor that decides how to map Gaussians the multigrid after</span>
<span class="sd">                the highest mapping is decided by rel_cutoff</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">=</span> <span class="n">cutoff</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rel_cutoff</span> <span class="o">=</span> <span class="n">rel_cutoff</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ngrids</span> <span class="o">=</span> <span class="n">ngrids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progression_factor</span> <span class="o">=</span> <span class="n">progression_factor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span> <span class="o">=</span> <span class="n">subsections</span> <span class="k">if</span> <span class="n">subsections</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="n">description</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Multigrid information. Multigrid allows for sharp gaussians and diffuse &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;gaussians to be treated on different grids, where the spacing of FFT integration &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;points can be tailored to the degree of sharpness/diffusiveness&quot;</span>
        <span class="p">)</span>

        <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;CUTOFF&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;CUTOFF&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Cutoff in [Ry] for finest level of the MG.&quot;</span><span class="p">),</span>
            <span class="s2">&quot;REL_CUTOFF&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span>
                <span class="s2">&quot;REL_CUTOFF&quot;</span><span class="p">,</span>
                <span class="n">rel_cutoff</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Controls which gaussians are mapped to which level of the MG&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="s2">&quot;NGRIDS&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;NGRIDS&quot;</span><span class="p">,</span> <span class="n">ngrids</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Number of grid levels in the MG&quot;</span><span class="p">),</span>
            <span class="s2">&quot;PROGRESSION_FACTOR&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;PROGRESSION_FACTOR&quot;</span><span class="p">,</span> <span class="n">progression_factor</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="s2">&quot;MGRID&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="n">subsections</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Diagonalization"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Diagonalization">[docs]</a><span class="k">class</span> <span class="nc">Diagonalization</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Controls diagonalization settings (if using traditional diagonalization).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">eps_adapt</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">eps_iter</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-8</span><span class="p">,</span>
        <span class="n">eps_jacobi</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">jacobi_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span><span class="p">,</span>
        <span class="n">subsections</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the diagronalization section</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">eps_adapt</span> <span class="o">=</span> <span class="n">eps_adapt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eps_iter</span> <span class="o">=</span> <span class="n">eps_iter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eps_jacobi</span> <span class="o">=</span> <span class="n">eps_jacobi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jacobi_threshold</span> <span class="o">=</span> <span class="n">jacobi_threshold</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span> <span class="o">=</span> <span class="n">subsections</span> <span class="k">if</span> <span class="n">subsections</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="s2">&quot;CP2K_INPUT/FORCE_EVAL/DFT/SCF/DIAGONALIZATION&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Settings for the SCF&#39;s diagonalization routines&quot;</span>

        <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;EPS_ADAPT&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;EPS_ADAPT&quot;</span><span class="p">,</span> <span class="n">eps_adapt</span><span class="p">),</span>
            <span class="s2">&quot;EPS_ITER&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;EPS_ITER&quot;</span><span class="p">,</span> <span class="n">eps_iter</span><span class="p">),</span>
            <span class="s2">&quot;EPS_JACOBI&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;EPS_JACOBI&quot;</span><span class="p">,</span> <span class="n">eps_jacobi</span><span class="p">),</span>
            <span class="s2">&quot;JACOBI_THRESHOLD&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;JACOBI_THRESHOLD&quot;</span><span class="p">,</span> <span class="n">jacobi_threshold</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="s2">&quot;DIAGONALIZATION&quot;</span><span class="p">,</span>
            <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
            <span class="n">repeats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">location</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">subsections</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Davidson"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Davidson">[docs]</a><span class="k">class</span> <span class="nc">Davidson</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters for davidson diagonalization</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">new_prec_each</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
        <span class="n">preconditioner</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;FULL_SINGLE_INVERSE&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            new_prec_each (int): How often to recalculate the preconditioner.</span>
<span class="sd">            preconditioner (str): Preconditioner to use.</span>
<span class="sd">                &quot;FULL_ALL&quot;: Most effective state selective preconditioner based on diagonalization,</span>
<span class="sd">                    requires the ENERGY_GAP parameter to be an underestimate of the HOMO-LUMO gap.</span>
<span class="sd">                    This preconditioner is recommended for almost all systems, except very large</span>
<span class="sd">                    systems where make_preconditioner would dominate the total computational cost.</span>
<span class="sd">                &quot;FULL_KINETIC&quot;: Cholesky inversion of S and T, fast construction, robust, use for</span>
<span class="sd">                    very large systems.</span>
<span class="sd">                &quot;FULL_SINGLE&quot;: Based on H-eS diagonalisation, not as good as FULL_ALL, but</span>
<span class="sd">                    somewhat cheaper to apply.</span>
<span class="sd">                &quot;FULL_SINGLE_INVERSE&quot;: Based on H-eS cholesky inversion, similar to FULL_SINGLE</span>
<span class="sd">                    in preconditioning efficiency but cheaper to construct, might be somewhat</span>
<span class="sd">                    less robust. Recommended for large systems.</span>
<span class="sd">                &quot;FULL_S_INVERSE&quot;: Cholesky inversion of S, not as good as FULL_KINETIC,</span>
<span class="sd">                    yet equally expensive.</span>
<span class="sd">                &quot;NONE&quot;: skip preconditioning</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_prec_each</span> <span class="o">=</span> <span class="n">new_prec_each</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preconditioner</span> <span class="o">=</span> <span class="n">preconditioner</span>

        <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;NEW_PREC_EACH&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;NEW_PREC_EACH&quot;</span><span class="p">,</span> <span class="n">new_prec_each</span><span class="p">),</span>
            <span class="s2">&quot;PRECONDITIONER&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;PRECONDITIONER&quot;</span><span class="p">,</span> <span class="n">preconditioner</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="s2">&quot;DAVIDSON&quot;</span><span class="p">,</span>
            <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
            <span class="n">repeats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">location</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="p">{},</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="OrbitalTransformation"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.OrbitalTransformation">[docs]</a><span class="k">class</span> <span class="nc">OrbitalTransformation</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Turns on the Orbital Transformation scheme for diagonalizing the Hamiltonian. Much faster and</span>
<span class="sd">    with guaranteed convergence compared to normal diagonalization, but requires the system</span>
<span class="sd">    to have a band gap.</span>

<span class="sd">    NOTE: OT has poor convergence for metallic systems and cannot use SCF mixing or smearing.</span>
<span class="sd">    Therefore, you should not use it for metals or systems with &#39;small&#39; band gaps. In that</span>
<span class="sd">    case, use normal diagonalization, which will be slower, but will converge properly.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">minimizer</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;CG&quot;</span><span class="p">,</span>
        <span class="n">preconditioner</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;FULL_ALL&quot;</span><span class="p">,</span>
        <span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;STRICT&quot;</span><span class="p">,</span>
        <span class="n">rotation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">occupation_preconditioner</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">energy_gap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">linesearch</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;2PNT&quot;</span><span class="p">,</span>
        <span class="n">subsections</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the OT section</span>

<span class="sd">        Args:</span>
<span class="sd">            minimizer (str): The minimizer to use with the OT method. Default is conjugate gradient</span>
<span class="sd">                method, which is more robust, but more well-behaved systems should use DIIS, which</span>
<span class="sd">                can be as much as 50% faster.</span>
<span class="sd">            preconditioner (str): Preconditioner to use for OT, FULL_ALL tends to be most robust, but is</span>
<span class="sd">                not always most efficient. For difficult systems, FULL_SINGLE_INVERSE can be more robust,</span>
<span class="sd">                and is reasonably efficient with large systems. For huge, but well behaved, systems,</span>
<span class="sd">                where construction of the preconditioner can take a very long time, FULL_KINETIC can be a good</span>
<span class="sd">                choice.</span>
<span class="sd">            energy_gap (float): Guess for the band gap. For FULL_ALL, should be smaller than the actual band gap,</span>
<span class="sd">                so simply using 0.01 is a robust value. Choosing a larger value will help if you start with a bad</span>
<span class="sd">                initial guess though. For FULL_SINGLE_INVERSE, energy_gap is treated as a lower bound. Values lower</span>
<span class="sd">                than 0.05 in this case can lead to stability issues.</span>
<span class="sd">            algorithm (str): What algorithm to use for OT. &#39;Strict&#39;: Taylor or diagonalization based algorithm.</span>
<span class="sd">                IRAC: Orbital Transformation based Iterative Refinement of the Approximative Congruence</span>
<span class="sd">                transformation (OT/IR).</span>
<span class="sd">            linesearch (str): From the manual: 1D line search algorithm to be used with the OT minimizer,</span>
<span class="sd">                in increasing order of robustness and cost. MINIMIZER CG combined with LINESEARCH</span>
<span class="sd">                GOLD should always find an electronic minimum. Whereas the 2PNT minimizer is almost always OK,</span>
<span class="sd">                3PNT might be needed for systems in which successive OT CG steps do not decrease the total energy.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">minimizer</span> <span class="o">=</span> <span class="n">minimizer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preconditioner</span> <span class="o">=</span> <span class="n">preconditioner</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span> <span class="o">=</span> <span class="n">algorithm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">occupation_preconditioner</span> <span class="o">=</span> <span class="n">occupation_preconditioner</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy_gap</span> <span class="o">=</span> <span class="n">energy_gap</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linesearch</span> <span class="o">=</span> <span class="n">linesearch</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span> <span class="o">=</span> <span class="n">subsections</span> <span class="k">if</span> <span class="n">subsections</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="n">description</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Sets the various options for the orbital transformation (OT) method. &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;Default settings already provide an efficient, yet robust method. Most &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;systems benefit from using the FULL_ALL preconditioner combined with a small &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;value (0.001) of ENERGY_GAP. Well-behaved systems might benefit from using &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;a DIIS minimizer. Advantages: It&#39;s fast, because no expensive diagonalization&quot;</span>
            <span class="o">+</span> <span class="s2">&quot;is performed. If preconditioned correctly, method guaranteed to find minimum. &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;Disadvantages: Sensitive to preconditioning. A good preconditioner can be &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;expensive. No smearing, or advanced SCF mixing possible: POOR convergence for &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;metallic systems.&quot;</span>
        <span class="p">)</span>

        <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;MINIMIZER&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;MINIMIZER&quot;</span><span class="p">,</span> <span class="n">minimizer</span><span class="p">),</span>
            <span class="s2">&quot;PRECONDITIONER&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;PRECONDITIONER&quot;</span><span class="p">,</span> <span class="n">preconditioner</span><span class="p">),</span>
            <span class="s2">&quot;ENERGY_GAP&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;ENERGY_GAP&quot;</span><span class="p">,</span> <span class="n">energy_gap</span><span class="p">),</span>
            <span class="s2">&quot;ALGORITHM&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;ALGORITHM&quot;</span><span class="p">,</span> <span class="n">algorithm</span><span class="p">),</span>
            <span class="s2">&quot;LINESEARCH&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;LINESEARCH&quot;</span><span class="p">,</span> <span class="n">linesearch</span><span class="p">),</span>
            <span class="s2">&quot;ROTATION&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;ROTATION&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="p">),</span>
            <span class="s2">&quot;OCCUPATION_PRECONDITIONER&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;OCCUPATION_PRECONDITIONER&quot;</span><span class="p">,</span> <span class="n">occupation_preconditioner</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="s2">&quot;OT&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">subsections</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Cell"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Cell">[docs]</a><span class="k">class</span> <span class="nc">Cell</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Defines the simulation cell (lattice)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lattice</span><span class="p">:</span> <span class="n">Lattice</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the cell section.</span>

<span class="sd">        Args:</span>
<span class="sd">            lattice: pymatgen lattice object</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span> <span class="o">=</span> <span class="n">lattice</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Lattice parameters and optional settings for creating a the CELL&quot;</span>

        <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
            <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
            <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
        <span class="p">}</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;CELL&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span> <span class="n">subsections</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Kind"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Kind">[docs]</a><span class="k">class</span> <span class="nc">Kind</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specifies the information for the different atom types being simulated.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">specie</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">magnetization</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">subsections</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">basis_set</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;GTH_BASIS&quot;</span><span class="p">,</span>
        <span class="n">potential</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;GTH_POTENTIALS&quot;</span><span class="p">,</span>
        <span class="n">ghost</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">aux_basis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a KIND section</span>

<span class="sd">        Args:</span>
<span class="sd">            specie (Species or Element): Object representing the atom.</span>
<span class="sd">            alias (str): Alias for the atom, can be used for specifying modifications</span>
<span class="sd">                to certain atoms but not all, e.g. Mg_1 and Mg_2 to force difference</span>
<span class="sd">                oxidation states on the two atoms.</span>
<span class="sd">            magnetization (float): From the CP2K Manual: The magnetization used</span>
<span class="sd">                in the atomic initial guess. Adds magnetization/2 spin-alpha</span>
<span class="sd">                electrons and removes magnetization/2 spin-beta electrons.</span>
<span class="sd">            basis_set (str): Basis set for this atom, accessible from the</span>
<span class="sd">                basis set file specified</span>
<span class="sd">            potential (str): Pseudopotential for this atom, accessible from the</span>
<span class="sd">                potential file</span>
<span class="sd">            kwargs: Additional kwargs to pass to Section()</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;KIND&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specie</span> <span class="o">=</span> <span class="n">specie</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alias</span> <span class="o">=</span> <span class="n">alias</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">magnetization</span> <span class="o">=</span> <span class="n">magnetization</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span> <span class="o">=</span> <span class="n">subsections</span> <span class="k">if</span> <span class="n">subsections</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">basis_set</span> <span class="o">=</span> <span class="n">basis_set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">potential</span> <span class="o">=</span> <span class="n">potential</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ghost</span> <span class="o">=</span> <span class="n">ghost</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aux_basis</span> <span class="o">=</span> <span class="n">aux_basis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;The description of this kind of atom including basis sets, element, etc.&quot;</span>

        <span class="c1"># Special case for closed-shell elements. Cannot impose magnetization in cp2k.</span>
        <span class="k">if</span> <span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)</span><span class="o">.</span><span class="n">Z</span> <span class="ow">in</span> <span class="p">{</span>
            <span class="mi">2</span><span class="p">,</span>
            <span class="mi">4</span><span class="p">,</span>
            <span class="mi">10</span><span class="p">,</span>
            <span class="mi">12</span><span class="p">,</span>
            <span class="mi">18</span><span class="p">,</span>
            <span class="mi">20</span><span class="p">,</span>
            <span class="mi">30</span><span class="p">,</span>
            <span class="mi">36</span><span class="p">,</span>
            <span class="mi">38</span><span class="p">,</span>
            <span class="mi">48</span><span class="p">,</span>
            <span class="mi">54</span><span class="p">,</span>
            <span class="mi">56</span><span class="p">,</span>
            <span class="mi">70</span><span class="p">,</span>
            <span class="mi">80</span><span class="p">,</span>
            <span class="mi">86</span><span class="p">,</span>
            <span class="mi">88</span><span class="p">,</span>
            <span class="mi">102</span><span class="p">,</span>
            <span class="mi">112</span><span class="p">,</span>
            <span class="mi">118</span><span class="p">,</span>
        <span class="p">}:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">magnetization</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;ELEMENT&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;ELEMENT&quot;</span><span class="p">,</span> <span class="n">specie</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()),</span>
            <span class="s2">&quot;MAGNETIZATION&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;MAGNETIZATION&quot;</span><span class="p">,</span> <span class="n">magnetization</span><span class="p">),</span>
            <span class="s2">&quot;BASIS_SET&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;BASIS_SET&quot;</span><span class="p">,</span> <span class="n">basis_set</span><span class="p">),</span>
            <span class="s2">&quot;POTENTIAL&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;POTENTIAL&quot;</span><span class="p">,</span> <span class="n">potential</span><span class="p">),</span>
            <span class="s2">&quot;GHOST&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;GHOST&quot;</span><span class="p">,</span> <span class="n">ghost</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">aux_basis</span><span class="p">:</span>
            <span class="n">keywords</span><span class="p">[</span><span class="s2">&quot;BASIS_SET&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;BASIS_SET&quot;</span><span class="p">,</span> <span class="s2">&quot;AUX_FIT&quot;</span><span class="p">,</span> <span class="n">aux_basis</span><span class="p">)</span>

        <span class="n">kind_name</span> <span class="o">=</span> <span class="n">alias</span> <span class="k">if</span> <span class="n">alias</span> <span class="k">else</span> <span class="n">specie</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alias</span> <span class="o">=</span> <span class="n">kind_name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span> <span class="o">=</span> <span class="p">[</span><span class="n">kind_name</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="s2">&quot;FORCE_EVAL/SUBSYS/KIND&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repeats</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">subsections</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
            <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
            <span class="n">section_parameters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span><span class="p">,</span>
            <span class="n">alias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alias</span><span class="p">,</span>
            <span class="n">location</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span>
            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="DftPlusU"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.DftPlusU">[docs]</a><span class="k">class</span> <span class="nc">DftPlusU</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Controls DFT+U for an atom kind</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">eps_u_ramping</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span>
        <span class="n">init_u_ramping_each_scf</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">l</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">u_minus_j</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">u_ramping</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the DftPlusU section.</span>

<span class="sd">        Args:</span>
<span class="sd">            eps_u_ramping: (float) SCF convergence threshold at which to start ramping the U value</span>
<span class="sd">            init_u_ramping_each_scf: (bool) Whether or not to do u_ramping each scf cycle</span>
<span class="sd">            l: (int) angular moment of the orbital to apply the +U correction</span>
<span class="sd">            u_minus_j: (float) the effective U parameter, Ueff = U-J</span>
<span class="sd">            u_ramping: (float) stepwise amount to increase during ramping until u_minus_j is reached</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;DFT_PLUS_U&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eps_u_ramping</span> <span class="o">=</span> <span class="mf">1e-5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_u_ramping_each_scf</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span> <span class="o">=</span> <span class="n">l</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u_minus_j</span> <span class="o">=</span> <span class="n">u_minus_j</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u_ramping</span> <span class="o">=</span> <span class="n">u_ramping</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Settings for on-site Hubbard +U correction for this atom kind.&quot;</span>

        <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;EPS_U_RAMPING&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;EPS_U_RAMPING&quot;</span><span class="p">,</span> <span class="n">eps_u_ramping</span><span class="p">),</span>
            <span class="s2">&quot;INIT_U_RAMPING_EACH_SCF&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;INIT_U_RAMPING_EACH_SCF&quot;</span><span class="p">,</span> <span class="n">init_u_ramping_each_scf</span><span class="p">),</span>
            <span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">),</span>
            <span class="s2">&quot;U_MINUS_J&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;U_MINUS_J&quot;</span><span class="p">,</span> <span class="n">u_minus_j</span><span class="p">),</span>
            <span class="s2">&quot;U_RAMPING&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;U_RAMPING&quot;</span><span class="p">,</span> <span class="n">u_ramping</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
            <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
            <span class="n">section_parameters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">section_parameters</span><span class="p">,</span>
            <span class="n">alias</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">location</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Coord"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Coord">[docs]</a><span class="k">class</span> <span class="nc">Coord</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specifies the coordinates of the atoms using a pymatgen structure object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">structure</span><span class="p">:</span> <span class="n">Structure</span> <span class="o">|</span> <span class="n">Molecule</span><span class="p">,</span>
        <span class="n">aliases</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">subsections</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            structure: Pymatgen structure object</span>
<span class="sd">            alias (bool): whether or not to identify the sites by Element + number so you can do things like</span>
<span class="sd">                assign unique magnetization do different elements.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="n">structure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aliases</span> <span class="o">=</span> <span class="n">aliases</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span> <span class="o">=</span> <span class="n">subsections</span> <span class="k">if</span> <span class="n">subsections</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="n">description</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;The coordinates for simple systems (like small QM cells) are specified &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;here by default using explicit XYZ coordinates. More complex systems &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;should be given via an external coordinate file in the SUBSYS%TOPOLOGY section.&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">aliases</span><span class="p">:</span>
            <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">KeywordList</span><span class="p">([</span><span class="n">Keyword</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">*</span><span class="n">structure</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">aliases</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">ss</span><span class="p">:</span> <span class="n">KeywordList</span><span class="p">([</span><span class="n">Keyword</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">symbol</span><span class="p">,</span> <span class="o">*</span><span class="n">s</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">structure</span><span class="o">.</span><span class="n">sites</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">symbol</span> <span class="o">==</span> <span class="n">ss</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">structure</span><span class="o">.</span><span class="n">symbol_set</span>
            <span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;COORD&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
            <span class="n">alias</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">subsections</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PDOS"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.PDOS">[docs]</a><span class="k">class</span> <span class="nc">PDOS</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Controls printing of projected density of states onto the different atom KINDS</span>
<span class="sd">    (elemental decomposed DOS).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nlumo</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the PDOS section</span>

<span class="sd">        Args:</span>
<span class="sd">            nlumo: how many unoccupied orbitals to include (-1==ALL)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nlumo</span> <span class="o">=</span> <span class="n">nlumo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Controls printing of the projected density of states&quot;</span>

        <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;NLUMO&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;NLUMO&quot;</span><span class="p">,</span> <span class="n">nlumo</span><span class="p">),</span>
            <span class="s2">&quot;COMPONENTS&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;COMPONENTS&quot;</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;PDOS&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span> <span class="n">subsections</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="LDOS"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.LDOS">[docs]</a><span class="k">class</span> <span class="nc">LDOS</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Controls printing of the LDOS (List-Density of states). i.e. projects onto specific atoms.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the LDOS section</span>

<span class="sd">        Args:</span>
<span class="sd">            index: Index of the atom to project onto</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alias</span> <span class="o">=</span> <span class="n">alias</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Controls printing of the projected density of states decomposed by atom type&quot;</span>

        <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;COMPONENTS&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;COMPONENTS&quot;</span><span class="p">),</span> <span class="s2">&quot;LIST&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;LIST&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">)}</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="s2">&quot;LDOS&quot;</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="p">{},</span>
            <span class="n">alias</span><span class="o">=</span><span class="n">alias</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="V_Hartree_Cube"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.V_Hartree_Cube">[docs]</a><span class="k">class</span> <span class="nc">V_Hartree_Cube</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Controls printing of the hartree potential as a cube file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the V_HARTREE_CUBE section</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span> <span class="k">if</span> <span class="n">keywords</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="n">description</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Controls the printing of a cube file with eletrostatic potential generated by &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;the total density (electrons+ions). It is valid only for QS with GPW formalism. &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;Note that by convention the potential has opposite sign than the expected physical one.&quot;</span>
        <span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="s2">&quot;V_HARTREE_CUBE&quot;</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="p">{},</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="MO_Cubes"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.MO_Cubes">[docs]</a><span class="k">class</span> <span class="nc">MO_Cubes</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Controls printing of the molecular orbital eigenvalues</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">write_cube</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">nhomo</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nlumo</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the MO_CUBES section</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write_cube</span> <span class="o">=</span> <span class="n">write_cube</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nhomo</span> <span class="o">=</span> <span class="n">nhomo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nlumo</span> <span class="o">=</span> <span class="n">nlumo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="n">description</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Controls the printing of a cube file with eletrostatic potential generated by &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;the total density (electrons+ions). It is valid only for QS with GPW formalism. &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;Note that by convention the potential has opposite sign than the expected physical one.&quot;</span>
        <span class="p">)</span>

        <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;WRITE_CUBES&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;WRITE_CUBE&quot;</span><span class="p">,</span> <span class="n">write_cube</span><span class="p">),</span>
            <span class="s2">&quot;NHOMO&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;NHOMO&quot;</span><span class="p">,</span> <span class="n">nhomo</span><span class="p">),</span>
            <span class="s2">&quot;NLUMO&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;NLUMO&quot;</span><span class="p">,</span> <span class="n">nlumo</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="s2">&quot;MO_CUBES&quot;</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="p">{},</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="E_Density_Cube"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.E_Density_Cube">[docs]</a><span class="k">class</span> <span class="nc">E_Density_Cube</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Controls printing of the electron density cube file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the E_DENSITY_CUBE Section</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span> <span class="k">if</span> <span class="n">keywords</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="n">description</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Controls the printing of cube files with the electronic density and, for LSD &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;calculations, the spin density.&quot;</span>
        <span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="s2">&quot;E_DENSITY_CUBE&quot;</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="p">{},</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Smear"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Smear">[docs]</a><span class="k">class</span> <span class="nc">Smear</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Control electron smearing</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">elec_temp</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;FERMI_DIRAC&quot;</span><span class="p">,</span>
        <span class="n">fixed_magnetic_moment</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1e2</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the SMEAR section</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">elec_temp</span> <span class="o">=</span> <span class="n">elec_temp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fixed_magnetic_moment</span> <span class="o">=</span> <span class="n">fixed_magnetic_moment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Activates smearing of electron occupations&quot;</span>

        <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;ELEC_TEMP&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;ELEC_TEMP&quot;</span><span class="p">,</span> <span class="n">elec_temp</span><span class="p">),</span>
            <span class="s2">&quot;METHOD&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;METHOD&quot;</span><span class="p">,</span> <span class="n">method</span><span class="p">),</span>
            <span class="s2">&quot;FIXED_MAGNETIC_MOMENT&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;FIXED_MAGNETIC_MOMENT&quot;</span><span class="p">,</span> <span class="n">fixed_magnetic_moment</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="s2">&quot;SMEAR&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="p">{},</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="BrokenSymmetry"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.BrokenSymmetry">[docs]</a><span class="k">class</span> <span class="nc">BrokenSymmetry</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Define the required atomic orbital occupation assigned in initialization</span>
<span class="sd">    of the density matrix, by adding or subtracting electrons from specific</span>
<span class="sd">    angular momentum channels. It works only with GUESS ATOMIC.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">l_alpha</span><span class="p">:</span> <span class="n">Sequence</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,),</span>
        <span class="n">n_alpha</span><span class="p">:</span> <span class="n">Sequence</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,),</span>
        <span class="n">nel_alpha</span><span class="p">:</span> <span class="n">Sequence</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,),</span>
        <span class="n">l_beta</span><span class="p">:</span> <span class="n">Sequence</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,),</span>
        <span class="n">n_beta</span><span class="p">:</span> <span class="n">Sequence</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,),</span>
        <span class="n">nel_beta</span><span class="p">:</span> <span class="n">Sequence</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,),</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the broken symmetry section</span>

<span class="sd">        Args:</span>
<span class="sd">            l_alpha: Angular momentum quantum number of the orbitals whose occupation is changed</span>
<span class="sd">            n_alpha: Principal quantum number of the orbitals whose occupation is changed.</span>
<span class="sd">                Default is the first not occupied</span>
<span class="sd">            nel_alpha: Orbital occupation change per angular momentum quantum number. In</span>
<span class="sd">                unrestricted calculations applied to spin alpha</span>
<span class="sd">            l_beta: Same as L_alpha for beta channel</span>
<span class="sd">            n_beta: Same as N_alpha for beta channel</span>
<span class="sd">            nel_beta: Same as NEL_alpha for beta channel</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">l_alpha</span> <span class="o">=</span> <span class="n">l_alpha</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_alpha</span> <span class="o">=</span> <span class="n">n_alpha</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nel_alpha</span> <span class="o">=</span> <span class="n">nel_alpha</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l_beta</span> <span class="o">=</span> <span class="n">l_beta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_beta</span> <span class="o">=</span> <span class="n">n_beta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nel_beta</span> <span class="o">=</span> <span class="n">nel_beta</span>

        <span class="n">description</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Define the required atomic orbital occupation assigned in initialization &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;of the density matrix, by adding or subtracting electrons from specific &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;angular momentum channels. It works only with GUESS ATOMIC&quot;</span>
        <span class="p">)</span>

        <span class="n">keywords_alpha</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">l_alpha</span><span class="p">)),</span>
            <span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">n_alpha</span><span class="p">)),</span>
            <span class="s2">&quot;NEL&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;NEL&quot;</span><span class="p">,</span> <span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">nel_alpha</span><span class="p">)),</span>
        <span class="p">}</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">Section</span><span class="p">(</span><span class="s2">&quot;ALPHA&quot;</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="n">keywords_alpha</span><span class="p">,</span> <span class="n">subsections</span><span class="o">=</span><span class="p">{},</span> <span class="n">repeats</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">keywords_beta</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">l_beta</span><span class="p">)),</span>
            <span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">n_beta</span><span class="p">)),</span>
            <span class="s2">&quot;NEL&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;NEL&quot;</span><span class="p">,</span> <span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">nel_beta</span><span class="p">)),</span>
        <span class="p">}</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="n">Section</span><span class="p">(</span><span class="s2">&quot;BETA&quot;</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="n">keywords_beta</span><span class="p">,</span> <span class="n">subsections</span><span class="o">=</span><span class="p">{},</span> <span class="n">repeats</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="s2">&quot;BS&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ALPHA&quot;</span><span class="p">:</span> <span class="n">alpha</span><span class="p">,</span> <span class="s2">&quot;BETA&quot;</span><span class="p">:</span> <span class="n">beta</span><span class="p">},</span>
            <span class="n">keywords</span><span class="o">=</span><span class="p">{},</span>
            <span class="n">repeats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="BrokenSymmetry.from_el"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.BrokenSymmetry.from_el">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_el</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">el</span><span class="p">,</span> <span class="n">oxi_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create section from element, oxidation state, and spin.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">el</span> <span class="o">=</span> <span class="n">el</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="n">Element</span><span class="p">)</span> <span class="k">else</span> <span class="n">Element</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;p&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">f2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">14</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">f3</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">14</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="n">es</span> <span class="o">=</span> <span class="n">el</span><span class="o">.</span><span class="n">electronic_structure</span>
        <span class="n">esv</span> <span class="o">=</span> <span class="p">[(</span><span class="nb">int</span><span class="p">(</span><span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">f</span><span class="p">(</span><span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">_</span><span class="p">[</span><span class="mi">2</span><span class="p">:]))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">es</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="s2">&quot;[&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_</span><span class="p">]</span>
        <span class="n">esv</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">tmp</span> <span class="o">=</span> <span class="n">oxi_state</span>
        <span class="n">l_alpha</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">l_beta</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">nel_alpha</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">nel_beta</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n_alpha</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n_beta</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">unpaired_orbital</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">while</span> <span class="n">tmp</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tmp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">tmp2</span> <span class="o">=</span> <span class="o">-</span><span class="nb">min</span><span class="p">((</span><span class="n">esv</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">tmp</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tmp2</span> <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="n">f2</span><span class="p">(</span><span class="n">esv</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">esv</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="o">-</span><span class="n">tmp</span><span class="p">))</span>
            <span class="n">l_alpha</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">esv</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">l_beta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">esv</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">nel_alpha</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp2</span><span class="p">)</span>
            <span class="n">nel_beta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp2</span><span class="p">)</span>
            <span class="n">n_alpha</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">esv</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">n_beta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">esv</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">tmp</span> <span class="o">+=</span> <span class="n">tmp2</span>
            <span class="n">unpaired_orbital</span> <span class="o">=</span> <span class="n">esv</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">esv</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">esv</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">tmp2</span>
            <span class="n">esv</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;low-up&quot;</span><span class="p">:</span>
            <span class="n">spin</span> <span class="o">=</span> <span class="n">unpaired_orbital</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;low-down&quot;</span><span class="p">:</span>
            <span class="n">spin</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">unpaired_orbital</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;high-up&quot;</span><span class="p">:</span>
            <span class="n">spin</span> <span class="o">=</span> <span class="n">unpaired_orbital</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">%</span> <span class="p">(</span><span class="n">f2</span><span class="p">(</span><span class="n">unpaired_orbital</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">spin</span> <span class="o">==</span> <span class="s2">&quot;high-down&quot;</span><span class="p">:</span>
            <span class="n">spin</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">unpaired_orbital</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">%</span> <span class="p">(</span><span class="n">f2</span><span class="p">(</span><span class="n">unpaired_orbital</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">//</span> <span class="mi">2</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">spin</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nel_alpha</span><span class="p">))):</span>
                <span class="n">nel_alpha</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">min</span><span class="p">((</span><span class="n">spin</span><span class="p">,</span> <span class="n">f3</span><span class="p">(</span><span class="n">l_alpha</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">oxi_state</span><span class="p">))</span>
                <span class="n">nel_beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="nb">min</span><span class="p">((</span><span class="n">spin</span><span class="p">,</span> <span class="n">f3</span><span class="p">(</span><span class="n">l_beta</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">oxi_state</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">spin</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">spin</span> <span class="o">-=</span> <span class="nb">min</span><span class="p">((</span><span class="n">spin</span><span class="p">,</span> <span class="n">f3</span><span class="p">(</span><span class="n">l_alpha</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">oxi_state</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">spin</span> <span class="o">+=</span> <span class="nb">min</span><span class="p">((</span><span class="n">spin</span><span class="p">,</span> <span class="n">f3</span><span class="p">(</span><span class="n">l_beta</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">oxi_state</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">BrokenSymmetry</span><span class="p">(</span>
            <span class="n">l_alpha</span><span class="o">=</span><span class="n">l_alpha</span><span class="p">,</span>
            <span class="n">l_beta</span><span class="o">=</span><span class="n">l_beta</span><span class="p">,</span>
            <span class="n">nel_alpha</span><span class="o">=</span><span class="n">nel_alpha</span><span class="p">,</span>
            <span class="n">nel_beta</span><span class="o">=</span><span class="n">nel_beta</span><span class="p">,</span>
            <span class="n">n_beta</span><span class="o">=</span><span class="n">n_beta</span><span class="p">,</span>
            <span class="n">n_alpha</span><span class="o">=</span><span class="n">n_alpha</span><span class="p">,</span>
        <span class="p">)</span></div></div>


<div class="viewcode-block" id="Xc_Functional"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Xc_Functional">[docs]</a><span class="k">class</span> <span class="nc">Xc_Functional</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Defines the XC functional(s) to use.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">functionals</span><span class="p">:</span> <span class="n">Iterable</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">subsections</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the XC_FUNCTIONAL class</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">functionals</span> <span class="o">=</span> <span class="n">functionals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span> <span class="o">=</span> <span class="n">subsections</span> <span class="k">if</span> <span class="n">subsections</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="n">location</span> <span class="o">=</span> <span class="s2">&quot;CP2K_INPUT/FORCE_EVAL/DFT/XC/XC_FUNCTIONAL&quot;</span>

        <span class="k">for</span> <span class="n">functional</span> <span class="ow">in</span> <span class="n">functionals</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">subsections</span><span class="p">[</span><span class="n">functional</span><span class="p">]</span> <span class="o">=</span> <span class="n">Section</span><span class="p">(</span><span class="n">functional</span><span class="p">,</span> <span class="n">subsections</span><span class="o">=</span><span class="p">{},</span> <span class="n">repeats</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="s2">&quot;XC_FUNCTIONAL&quot;</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">subsections</span><span class="p">,</span>
            <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span>
            <span class="n">repeats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PBE"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.PBE">[docs]</a><span class="k">class</span> <span class="nc">PBE</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Info about the PBE functional.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">parameterization</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ORIG&quot;</span><span class="p">,</span>
        <span class="n">scale_c</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">scale_x</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            parameterization (str):</span>
<span class="sd">                ORIG: original PBE</span>
<span class="sd">                PBESOL: PBE for solids/surfaces</span>
<span class="sd">                REVPBE: revised PBE</span>
<span class="sd">            scale_c (float): scales the correlation part of the functional.</span>
<span class="sd">            scale_x (float): scales the exchange part of the functional.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">parameterization</span> <span class="o">=</span> <span class="n">parameterization</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_c</span> <span class="o">=</span> <span class="n">scale_c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_x</span> <span class="o">=</span> <span class="n">scale_x</span>

        <span class="n">location</span> <span class="o">=</span> <span class="s2">&quot;CP2K_INPUT/FORCE_EVAL/DFT/XC/XC_FUNCTIONAL/PBE&quot;</span>

        <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;PARAMETRIZATION&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;PARAMETRIZATION&quot;</span><span class="p">,</span> <span class="n">parameterization</span><span class="p">),</span>
            <span class="s2">&quot;SCALE_C&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;SCALE_C&quot;</span><span class="p">,</span> <span class="n">scale_c</span><span class="p">),</span>
            <span class="s2">&quot;SCALE_X&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;SCALE_X&quot;</span><span class="p">,</span> <span class="n">scale_x</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="s2">&quot;PBE&quot;</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="p">{},</span>
            <span class="n">repeats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span>
            <span class="n">section_parameters</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Kpoints"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Kpoints">[docs]</a><span class="k">class</span> <span class="nc">Kpoints</span><span class="p">(</span><span class="n">Section</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description of the k-points to use for the calculation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">kpts</span><span class="p">:</span> <span class="n">Sequence</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span>
        <span class="n">weights</span><span class="p">:</span> <span class="n">Sequence</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">eps_geo</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span>
        <span class="n">full_grid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">parallel_group_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;MONKHORST-PACK&quot;</span><span class="p">,</span>
        <span class="n">symmetry</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">units</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;B_VECTOR&quot;</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">wavefunctions</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;COMPLEX&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            kpts (list, tuple): a 2D array for the kpoints of the form</span>
<span class="sd">                [(1,1,1),]. If len(kpts) == 1. Then it is taken as subdivisions</span>
<span class="sd">                for automatic kpoint scheme. If it has more entries, it is</span>
<span class="sd">                taken as manual entries for kpoints.</span>
<span class="sd">            weights (list, tuple): a weight for each kpoint. Default is to</span>
<span class="sd">                weigh each by 1</span>
<span class="sd">            eps_geo (float): tolerance for symmetry. Default=1e-6</span>
<span class="sd">            full_grid (bool): use full (not reduced) kpoint grid. Default=False.</span>
<span class="sd">            parallel_group_size (int): from cp2k manual: Number of processors</span>
<span class="sd">                to be used for a single kpoint. This number must divide the</span>
<span class="sd">                total number of processes. The number of groups must divide</span>
<span class="sd">                the total number of kpoints. Value=-1 (smallest possible</span>
<span class="sd">                number of processes per group, satisfying the constraints).</span>
<span class="sd">                Value=0 (all processes). Value=n (exactly n processes).</span>
<span class="sd">                Default=-1.</span>
<span class="sd">            scheme (str): kpoint generation scheme. Default=&#39;Monkhorst-Pack&#39;</span>
<span class="sd">            symmetry (bool): Use symmetry to reduce the number of kpoints.</span>
<span class="sd">                Default=False.</span>
<span class="sd">            units (str): Units for the kpoint coordinates (reciprocal coordinates</span>
<span class="sd">                or cartesian). Default=&#39;B_VECTOR&#39; (reciprocal)</span>
<span class="sd">            verbose (bool): verbose output for kpoints. Default=False</span>
<span class="sd">            wavefunctions (str): Whether to use complex or real valued wavefunctions</span>
<span class="sd">                (if available). Default=&#39;complex&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Sets up the kpoints&quot;</span>
        <span class="n">keywords</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">kpts</span> <span class="o">=</span> <span class="n">kpts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span> <span class="k">if</span> <span class="n">weights</span> <span class="k">else</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kpts</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eps_geo</span> <span class="o">=</span> <span class="n">eps_geo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">full_grid</span> <span class="o">=</span> <span class="n">full_grid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parallel_group_size</span> <span class="o">=</span> <span class="n">parallel_group_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scheme</span> <span class="o">=</span> <span class="n">scheme</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symmetry</span> <span class="o">=</span> <span class="n">symmetry</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wavefunctions</span> <span class="o">=</span> <span class="n">wavefunctions</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">keywords</span><span class="p">[</span><span class="s2">&quot;SCHEME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;SCHEME&quot;</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="o">*</span><span class="n">kpts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">keywords</span><span class="p">[</span><span class="s2">&quot;KPOINT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeywordList</span><span class="p">([</span><span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;KPOINT&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">k</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kpts</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">)])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No k-points provided!&quot;</span><span class="p">)</span>

        <span class="n">keywords</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;SCHEME&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;SCHEME&quot;</span><span class="p">,</span> <span class="n">scheme</span><span class="p">),</span>
                <span class="s2">&quot;EPS_GEO&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;EPS_GEO&quot;</span><span class="p">,</span> <span class="n">eps_geo</span><span class="p">),</span>
                <span class="s2">&quot;FULL_GRID&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;FULL_GRID&quot;</span><span class="p">,</span> <span class="n">full_grid</span><span class="p">),</span>
                <span class="s2">&quot;PARALLEL_GROUP_SIZE&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;PARALLEL_GROUP_SIZE&quot;</span><span class="p">,</span> <span class="n">parallel_group_size</span><span class="p">),</span>
                <span class="s2">&quot;SYMMETRY&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;SYMMETRY&quot;</span><span class="p">,</span> <span class="n">symmetry</span><span class="p">),</span>
                <span class="s2">&quot;UNITS&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;UNITS&quot;</span><span class="p">,</span> <span class="n">units</span><span class="p">),</span>
                <span class="s2">&quot;VERBOSE&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;VERBOSE&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="p">),</span>
                <span class="s2">&quot;WAVEFUNCTIONS&quot;</span><span class="p">:</span> <span class="n">Keyword</span><span class="p">(</span><span class="s2">&quot;WAVEFUNCTIONS&quot;</span><span class="p">,</span> <span class="n">wavefunctions</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;KPOINTS&quot;</span><span class="p">,</span>
            <span class="n">subsections</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">repeats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="Kpoints.from_kpoints"><a class="viewcode-back" href="../../../../pymatgen.io.cp2k.inputs.html#pymatgen.io.cp2k.inputs.Kpoints.from_kpoints">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_kpoints</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">kpoints</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reduce</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the section from a Kpoints object (pymatgen.io.vasp.inputs). CP2K</span>
<span class="sd">        does not have an automatic gamma-point constructor, so this is generally used</span>
<span class="sd">        to get the number of divisions from a kpoint static constructor and then</span>
<span class="sd">        build a Monkhorst-Pack grid, which is sufficient for gamma-recommended systems</span>
<span class="sd">        so long as the grid is fine enough.</span>

<span class="sd">        Args:</span>
<span class="sd">            kpoints: A pymatgen kpoints object.</span>
<span class="sd">            structure: Pymatgen structure object. Required for automatically performing</span>
<span class="sd">                symmetry analysis and reducing the kpoint grid.</span>
<span class="sd">            reduce: whether or not to reduce the grid using symmetry. CP2K itself cannot</span>
<span class="sd">                do this automatically without spglib present at execution time.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">kpoints</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span>
        <span class="n">kpoints</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;kpoints&quot;</span><span class="p">]</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;kpts_weights&quot;</span><span class="p">]</span>
        <span class="n">scheme</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;generation_style&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">reduce</span> <span class="ow">and</span> <span class="n">structure</span><span class="p">:</span>
            <span class="n">sga</span> <span class="o">=</span> <span class="n">SpacegroupAnalyzer</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>
            <span class="n">kpoints</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">sga</span><span class="o">.</span><span class="n">get_ir_reciprocal_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">kpoints</span><span class="p">))</span>
            <span class="n">kpoints</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">kpoints</span><span class="p">))</span>
            <span class="n">scheme</span> <span class="o">=</span> <span class="s2">&quot;GENERAL&quot;</span>
        <span class="k">elif</span> <span class="n">scheme</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;monkhorst&quot;</span><span class="p">:</span>
            <span class="n">scheme</span> <span class="o">=</span> <span class="s2">&quot;MONKHORST-PACK&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No automatic constructor for this scheme&quot;</span> <span class="s2">&quot;defaulting to monkhorst-pack grid.&quot;</span><span class="p">)</span>
            <span class="n">scheme</span> <span class="o">=</span> <span class="s2">&quot;MONKHORST-PACK&quot;</span>
        <span class="n">units</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;coord_type&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;coord_type&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;coord_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;reciprocal&quot;</span><span class="p">:</span>
                <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;B_VECTOR&quot;</span>
            <span class="k">elif</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;coord_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;cartesian&quot;</span><span class="p">:</span>
                <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;CART_ANGSTROM&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;B_VECTOR&quot;</span>

        <span class="k">return</span> <span class="n">Kpoints</span><span class="p">(</span><span class="n">kpts</span><span class="o">=</span><span class="n">kpoints</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">)</span></div></div>
</pre></div>

            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">pymatgen 2022.4.19 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pymatgen.io.cp2k.inputs</a></li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2011, Pymatgen Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
<div class="footer">This page uses <a href="http://analytics.google.com/">
Google Analytics</a> to collect statistics. You can disable it by blocking
the JavaScript coming from www.google-analytics.com.
<script type="text/javascript">
  (function() {
    var ga = document.createElement('script');
    ga.src = ('https:' == document.location.protocol ?
              'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
  })();
</script>
</div>

  </body>
</html>