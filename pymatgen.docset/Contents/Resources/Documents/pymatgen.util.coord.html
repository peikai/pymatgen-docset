
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>pymatgen.util.coord module — pymatgen 2022.0.4 documentation</title>
<link href="_static/pygments.css" rel="stylesheet" type="text/css"/>
<link href="_static/basic.css" rel="stylesheet" type="text/css"/>
<script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
<script src="_static/jquery.js"></script>
<script src="_static/underscore.js"></script>
<script src="_static/doctools.js"></script>
<link href="genindex.html" rel="index" title="Index"/>
<link href="search.html" rel="search" title="Search"/>
<link href="pymatgen.util.coord_cython.html" rel="next" title="pymatgen.util.coord_cython module"/>
<link href="pymatgen.util.convergence.html" rel="prev" title="pymatgen.util.convergence module"/>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-33990148-1']);
  _gaq.push(['_trackPageview']);
</script>
</head><body>
<div aria-label="related navigation" class="related" role="navigation">
<h3>Navigation</h3>
<ul>
<li class="right" style="margin-right: 10px">
<a accesskey="I" href="genindex.html" title="General Index">index</a></li>
<li class="right">
<a href="py-modindex.html" title="Python Module Index">modules</a> |</li>
<li class="right">
<a accesskey="N" href="pymatgen.util.coord_cython.html" title="pymatgen.util.coord_cython module">next</a> |</li>
<li class="right">
<a accesskey="P" href="pymatgen.util.convergence.html" title="pymatgen.util.convergence module">previous</a> |</li>
<li class="nav-item nav-item-0"><a href="index.html">pymatgen 2022.0.4 documentation</a> »</li>
<li class="nav-item nav-item-1"><a href="modules.html">pymatgen</a> »</li>
<li class="nav-item nav-item-2"><a href="pymatgen.html">pymatgen namespace</a> »</li>
<li class="nav-item nav-item-3"><a accesskey="U" href="pymatgen.util.html">pymatgen.util package</a> »</li>
<li class="nav-item nav-item-this"><a href="">pymatgen.util.coord module</a></li>
</ul>
</div>
<div class="document">
<div class="documentwrapper">
<div class="body" role="main">
<div class="section" id="module-pymatgen.util.coord">
<span id="pymatgen-util-coord-module"></span><h1><a name="//apple_ref/cpp/Module/pymatgen.util.coord"></a>pymatgen.util.coord module<a class="headerlink" href="#module-pymatgen.util.coord" title="Permalink to this headline">¶</a></h1>
<p>Utilities for manipulating coordinates or list of coordinates, under periodic
boundary conditions or otherwise. Many of these are heavily vectorized in
numpy for performance.</p>
<dl class="py class">
<dt id="pymatgen.util.coord.Simplex"><a name="//apple_ref/cpp/Class/pymatgen.util.coord.Simplex"></a>
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">Simplex</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/util/coord.html#Simplex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.util.coord.Simplex" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A generalized simplex object. See <a class="reference external" href="http://en.wikipedia.org/wiki/Simplex">http://en.wikipedia.org/wiki/Simplex</a>.</p>
<p>Initializes a Simplex from vertex coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>coords</strong> (<em>[</em><em>[</em><em>float</em><em>]</em><em>]</em>) – Coords of the vertices of the simplex. E.g.,
[[1, 2, 3], [2, 4, 5], [6, 7, 8], [8, 9, 10].</p>
</dd>
</dl>
<dl class="py method">
<dt id="pymatgen.util.coord.Simplex.bary_coords"><a name="//apple_ref/cpp/Method/pymatgen.util.coord.Simplex.bary_coords"></a>
<code class="sig-name descname"><span class="pre">bary_coords</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/util/coord.html#Simplex.bary_coords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.util.coord.Simplex.bary_coords" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>(</strong><strong>)</strong> (<em>point</em>) – Point coordinates.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Barycentric coordinations.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="pymatgen.util.coord.Simplex.coords"><a name="//apple_ref/cpp/Method/pymatgen.util.coord.Simplex.coords"></a>
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">coords</span></code><a class="headerlink" href="#pymatgen.util.coord.Simplex.coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of the vertex coordinates in the simplex.</p>
</dd></dl>
<dl class="py method">
<dt id="pymatgen.util.coord.Simplex.in_simplex"><a name="//apple_ref/cpp/Method/pymatgen.util.coord.Simplex.in_simplex"></a>
<code class="sig-name descname"><span class="pre">in_simplex</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/util/coord.html#Simplex.in_simplex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.util.coord.Simplex.in_simplex" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if a point is in the simplex using the standard barycentric
coordinate system algorithm.</p>
<p>Taking an arbitrary vertex as an origin, we compute the basis for the
simplex from this origin by subtracting all other vertices from the
origin. We then project the point into this coordinate system and
determine the linear decomposition coefficients in this coordinate
system.  If the coeffs satisfy that all coeffs &gt;= 0, the composition
is in the facet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point</strong> (<em>[</em><em>float</em><em>]</em>) – Point to test</p></li>
<li><p><strong>tolerance</strong> (<em>float</em>) – Tolerance to test if point is in simplex.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="pymatgen.util.coord.Simplex.line_intersection"><a name="//apple_ref/cpp/Method/pymatgen.util.coord.Simplex.line_intersection"></a>
<code class="sig-name descname"><span class="pre">line_intersection</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/util/coord.html#Simplex.line_intersection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.util.coord.Simplex.line_intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the intersection points of a line with a simplex
:param point1: Points that determine the line
:type point1: [float]
:param point2: Points that determine the line
:type point2: [float]</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>points where the line intersects the simplex (0, 1, or 2)</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="pymatgen.util.coord.Simplex.point_from_bary_coords"><a name="//apple_ref/cpp/Method/pymatgen.util.coord.Simplex.point_from_bary_coords"></a>
<code class="sig-name descname"><span class="pre">point_from_bary_coords</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bary_coords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/util/coord.html#Simplex.point_from_bary_coords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.util.coord.Simplex.point_from_bary_coords" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>(</strong><strong>)</strong> (<em>bary_coords</em>) – Barycentric coordinates</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Point coordinates</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="pymatgen.util.coord.Simplex.volume"><a name="//apple_ref/cpp/Method/pymatgen.util.coord.Simplex.volume"></a>
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">volume</span></code><a class="headerlink" href="#pymatgen.util.coord.Simplex.volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Volume of the simplex.</p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt id="pymatgen.util.coord.all_distances"><a name="//apple_ref/cpp/Function/pymatgen.util.coord.all_distances"></a>
<code class="sig-name descname"><span class="pre">all_distances</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/util/coord.html#all_distances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.util.coord.all_distances" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the distances between two lists of coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords1</strong> – First set of cartesian coordinates.</p></li>
<li><p><strong>coords2</strong> – Second set of cartesian coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>2d array of cartesian distances. E.g the distance between
coords1[i] and coords2[j] is distances[i,j]</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pymatgen.util.coord.barycentric_coords"><a name="//apple_ref/cpp/Function/pymatgen.util.coord.barycentric_coords"></a>
<code class="sig-name descname"><span class="pre">barycentric_coords</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplex</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/util/coord.html#barycentric_coords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.util.coord.barycentric_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a list of coordinates to barycentric coordinates, given a
simplex with d+1 points. Only works for d &gt;= 2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> – list of n coords to transform, shape should be (n,d)</p></li>
<li><p><strong>simplex</strong> – list of coordinates that form the simplex, shape should be
(d+1, d)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a LIST of barycentric coordinates (even if the original input was 1d)</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pymatgen.util.coord.coord_list_mapping"><a name="//apple_ref/cpp/Function/pymatgen.util.coord.coord_list_mapping"></a>
<code class="sig-name descname"><span class="pre">coord_list_mapping</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">superset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/util/coord.html#coord_list_mapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.util.coord.coord_list_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the index mapping from a subset to a superset.
Subset and superset cannot contain duplicate rows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subset</strong> – List of coords</p></li>
<li><p><strong>superset</strong> – List of coords</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of indices such that superset[indices] = subset</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pymatgen.util.coord.coord_list_mapping_pbc"><a name="//apple_ref/cpp/Function/pymatgen.util.coord.coord_list_mapping_pbc"></a>
<code class="sig-name descname"><span class="pre">coord_list_mapping_pbc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">superset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/util/coord.html#coord_list_mapping_pbc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.util.coord.coord_list_mapping_pbc" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the index mapping from a subset to a superset.
Superset cannot contain duplicate matching rows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subset</strong> – List of frac_coords</p></li>
<li><p><strong>superset</strong> – List of frac_coords</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of indices such that superset[indices] = subset</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pymatgen.util.coord.find_in_coord_list"><a name="//apple_ref/cpp/Function/pymatgen.util.coord.find_in_coord_list"></a>
<code class="sig-name descname"><span class="pre">find_in_coord_list</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coord_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/util/coord.html#find_in_coord_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.util.coord.find_in_coord_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the indices of matches of a particular coord in a coord_list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coord_list</strong> – List of coords to test</p></li>
<li><p><strong>coord</strong> – Specific coordinates</p></li>
<li><p><strong>atol</strong> – Absolute tolerance. Defaults to 1e-8. Accepts both scalar and
array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Indices of matches, e.g., [0, 1, 2, 3]. Empty list if not found.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pymatgen.util.coord.find_in_coord_list_pbc"><a name="//apple_ref/cpp/Function/pymatgen.util.coord.find_in_coord_list_pbc"></a>
<code class="sig-name descname"><span class="pre">find_in_coord_list_pbc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcoord_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcoord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/util/coord.html#find_in_coord_list_pbc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.util.coord.find_in_coord_list_pbc" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the indices of all points in a fractional coord list that are
equal to a fractional coord (with a tolerance), taking into account
periodic boundary conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fcoord_list</strong> – List of fractional coords</p></li>
<li><p><strong>fcoord</strong> – A specific fractional coord to test.</p></li>
<li><p><strong>atol</strong> – Absolute tolerance. Defaults to 1e-8.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Indices of matches, e.g., [0, 1, 2, 3]. Empty list if not found.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pymatgen.util.coord.get_angle"><a name="//apple_ref/cpp/Function/pymatgen.util.coord.get_angle"></a>
<code class="sig-name descname"><span class="pre">get_angle</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'degrees'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/util/coord.html#get_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.util.coord.get_angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the angle between two vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v1</strong> – Vector 1</p></li>
<li><p><strong>v2</strong> – Vector 2</p></li>
<li><p><strong>units</strong> – “degrees” or “radians”. Defaults to “degrees”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Angle between them in degrees.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pymatgen.util.coord.get_linear_interpolated_value"><a name="//apple_ref/cpp/Function/pymatgen.util.coord.get_linear_interpolated_value"></a>
<code class="sig-name descname"><span class="pre">get_linear_interpolated_value</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/util/coord.html#get_linear_interpolated_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.util.coord.get_linear_interpolated_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an interpolated value by linear interpolation between two values.
This method is written to avoid dependency on scipy, which causes issues on
threading servers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_values</strong> – Sequence of x values.</p></li>
<li><p><strong>y_values</strong> – Corresponding sequence of y values</p></li>
<li><p><strong>x</strong> – Get value at particular x</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value at x.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pymatgen.util.coord.in_coord_list"><a name="//apple_ref/cpp/Function/pymatgen.util.coord.in_coord_list"></a>
<code class="sig-name descname"><span class="pre">in_coord_list</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coord_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/util/coord.html#in_coord_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.util.coord.in_coord_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests if a particular coord is within a coord_list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coord_list</strong> – List of coords to test</p></li>
<li><p><strong>coord</strong> – Specific coordinates</p></li>
<li><p><strong>atol</strong> – Absolute tolerance. Defaults to 1e-8. Accepts both scalar and
array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if coord is in the coord list.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pymatgen.util.coord.in_coord_list_pbc"><a name="//apple_ref/cpp/Function/pymatgen.util.coord.in_coord_list_pbc"></a>
<code class="sig-name descname"><span class="pre">in_coord_list_pbc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcoord_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcoord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/util/coord.html#in_coord_list_pbc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.util.coord.in_coord_list_pbc" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests if a particular fractional coord is within a fractional coord_list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fcoord_list</strong> – List of fractional coords to test</p></li>
<li><p><strong>fcoord</strong> – A specific fractional coord to test.</p></li>
<li><p><strong>atol</strong> – Absolute tolerance. Defaults to 1e-8.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if coord is in the coord list.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pymatgen.util.coord.is_coord_subset"><a name="//apple_ref/cpp/Function/pymatgen.util.coord.is_coord_subset"></a>
<code class="sig-name descname"><span class="pre">is_coord_subset</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">superset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/util/coord.html#is_coord_subset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.util.coord.is_coord_subset" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests if all coords in subset are contained in superset.
Doesn’t use periodic boundary conditions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subset</strong> – List of coords</p></li>
<li><p><strong>superset</strong> – List of coords</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if all of subset is in superset.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pymatgen.util.coord.is_coord_subset_pbc"><a name="//apple_ref/cpp/Function/pymatgen.util.coord.is_coord_subset_pbc"></a>
<code class="sig-name descname"><span class="pre">is_coord_subset_pbc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">superset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/util/coord.html#is_coord_subset_pbc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.util.coord.is_coord_subset_pbc" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests if all fractional coords in subset are contained in superset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subset</strong> – List of fractional coords</p></li>
<li><p><strong>superset</strong> – List of fractional coords</p></li>
<li><p><strong>atol</strong> (<em>float</em><em> or </em><em>size 3 array</em>) – Tolerance for matching</p></li>
<li><p><strong>mask</strong> (<em>boolean array</em>) – Mask of matches that are not allowed.
i.e. if mask[1,2] == True, then subset[1] cannot be matched
to superset[2]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if all of subset is in superset.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pymatgen.util.coord.lattice_points_in_supercell"><a name="//apple_ref/cpp/Function/pymatgen.util.coord.lattice_points_in_supercell"></a>
<code class="sig-name descname"><span class="pre">lattice_points_in_supercell</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">supercell_matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/util/coord.html#lattice_points_in_supercell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.util.coord.lattice_points_in_supercell" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of points on the original lattice contained in the
supercell in fractional coordinates (with the supercell basis).
e.g. [[2,0,0],[0,1,0],[0,0,1]] returns [[0,0,0],[0.5,0,0]]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>supercell_matrix</strong> – 3x3 matrix describing the supercell</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numpy array of the fractional coordinates</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pymatgen.util.coord.pbc_diff"><a name="//apple_ref/cpp/Function/pymatgen.util.coord.pbc_diff"></a>
<code class="sig-name descname"><span class="pre">pbc_diff</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcoords1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcoords2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/util/coord.html#pbc_diff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.util.coord.pbc_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ‘fractional distance’ between two coordinates taking into
account periodic boundary conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fcoords1</strong> – First set of fractional coordinates. e.g., [0.5, 0.6,
0.7] or [[1.1, 1.2, 4.3], [0.5, 0.6, 0.7]]. It can be a single
coord or any array of coords.</p></li>
<li><p><strong>fcoords2</strong> – Second set of fractional coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Fractional distance. Each coordinate must have the property that
abs(a) &lt;= 0.5. Examples:
pbc_diff([0.1, 0.1, 0.1], [0.3, 0.5, 0.9]) = [-0.2, -0.4, 0.2]
pbc_diff([0.9, 0.1, 1.01], [0.3, 0.5, 0.9]) = [-0.4, -0.4, 0.11]</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="pymatgen.util.coord.pbc_shortest_vectors"><a name="//apple_ref/cpp/Function/pymatgen.util.coord.pbc_shortest_vectors"></a>
<code class="sig-name descname"><span class="pre">pbc_shortest_vectors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcoords1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcoords2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_d2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pymatgen/util/coord.html#pbc_shortest_vectors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pymatgen.util.coord.pbc_shortest_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the shortest vectors between two lists of coordinates taking into
account periodic boundary conditions and the lattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lattice</strong> – lattice to use</p></li>
<li><p><strong>fcoords1</strong> – First set of fractional coordinates. e.g., [0.5, 0.6, 0.7]
or [[1.1, 1.2, 4.3], [0.5, 0.6, 0.7]]. It can be a single
coord or any array of coords.</p></li>
<li><p><strong>fcoords2</strong> – Second set of fractional coordinates.</p></li>
<li><p><strong>mask</strong> (<em>boolean array</em>) – Mask of matches that are not allowed.
i.e. if mask[1,2] == True, then subset[1] cannot be matched
to superset[2]</p></li>
<li><p><strong>return_d2</strong> (<em>boolean</em>) – whether to also return the squared distances</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array of displacement vectors from fcoords1 to fcoords2
first index is fcoords1 index, second is fcoords2 index</p>
</dd>
</dl>
</dd></dl>
</div>
<div class="clearer"></div>
</div>
</div>
<div class="clearer"></div>
</div>
<div aria-label="related navigation" class="related" role="navigation">
<h3>Navigation</h3>
<ul>
<li class="right" style="margin-right: 10px">
<a href="genindex.html" title="General Index">index</a></li>
<li class="right">
<a href="py-modindex.html" title="Python Module Index">modules</a> |</li>
<li class="right">
<a href="pymatgen.util.coord_cython.html" title="pymatgen.util.coord_cython module">next</a> |</li>
<li class="right">
<a href="pymatgen.util.convergence.html" title="pymatgen.util.convergence module">previous</a> |</li>
<li class="nav-item nav-item-0"><a href="index.html">pymatgen 2022.0.4 documentation</a> »</li>
<li class="nav-item nav-item-1"><a href="modules.html">pymatgen</a> »</li>
<li class="nav-item nav-item-2"><a href="pymatgen.html">pymatgen namespace</a> »</li>
<li class="nav-item nav-item-3"><a href="pymatgen.util.html">pymatgen.util package</a> »</li>
<li class="nav-item nav-item-this"><a href="">pymatgen.util.coord module</a></li>
</ul>
</div>
<div class="footer" role="contentinfo">
        © Copyright 2011, Pymatgen Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.5.2.
    </div>
<div class="footer">This page uses <a href="http://analytics.google.com/">
Google Analytics</a> to collect statistics. You can disable it by blocking
the JavaScript coming from www.google-analytics.com.
<script type="text/javascript">
  (function() {
    var ga = document.createElement('script');
    ga.src = ('https:' == document.location.protocol ?
              'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
  })();
</script>
</div>
</body>
</html>